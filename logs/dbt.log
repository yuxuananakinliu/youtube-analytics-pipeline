[0m13:59:09.365887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002143A79A450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021437392090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002143A4F2010>]}


============================== 13:59:09.367895 | 77a328c9-d5d4-4f6e-9129-aa91bad7bfca ==============================
[0m13:59:09.367895 [info ] [MainThread]: Running with dbt=1.10.11
[0m13:59:09.367895 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt debug', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'log_path': 'logs', 'indirect_selection': 'eager', 'profiles_dir': 'D:\\UC Davis Documents ', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m13:59:09.383745 [info ] [MainThread]: dbt version: 1.10.11
[0m13:59:09.383745 [info ] [MainThread]: python version: 3.11.1
[0m13:59:09.383745 [info ] [MainThread]: python path: C:\Users\lyx\AppData\Local\Programs\Python\Python311\python.exe
[0m13:59:09.383745 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m13:59:09.383745 [info ] [MainThread]: Using profiles dir at D:\UC Davis Documents 
[0m13:59:09.383745 [info ] [MainThread]: Using profiles.yml file at D:\UC Davis Documents \profiles.yml
[0m13:59:09.383745 [info ] [MainThread]: Using dbt_project.yml file at D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\dbt_project.yml
[0m13:59:09.383745 [info ] [MainThread]: Configuration:
[0m13:59:09.383745 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m13:59:09.383745 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m13:59:09.399628 [info ] [MainThread]: Required dependencies:
[0m13:59:09.399628 [debug] [MainThread]: Executing "git --help"
[0m13:59:09.432550 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:59:09.432550 [debug] [MainThread]: STDERR: "b''"
[0m13:59:09.432550 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:59:09.432550 [info ] [MainThread]: Connection test skipped since no profile was found
[0m13:59:09.432550 [info ] [MainThread]: [31m2 checks failed:[0m
[0m13:59:09.432550 [info ] [MainThread]: dbt looked for a profiles.yml file in D:\UC Davis Documents \profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m13:59:09.432550 [info ] [MainThread]: Project loading failed for the following reason:
 project path <D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\dbt_project.yml> not found

[0m13:59:09.432550 [debug] [MainThread]: Command `dbt debug` failed at 13:59:09.432550 after 0.15 seconds
[0m13:59:09.432550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021433DE0910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002143A79AC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021433E65D10>]}
[0m13:59:09.432550 [debug] [MainThread]: Flushing usage events
[0m13:59:10.165427 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:07:54.700473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C607F4EBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C607FC91D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C607FCA810>]}


============================== 14:07:54.700473 | a10e62db-5985-47d3-9dcc-e2f1a74dab34 ==============================
[0m14:07:54.700473 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:07:54.700473 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'empty': 'None', 'log_path': 'logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'D:\\UC Davis Documents ^& Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt'}
[0m14:07:54.736322 [info ] [MainThread]: dbt version: 1.10.11
[0m14:07:54.737321 [info ] [MainThread]: python version: 3.11.1
[0m14:07:54.737321 [info ] [MainThread]: python path: C:\Users\lyx\AppData\Local\Programs\Python\Python311\python.exe
[0m14:07:54.738326 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m14:07:54.738326 [info ] [MainThread]: Using profiles dir at D:\UC Davis Documents ^& Works\Interview Preparation\self_projects\youtube-analytics-pipeline\dbt
[0m14:07:54.739324 [info ] [MainThread]: Using profiles.yml file at D:\UC Davis Documents ^& Works\Interview Preparation\self_projects\youtube-analytics-pipeline\dbt\profiles.yml
[0m14:07:54.739324 [info ] [MainThread]: Using dbt_project.yml file at D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\dbt_project.yml
[0m14:07:54.740320 [info ] [MainThread]: Configuration:
[0m14:07:54.740320 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m14:07:54.741321 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m14:07:54.741321 [info ] [MainThread]: Required dependencies:
[0m14:07:54.742320 [debug] [MainThread]: Executing "git --help"
[0m14:07:54.774798 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:07:54.774798 [debug] [MainThread]: STDERR: "b''"
[0m14:07:54.777247 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:07:54.777247 [info ] [MainThread]: Connection test skipped since no profile was found
[0m14:07:54.777247 [info ] [MainThread]: [31m2 checks failed:[0m
[0m14:07:54.777247 [info ] [MainThread]: dbt looked for a profiles.yml file in D:\UC Davis Documents ^& Works\Interview Preparation\self_projects\youtube-analytics-pipeline\dbt\profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m14:07:54.780539 [info ] [MainThread]: Project loading failed for the following reason:
 project path <D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\dbt_project.yml> not found

[0m14:07:54.781550 [debug] [MainThread]: Command `dbt debug` failed at 14:07:54.781550 after 0.15 seconds
[0m14:07:54.781550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C601650910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C60805FAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6016D5CD0>]}
[0m14:07:54.783120 [debug] [MainThread]: Flushing usage events
[0m14:07:55.178786 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:29:29.858247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EFBD34110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EFBD2FA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EFBD2F4D0>]}


============================== 14:29:29.858247 | 044d8820-d724-4600-9dc1-2226b7c6a090 ==============================
[0m14:29:29.858247 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:29:29.858247 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt debug', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'None', 'printer_width': '80', 'quiet': 'False', 'indirect_selection': 'eager', 'log_path': 'logs', 'profiles_dir': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m14:29:29.886207 [info ] [MainThread]: dbt version: 1.10.11
[0m14:29:29.886207 [info ] [MainThread]: python version: 3.11.1
[0m14:29:29.886207 [info ] [MainThread]: python path: C:\Users\lyx\AppData\Local\Programs\Python\Python311\python.exe
[0m14:29:29.886207 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m14:29:43.028734 [info ] [MainThread]: Using profiles dir at D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\dbt
[0m14:29:43.028734 [info ] [MainThread]: Using profiles.yml file at D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\dbt\profiles.yml
[0m14:29:43.028734 [info ] [MainThread]: Using dbt_project.yml file at D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\dbt_project.yml
[0m14:29:43.028734 [info ] [MainThread]: adapter type: bigquery
[0m14:29:43.028734 [info ] [MainThread]: adapter version: 1.10.2
[0m14:29:43.028734 [info ] [MainThread]: Configuration:
[0m14:29:43.041906 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:29:43.041906 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m14:29:43.041906 [info ] [MainThread]: Required dependencies:
[0m14:29:43.041906 [debug] [MainThread]: Executing "git --help"
[0m14:29:43.082245 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:29:43.084172 [debug] [MainThread]: STDERR: "b''"
[0m14:29:43.084172 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:29:43.087318 [info ] [MainThread]: Connection:
[0m14:29:43.087318 [info ] [MainThread]:   method: service-account
[0m14:29:43.087318 [info ] [MainThread]:   database: YOUR_PROJECT_ID
[0m14:29:43.087318 [info ] [MainThread]:   execution_project: YOUR_PROJECT_ID
[0m14:29:43.087318 [info ] [MainThread]:   schema: youtube_stg
[0m14:29:43.087318 [info ] [MainThread]:   location: US
[0m14:29:43.087318 [info ] [MainThread]:   priority: None
[0m14:29:43.087318 [info ] [MainThread]:   maximum_bytes_billed: None
[0m14:29:43.087318 [info ] [MainThread]:   impersonate_service_account: None
[0m14:29:43.087318 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m14:29:43.103150 [info ] [MainThread]:   job_retries: 1
[0m14:29:43.103150 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m14:29:43.103150 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m14:29:43.103150 [info ] [MainThread]:   timeout_seconds: None
[0m14:29:43.103150 [info ] [MainThread]:   client_id: None
[0m14:29:43.103150 [info ] [MainThread]:   token_uri: None
[0m14:29:43.103150 [info ] [MainThread]:   compute_region: None
[0m14:29:43.103150 [info ] [MainThread]:   dataproc_cluster_name: None
[0m14:29:43.103150 [info ] [MainThread]:   gcs_bucket: None
[0m14:29:43.103150 [info ] [MainThread]:   dataproc_batch: None
[0m14:29:43.119007 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m14:29:45.055897 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m14:29:45.055897 [debug] [MainThread]: On debug: select 1 as id
[0m14:29:45.055897 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:29:45.686536 [error] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=YOUR_PROJECT_ID&j=bq:US:942ced51-1ef1-41d3-963d-d6707d824efd&page=queryresults
[0m14:29:45.688431 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m14:29:45.690428 [info ] [MainThread]: [31m2 checks failed:[0m
[0m14:29:45.691425 [info ] [MainThread]: Project loading failed for the following reason:
 project path <D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\dbt_project.yml> not found

[0m14:29:45.692832 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  Invalid project ID 'YOUR_PROJECT_ID'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m14:29:45.693840 [debug] [MainThread]: Command `dbt debug` failed at 14:29:45.693840 after 15.94 seconds
[0m14:29:45.693840 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:29:45.694838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EF5440990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EFBDAAC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EFBDAA150>]}
[0m14:29:45.694838 [debug] [MainThread]: Flushing usage events
[0m14:29:46.198577 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:34:55.534357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DFF82DB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DFF7F3E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DFF7F3FD0>]}


============================== 14:34:55.534357 | 770aa421-7ff2-4488-9eac-154163af1f94 ==============================
[0m14:34:55.534357 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:34:55.534357 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt'}
[0m14:34:55.562421 [info ] [MainThread]: dbt version: 1.10.11
[0m14:34:55.562421 [info ] [MainThread]: python version: 3.11.1
[0m14:34:55.562421 [info ] [MainThread]: python path: C:\Users\lyx\AppData\Local\Programs\Python\Python311\python.exe
[0m14:34:55.562421 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m14:35:02.286333 [info ] [MainThread]: Using profiles dir at D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\dbt
[0m14:35:02.288073 [info ] [MainThread]: Using profiles.yml file at D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\dbt\profiles.yml
[0m14:35:02.290212 [info ] [MainThread]: Using dbt_project.yml file at D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\dbt_project.yml
[0m14:35:02.291345 [info ] [MainThread]: adapter type: bigquery
[0m14:35:02.292234 [info ] [MainThread]: adapter version: 1.10.2
[0m14:35:02.293649 [info ] [MainThread]: Configuration:
[0m14:35:02.294997 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:35:02.295478 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m14:35:02.297632 [info ] [MainThread]: Required dependencies:
[0m14:35:02.299485 [debug] [MainThread]: Executing "git --help"
[0m14:35:02.335527 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:35:02.335527 [debug] [MainThread]: STDERR: "b''"
[0m14:35:02.335527 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:35:02.335527 [info ] [MainThread]: Connection:
[0m14:35:02.343771 [info ] [MainThread]:   method: service-account
[0m14:35:02.343771 [info ] [MainThread]:   database: orbital-nuance-471817-n0
[0m14:35:02.343771 [info ] [MainThread]:   execution_project: orbital-nuance-471817-n0
[0m14:35:02.343771 [info ] [MainThread]:   schema: youtube_stg
[0m14:35:02.343771 [info ] [MainThread]:   location: US
[0m14:35:02.343771 [info ] [MainThread]:   priority: None
[0m14:35:02.343771 [info ] [MainThread]:   maximum_bytes_billed: None
[0m14:35:02.343771 [info ] [MainThread]:   impersonate_service_account: None
[0m14:35:02.343771 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m14:35:02.359656 [info ] [MainThread]:   job_retries: 1
[0m14:35:02.359656 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m14:35:02.359656 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m14:35:02.359656 [info ] [MainThread]:   timeout_seconds: None
[0m14:35:02.359656 [info ] [MainThread]:   client_id: None
[0m14:35:02.359656 [info ] [MainThread]:   token_uri: None
[0m14:35:02.359656 [info ] [MainThread]:   compute_region: None
[0m14:35:02.359656 [info ] [MainThread]:   dataproc_cluster_name: None
[0m14:35:02.359656 [info ] [MainThread]:   gcs_bucket: None
[0m14:35:02.359656 [info ] [MainThread]:   dataproc_batch: None
[0m14:35:02.375554 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m14:35:04.556650 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m14:35:04.556650 [debug] [MainThread]: On debug: select 1 as id
[0m14:35:04.556650 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:35:05.788432 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:860a1632-d531-417d-85ba-5336f4f80cc3&page=queryresults
[0m14:35:10.808860 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:35:10.808860 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:35:10.808860 [info ] [MainThread]: Project loading failed for the following reason:
 project path <D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\dbt_project.yml> not found

[0m14:35:10.813113 [debug] [MainThread]: Command `dbt debug` failed at 14:35:10.813113 after 15.38 seconds
[0m14:35:10.813113 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:35:10.813113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DFF7F3F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DF8EC0990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DF8F45DD0>]}
[0m14:35:10.815121 [debug] [MainThread]: Flushing usage events
[0m14:35:11.192180 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:44:34.713190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219939643D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021993967A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219939A2610>]}


============================== 14:44:34.713190 | 66c7d2da-cbfd-498d-a77e-bb366ac23fc8 ==============================
[0m14:44:34.713190 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:44:34.713190 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt debug', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'empty': 'None', 'quiet': 'False', 'indirect_selection': 'eager', 'log_path': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\logs', 'profiles_dir': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m14:44:34.744898 [info ] [MainThread]: dbt version: 1.10.11
[0m14:44:34.744898 [info ] [MainThread]: python version: 3.11.1
[0m14:44:34.744898 [info ] [MainThread]: python path: C:\Users\lyx\AppData\Local\Programs\Python\Python311\python.exe
[0m14:44:34.744898 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m14:44:41.908173 [info ] [MainThread]: Using profiles dir at D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\dbt
[0m14:44:41.908173 [info ] [MainThread]: Using profiles.yml file at D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\dbt\profiles.yml
[0m14:44:41.908173 [info ] [MainThread]: Using dbt_project.yml file at D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\dbt_project.yml
[0m14:44:41.921920 [info ] [MainThread]: adapter type: bigquery
[0m14:44:41.924048 [info ] [MainThread]: adapter version: 1.10.2
[0m14:44:42.231150 [info ] [MainThread]: Configuration:
[0m14:44:42.233523 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:44:42.233523 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:44:42.236589 [info ] [MainThread]: Required dependencies:
[0m14:44:42.236589 [debug] [MainThread]: Executing "git --help"
[0m14:44:42.262099 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:44:42.278297 [debug] [MainThread]: STDERR: "b''"
[0m14:44:42.278297 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:44:42.278297 [info ] [MainThread]: Connection:
[0m14:44:42.278297 [info ] [MainThread]:   method: service-account
[0m14:44:42.278297 [info ] [MainThread]:   database: orbital-nuance-471817-n0
[0m14:44:42.278297 [info ] [MainThread]:   execution_project: orbital-nuance-471817-n0
[0m14:44:42.278297 [info ] [MainThread]:   schema: youtube_stg
[0m14:44:42.278297 [info ] [MainThread]:   location: US
[0m14:44:42.278297 [info ] [MainThread]:   priority: None
[0m14:44:42.278297 [info ] [MainThread]:   maximum_bytes_billed: None
[0m14:44:42.278297 [info ] [MainThread]:   impersonate_service_account: None
[0m14:44:42.294134 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m14:44:42.295614 [info ] [MainThread]:   job_retries: 1
[0m14:44:42.295614 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m14:44:42.295614 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m14:44:42.295614 [info ] [MainThread]:   timeout_seconds: None
[0m14:44:42.295614 [info ] [MainThread]:   client_id: None
[0m14:44:42.295614 [info ] [MainThread]:   token_uri: None
[0m14:44:42.295614 [info ] [MainThread]:   compute_region: None
[0m14:44:42.309960 [info ] [MainThread]:   dataproc_cluster_name: None
[0m14:44:42.312311 [info ] [MainThread]:   gcs_bucket: None
[0m14:44:42.314613 [info ] [MainThread]:   dataproc_batch: None
[0m14:44:42.314613 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m14:44:44.246391 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m14:44:44.246391 [debug] [MainThread]: On debug: select 1 as id
[0m14:44:44.246391 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:44:45.167730 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:e35a46f2-afe7-4c5a-8812-cf37ff688d5b&page=queryresults
[0m14:44:46.288254 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:44:46.297492 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:44:46.297492 [debug] [MainThread]: Command `dbt debug` succeeded at 14:44:46.297492 after 11.66 seconds
[0m14:44:46.297492 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:44:46.297492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219936287D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219939A8110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002198CFF3D90>]}
[0m14:44:46.297492 [debug] [MainThread]: Flushing usage events
[0m14:44:46.782238 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:45:05.292425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011BB7490890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011BB7444DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011BB747CD90>]}


============================== 14:45:05.292425 | 814bdf64-1f83-4c5f-8744-6ec4e312cc0c ==============================
[0m14:45:05.292425 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:45:05.292425 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'printer_width': '80', 'empty': 'False', 'indirect_selection': 'eager', 'log_path': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\logs', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m14:45:12.439334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '814bdf64-1f83-4c5f-8744-6ec4e312cc0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011BE5C1BB50>]}
[0m14:45:12.619880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '814bdf64-1f83-4c5f-8744-6ec4e312cc0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011BE5D38C50>]}
[0m14:45:12.622881 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m14:45:14.440496 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m14:45:14.459825 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:45:14.462884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '814bdf64-1f83-4c5f-8744-6ec4e312cc0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011BE701FD50>]}
[0m14:45:20.003155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '814bdf64-1f83-4c5f-8744-6ec4e312cc0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011BE73A40D0>]}
[0m14:45:20.149887 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m14:45:20.181304 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m14:45:20.272293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '814bdf64-1f83-4c5f-8744-6ec4e312cc0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011BE75DD690>]}
[0m14:45:20.272293 [info ] [MainThread]: Found 5 models, 5 data tests, 495 macros
[0m14:45:20.272293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '814bdf64-1f83-4c5f-8744-6ec4e312cc0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011BE7302290>]}
[0m14:45:20.286947 [info ] [MainThread]: 
[0m14:45:20.286947 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m14:45:20.286947 [info ] [MainThread]: 
[0m14:45:20.286947 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:45:20.305707 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0'
[0m14:45:20.305707 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:20.305707 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0'
[0m14:45:20.401012 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:21.131841 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_orbital-nuance-471817-n0, now create_orbital-nuance-471817-n0_youtube_stg_youtube_stg)
[0m14:45:21.131841 [debug] [ThreadPool]: Creating schema "database: "orbital-nuance-471817-n0"
schema: "youtube_stg_youtube_stg"
"
[0m14:45:21.118370 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_orbital-nuance-471817-n0, now create_orbital-nuance-471817-n0_youtube_stg_youtube_analytics)
[0m14:45:21.141766 [debug] [ThreadPool]: On create_orbital-nuance-471817-n0_youtube_stg_youtube_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "connection_name": "create_orbital-nuance-471817-n0_youtube_stg_youtube_stg"} */
create schema if not exists `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`
  
[0m14:45:21.141766 [debug] [ThreadPool]: Creating schema "database: "orbital-nuance-471817-n0"
schema: "youtube_stg_youtube_analytics"
"
[0m14:45:21.141766 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:45:21.150374 [debug] [ThreadPool]: On create_orbital-nuance-471817-n0_youtube_stg_youtube_analytics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "connection_name": "create_orbital-nuance-471817-n0_youtube_stg_youtube_analytics"} */
create schema if not exists `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`
  
[0m14:45:21.200519 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:45:21.931187 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:a98adbf0-a08c-45a5-876b-e0512bd55d2d&page=queryresults
[0m14:45:21.934407 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:f494c8cd-cd04-4d0f-8d76-476a11e7c661&page=queryresults
[0m14:45:23.151481 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics'
[0m14:45:23.151481 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:23.153495 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg'
[0m14:45:23.302387 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:23.978553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '814bdf64-1f83-4c5f-8744-6ec4e312cc0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011BE73351D0>]}
[0m14:45:23.978553 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:45:24.134541 [debug] [Thread-1 (]: Began running node model.youtube_analytics.stg_youtube_channels
[0m14:45:24.137464 [debug] [Thread-2 (]: Began running node model.youtube_analytics.stg_youtube_video_ids
[0m14:45:24.137464 [debug] [Thread-3 (]: Began running node model.youtube_analytics.stg_youtube_video_stats
[0m14:45:24.137464 [info ] [Thread-1 (]: 1 of 5 START sql view model youtube_stg_youtube_stg.stg_youtube_channels ....... [RUN]
[0m14:45:24.137464 [info ] [Thread-2 (]: 2 of 5 START sql view model youtube_stg_youtube_stg.stg_youtube_video_ids ...... [RUN]
[0m14:45:24.137464 [info ] [Thread-3 (]: 3 of 5 START sql view model youtube_stg_youtube_stg.stg_youtube_video_stats .... [RUN]
[0m14:45:24.137464 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_channels'
[0m14:45:24.137464 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_video_ids'
[0m14:45:24.137464 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_video_stats'
[0m14:45:24.150885 [debug] [Thread-1 (]: Began compiling node model.youtube_analytics.stg_youtube_channels
[0m14:45:24.153169 [debug] [Thread-2 (]: Began compiling node model.youtube_analytics.stg_youtube_video_ids
[0m14:45:24.154093 [debug] [Thread-3 (]: Began compiling node model.youtube_analytics.stg_youtube_video_stats
[0m14:45:24.165701 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_channels"
[0m14:45:24.170757 [debug] [Thread-2 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_video_ids"
[0m14:45:24.177695 [debug] [Thread-3 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_video_stats"
[0m14:45:24.182696 [debug] [Thread-1 (]: Began executing node model.youtube_analytics.stg_youtube_channels
[0m14:45:24.182696 [debug] [Thread-2 (]: Began executing node model.youtube_analytics.stg_youtube_video_ids
[0m14:45:24.197488 [debug] [Thread-3 (]: Began executing node model.youtube_analytics.stg_youtube_video_stats
[0m14:45:24.232080 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_channels"
[0m14:45:24.247003 [debug] [Thread-2 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_video_ids"
[0m14:45:24.253829 [debug] [Thread-3 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_video_stats"
[0m14:45:24.263401 [debug] [Thread-2 (]: On model.youtube_analytics.stg_youtube_video_ids: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_video_ids"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_ids`
  OPTIONS()
  as select
  videoId              as video_id,
  channelId            as channel_id,
  date(_partitiontime) as load_date
from `YOUR_PROJECT_ID.youtube_raw.video_ids_raw`;;


[0m14:45:24.264406 [debug] [Thread-3 (]: On model.youtube_analytics.stg_youtube_video_stats: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_video_stats"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
  OPTIONS()
  as with src as (
  select
    id                                     as video_id,
    snippet.channelId                      as channel_id,
    snippet.title                          as video_title,
    snippet.publishedAt                    as video_published_at,
    cast(statistics.viewCount    as int64) as views,
    cast(statistics.likeCount    as int64) as likes,
    cast(statistics.commentCount as int64) as comments,
    contentDetails.duration                as duration_iso,
    date(_partitiontime)                   as load_date
  from `YOUR_PROJECT_ID.youtube_raw.video_stats_raw`
),
parsed as (
  -- Parse durations like PT5M13S into seconds
  select
    *,
    (
      coalesce(
        safe.cast(regexp_extract(duration_iso, r'(\d+)H') as int64), 0
      ) * 3600
      +
      coalesce(
        safe.cast(regexp_extract(duration_iso, r'(\d+)M') as int64), 0
      ) * 60
      +
      coalesce(
        safe.cast(regexp_extract(duration_iso, r'(\d+)S') as int64), 0
      )
    ) as duration_seconds
  from src
)
select * from parsed;;


[0m14:45:24.265627 [debug] [Thread-1 (]: On model.youtube_analytics.stg_youtube_channels: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_channels"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_channels`
  OPTIONS()
  as with src as (
  select
    id                                        as channel_id,
    snippet.title                             as channel_title,
    snippet.country                           as channel_country,
    snippet.publishedAt                       as channel_published_at,
    cast(statistics.viewCount       as int64) as channel_view_count,
    cast(statistics.subscriberCount as int64) as channel_subscribers,
    cast(statistics.videoCount      as int64) as channel_video_count,
    date(_partitiontime)                      as load_date
  from `YOUR_PROJECT_ID.youtube_raw.channels_raw`
)
select * from src;;


[0m14:45:24.266626 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:45:24.268628 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:45:24.269623 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:45:24.994885 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:f3156299-fb4b-4d6d-bb31-a5601eb0f199&page=queryresults
[0m14:45:24.994885 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:8b8b9145-4a54-4d3d-aa23-53851ee60448&page=queryresults
[0m14:45:24.994885 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:f3156299-fb4b-4d6d-bb31-a5601eb0f199&page=queryresults
[0m14:45:24.994885 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:8b8b9145-4a54-4d3d-aa23-53851ee60448&page=queryresults
[0m14:45:25.062506 [debug] [Thread-3 (]: Database Error in model stg_youtube_video_stats (dbt/models\staging\stg_youtube_video_stats.sql)
  Syntax error: Unexpected ";" at [38:22]
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_video_stats.sql
[0m14:45:25.073837 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:7fde6bbb-296a-4afa-a352-685a7ece8610&page=queryresults
[0m14:45:25.073837 [debug] [Thread-2 (]: Database Error in model stg_youtube_video_ids (dbt/models\staging\stg_youtube_video_ids.sql)
  Syntax error: Unexpected ";" at [10:50]
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_video_ids.sql
[0m14:45:25.073837 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:7fde6bbb-296a-4afa-a352-685a7ece8610&page=queryresults
[0m14:45:25.073837 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '814bdf64-1f83-4c5f-8744-6ec4e312cc0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011BE5C6A350>]}
[0m14:45:25.073837 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '814bdf64-1f83-4c5f-8744-6ec4e312cc0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011BE7A55410>]}
[0m14:45:25.073837 [debug] [Thread-1 (]: Database Error in model stg_youtube_channels (dbt/models\staging\stg_youtube_channels.sql)
  Syntax error: Unexpected ";" at [18:19]
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_channels.sql
[0m14:45:25.073837 [error] [Thread-3 (]: 3 of 5 ERROR creating sql view model youtube_stg_youtube_stg.stg_youtube_video_stats  [[31mERROR[0m in 0.93s]
[0m14:45:25.073837 [error] [Thread-2 (]: 2 of 5 ERROR creating sql view model youtube_stg_youtube_stg.stg_youtube_video_ids  [[31mERROR[0m in 0.94s]
[0m14:45:25.087275 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '814bdf64-1f83-4c5f-8744-6ec4e312cc0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011BE76327D0>]}
[0m14:45:25.087275 [debug] [Thread-3 (]: Finished running node model.youtube_analytics.stg_youtube_video_stats
[0m14:45:25.087275 [debug] [Thread-2 (]: Finished running node model.youtube_analytics.stg_youtube_video_ids
[0m14:45:25.091603 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model youtube_stg_youtube_stg.stg_youtube_channels  [[31mERROR[0m in 0.95s]
[0m14:45:25.091603 [debug] [Thread-7 (]: Marking all children of 'model.youtube_analytics.stg_youtube_video_stats' to be skipped because of status 'error'.  Reason: Database Error in model stg_youtube_video_stats (dbt/models\staging\stg_youtube_video_stats.sql)
  Syntax error: Unexpected ";" at [38:22]
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_video_stats.sql.
[0m14:45:25.091603 [debug] [Thread-1 (]: Finished running node model.youtube_analytics.stg_youtube_channels
[0m14:45:25.091603 [debug] [Thread-7 (]: Marking all children of 'model.youtube_analytics.stg_youtube_video_ids' to be skipped because of status 'error'.  Reason: Database Error in model stg_youtube_video_ids (dbt/models\staging\stg_youtube_video_ids.sql)
  Syntax error: Unexpected ";" at [10:50]
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_video_ids.sql.
[0m14:45:25.091603 [debug] [Thread-4 (]: Began running node model.youtube_analytics.fct_video_daily_metrics
[0m14:45:25.091603 [debug] [Thread-7 (]: Marking all children of 'model.youtube_analytics.stg_youtube_channels' to be skipped because of status 'error'.  Reason: Database Error in model stg_youtube_channels (dbt/models\staging\stg_youtube_channels.sql)
  Syntax error: Unexpected ";" at [18:19]
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_channels.sql.
[0m14:45:25.091603 [info ] [Thread-4 (]: 4 of 5 SKIP relation youtube_stg_youtube_analytics.fct_video_daily_metrics ..... [[33mSKIP[0m]
[0m14:45:25.091603 [debug] [Thread-4 (]: Finished running node model.youtube_analytics.fct_video_daily_metrics
[0m14:45:25.091603 [debug] [Thread-2 (]: Began running node model.youtube_analytics.agg_channel_trends_7d
[0m14:45:25.091603 [info ] [Thread-2 (]: 5 of 5 SKIP relation youtube_stg_youtube_analytics.agg_channel_trends_7d ....... [[33mSKIP[0m]
[0m14:45:25.103211 [debug] [Thread-2 (]: Finished running node model.youtube_analytics.agg_channel_trends_7d
[0m14:45:25.103211 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:45:25.188987 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:45:25.191012 [debug] [MainThread]: Connection 'create_orbital-nuance-471817-n0_youtube_stg_youtube_analytics' was properly closed.
[0m14:45:25.192015 [debug] [MainThread]: Connection 'create_orbital-nuance-471817-n0_youtube_stg_youtube_stg' was properly closed.
[0m14:45:25.193101 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics' was properly closed.
[0m14:45:25.194121 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg' was properly closed.
[0m14:45:25.195107 [debug] [MainThread]: Connection 'model.youtube_analytics.stg_youtube_channels' was properly closed.
[0m14:45:25.196126 [debug] [MainThread]: Connection 'model.youtube_analytics.stg_youtube_video_ids' was properly closed.
[0m14:45:25.197082 [debug] [MainThread]: Connection 'model.youtube_analytics.stg_youtube_video_stats' was properly closed.
[0m14:45:25.197989 [info ] [MainThread]: 
[0m14:45:25.199995 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 4.91 seconds (4.91s).
[0m14:45:25.202069 [debug] [MainThread]: Command end result
[0m14:45:25.252140 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m14:45:25.257480 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m14:45:25.270719 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\run_results.json
[0m14:45:25.271596 [info ] [MainThread]: 
[0m14:45:25.273607 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m14:45:25.274644 [info ] [MainThread]: 
[0m14:45:25.275796 [error] [MainThread]: [31mFailure in model stg_youtube_video_stats (dbt/models\staging\stg_youtube_video_stats.sql)[0m
[0m14:45:25.277820 [error] [MainThread]:   Database Error in model stg_youtube_video_stats (dbt/models\staging\stg_youtube_video_stats.sql)
  Syntax error: Unexpected ";" at [38:22]
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_video_stats.sql
[0m14:45:25.279824 [info ] [MainThread]: 
[0m14:45:25.280582 [info ] [MainThread]:   compiled code at target\compiled\youtube_analytics\dbt/models\staging\stg_youtube_video_stats.sql
[0m14:45:25.282761 [info ] [MainThread]: 
[0m14:45:25.283661 [error] [MainThread]: [31mFailure in model stg_youtube_video_ids (dbt/models\staging\stg_youtube_video_ids.sql)[0m
[0m14:45:25.285084 [error] [MainThread]:   Database Error in model stg_youtube_video_ids (dbt/models\staging\stg_youtube_video_ids.sql)
  Syntax error: Unexpected ";" at [10:50]
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_video_ids.sql
[0m14:45:25.287107 [info ] [MainThread]: 
[0m14:45:25.289147 [info ] [MainThread]:   compiled code at target\compiled\youtube_analytics\dbt/models\staging\stg_youtube_video_ids.sql
[0m14:45:25.290462 [info ] [MainThread]: 
[0m14:45:25.290462 [error] [MainThread]: [31mFailure in model stg_youtube_channels (dbt/models\staging\stg_youtube_channels.sql)[0m
[0m14:45:25.290462 [error] [MainThread]:   Database Error in model stg_youtube_channels (dbt/models\staging\stg_youtube_channels.sql)
  Syntax error: Unexpected ";" at [18:19]
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_channels.sql
[0m14:45:25.290462 [info ] [MainThread]: 
[0m14:45:25.290462 [info ] [MainThread]:   compiled code at target\compiled\youtube_analytics\dbt/models\staging\stg_youtube_channels.sql
[0m14:45:25.290462 [info ] [MainThread]: 
[0m14:45:25.290462 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=2 NO-OP=0 TOTAL=5
[0m14:45:25.290462 [debug] [MainThread]: Command `dbt run` failed at 14:45:25.290462 after 20.08 seconds
[0m14:45:25.290462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011BB0B40990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011BB0BC5DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011BB0BC5D10>]}
[0m14:45:25.290462 [debug] [MainThread]: Flushing usage events
[0m14:45:25.666756 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:50:42.804499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205BD15E9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205BD130890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205BD130950>]}


============================== 14:50:42.804499 | a18cd23c-0bd9-49e7-9f0c-670aa817ce79 ==============================
[0m14:50:42.804499 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:50:42.814289 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'empty': 'False', 'printer_width': '80', 'log_path': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m14:50:49.978280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a18cd23c-0bd9-49e7-9f0c-670aa817ce79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205EB889E90>]}
[0m14:50:50.200723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a18cd23c-0bd9-49e7-9f0c-670aa817ce79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205B9D82D50>]}
[0m14:50:50.200723 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m14:50:52.313514 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m14:50:53.060147 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m14:50:53.060147 [debug] [MainThread]: Partial parsing: updated file: youtube_analytics://dbt/models\marts\agg_channel_trends_7d.sql
[0m14:50:53.060147 [debug] [MainThread]: Partial parsing: updated file: youtube_analytics://dbt/models\staging\stg_youtube_video_ids.sql
[0m14:50:53.060147 [debug] [MainThread]: Partial parsing: updated file: youtube_analytics://dbt/models\marts\fct_video_daily_metrics.sql
[0m14:50:53.060147 [debug] [MainThread]: Partial parsing: updated file: youtube_analytics://dbt/models\staging\stg_youtube_channels.sql
[0m14:50:53.060147 [debug] [MainThread]: Partial parsing: updated file: youtube_analytics://dbt/models\staging\stg_youtube_video_stats.sql
[0m14:50:54.296076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a18cd23c-0bd9-49e7-9f0c-670aa817ce79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205ECF42B90>]}
[0m14:50:54.436029 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m14:50:54.451754 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m14:50:54.526152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a18cd23c-0bd9-49e7-9f0c-670aa817ce79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205ECD106D0>]}
[0m14:50:54.528146 [info ] [MainThread]: Found 5 models, 5 data tests, 495 macros
[0m14:50:54.530224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a18cd23c-0bd9-49e7-9f0c-670aa817ce79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205ED1D8050>]}
[0m14:50:54.533322 [info ] [MainThread]: 
[0m14:50:54.535226 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m14:50:54.536821 [info ] [MainThread]: 
[0m14:50:54.539475 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:50:54.539475 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0'
[0m14:50:54.549780 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0'
[0m14:50:54.549780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:54.549780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:55.554197 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg'
[0m14:50:55.554197 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics'
[0m14:50:55.554197 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:55.559512 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:56.271759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a18cd23c-0bd9-49e7-9f0c-670aa817ce79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205EC9A9450>]}
[0m14:50:56.271759 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:50:56.425548 [debug] [Thread-1 (]: Began running node model.youtube_analytics.stg_youtube_channels
[0m14:50:56.425548 [debug] [Thread-2 (]: Began running node model.youtube_analytics.stg_youtube_video_ids
[0m14:50:56.425548 [debug] [Thread-3 (]: Began running node model.youtube_analytics.stg_youtube_video_stats
[0m14:50:56.425548 [info ] [Thread-1 (]: 1 of 5 START sql view model youtube_stg_youtube_stg.stg_youtube_channels ....... [RUN]
[0m14:50:56.425548 [info ] [Thread-2 (]: 2 of 5 START sql view model youtube_stg_youtube_stg.stg_youtube_video_ids ...... [RUN]
[0m14:50:56.441803 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_channels'
[0m14:50:56.439360 [info ] [Thread-3 (]: 3 of 5 START sql view model youtube_stg_youtube_stg.stg_youtube_video_stats .... [RUN]
[0m14:50:56.443434 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_video_ids'
[0m14:50:56.443434 [debug] [Thread-1 (]: Began compiling node model.youtube_analytics.stg_youtube_channels
[0m14:50:56.443434 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_video_stats'
[0m14:50:56.443434 [debug] [Thread-2 (]: Began compiling node model.youtube_analytics.stg_youtube_video_ids
[0m14:50:56.457446 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_channels"
[0m14:50:56.457446 [debug] [Thread-3 (]: Began compiling node model.youtube_analytics.stg_youtube_video_stats
[0m14:50:56.469804 [debug] [Thread-2 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_video_ids"
[0m14:50:56.478940 [debug] [Thread-3 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_video_stats"
[0m14:50:56.480090 [debug] [Thread-1 (]: Began executing node model.youtube_analytics.stg_youtube_channels
[0m14:50:56.505471 [debug] [Thread-2 (]: Began executing node model.youtube_analytics.stg_youtube_video_ids
[0m14:50:56.505471 [debug] [Thread-3 (]: Began executing node model.youtube_analytics.stg_youtube_video_stats
[0m14:50:56.537118 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_channels"
[0m14:50:56.556739 [debug] [Thread-2 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_video_ids"
[0m14:50:56.558750 [debug] [Thread-3 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_video_stats"
[0m14:50:56.558750 [debug] [Thread-1 (]: On model.youtube_analytics.stg_youtube_channels: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_channels"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_channels`
  OPTIONS()
  as with src as (
  select
    id                                        as channel_id,
    snippet.title                             as channel_title,
    snippet.country                           as channel_country,
    snippet.publishedAt                       as channel_published_at,
    cast(statistics.viewCount       as int64) as channel_view_count,
    cast(statistics.subscriberCount as int64) as channel_subscribers,
    cast(statistics.videoCount      as int64) as channel_video_count,
    date(_partitiontime)                      as load_date
  from `YOUR_PROJECT_ID.youtube_raw.channels_raw`
)
select * from src;


[0m14:50:56.569161 [debug] [Thread-2 (]: On model.youtube_analytics.stg_youtube_video_ids: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_video_ids"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_ids`
  OPTIONS()
  as select
  videoId              as video_id,
  channelId            as channel_id,
  date(_partitiontime) as load_date
from `YOUR_PROJECT_ID.youtube_raw.video_ids_raw`;


[0m14:50:56.569161 [debug] [Thread-3 (]: On model.youtube_analytics.stg_youtube_video_stats: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_video_stats"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
  OPTIONS()
  as with src as (
  select
    id                                     as video_id,
    snippet.channelId                      as channel_id,
    snippet.title                          as video_title,
    snippet.publishedAt                    as video_published_at,
    cast(statistics.viewCount    as int64) as views,
    cast(statistics.likeCount    as int64) as likes,
    cast(statistics.commentCount as int64) as comments,
    contentDetails.duration                as duration_iso,
    date(_partitiontime)                   as load_date
  from `YOUR_PROJECT_ID.youtube_raw.video_stats_raw`
),
parsed as (
  -- Parse durations like PT5M13S into seconds
  select
    *,
    (
      coalesce(
        safe.cast(regexp_extract(duration_iso, r'(\d+)H') as int64), 0
      ) * 3600
      +
      coalesce(
        safe.cast(regexp_extract(duration_iso, r'(\d+)M') as int64), 0
      ) * 60
      +
      coalesce(
        safe.cast(regexp_extract(duration_iso, r'(\d+)S') as int64), 0
      )
    ) as duration_seconds
  from src
)
select * from parsed;


[0m14:50:56.569161 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:50:56.569161 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:50:56.569161 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:50:57.392944 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:6f21e315-092c-4242-b7a2-6e928efc3727&page=queryresults
[0m14:50:57.394885 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:4fbc8217-cb78-4327-9767-fa6ad913b321&page=queryresults
[0m14:50:57.396246 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:6f21e315-092c-4242-b7a2-6e928efc3727&page=queryresults
[0m14:50:57.398328 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:4fbc8217-cb78-4327-9767-fa6ad913b321&page=queryresults
[0m14:50:57.406048 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:312c7566-2e01-46bd-a9f5-28d97b5bf368&page=queryresults
[0m14:50:57.407029 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:312c7566-2e01-46bd-a9f5-28d97b5bf368&page=queryresults
[0m14:50:57.411807 [debug] [Thread-1 (]: Database Error in model stg_youtube_channels (dbt/models\staging\stg_youtube_channels.sql)
  Invalid project ID 'YOUR_PROJECT_ID'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_channels.sql
[0m14:50:57.413845 [debug] [Thread-3 (]: Database Error in model stg_youtube_video_stats (dbt/models\staging\stg_youtube_video_stats.sql)
  Invalid project ID 'YOUR_PROJECT_ID'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_video_stats.sql
[0m14:50:57.414827 [debug] [Thread-2 (]: Database Error in model stg_youtube_video_ids (dbt/models\staging\stg_youtube_video_ids.sql)
  Invalid project ID 'YOUR_PROJECT_ID'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_video_ids.sql
[0m14:50:57.416813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a18cd23c-0bd9-49e7-9f0c-670aa817ce79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205ED029ED0>]}
[0m14:50:57.416813 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a18cd23c-0bd9-49e7-9f0c-670aa817ce79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205ED34F810>]}
[0m14:50:57.417813 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a18cd23c-0bd9-49e7-9f0c-670aa817ce79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205ED302290>]}
[0m14:50:57.418813 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model youtube_stg_youtube_stg.stg_youtube_channels  [[31mERROR[0m in 0.98s]
[0m14:50:57.419813 [error] [Thread-3 (]: 3 of 5 ERROR creating sql view model youtube_stg_youtube_stg.stg_youtube_video_stats  [[31mERROR[0m in 0.97s]
[0m14:50:57.419813 [debug] [Thread-1 (]: Finished running node model.youtube_analytics.stg_youtube_channels
[0m14:50:57.419813 [error] [Thread-2 (]: 2 of 5 ERROR creating sql view model youtube_stg_youtube_stg.stg_youtube_video_ids  [[31mERROR[0m in 0.97s]
[0m14:50:57.419813 [debug] [Thread-3 (]: Finished running node model.youtube_analytics.stg_youtube_video_stats
[0m14:50:57.419813 [debug] [Thread-7 (]: Marking all children of 'model.youtube_analytics.stg_youtube_channels' to be skipped because of status 'error'.  Reason: Database Error in model stg_youtube_channels (dbt/models\staging\stg_youtube_channels.sql)
  Invalid project ID 'YOUR_PROJECT_ID'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_channels.sql.
[0m14:50:57.419813 [debug] [Thread-2 (]: Finished running node model.youtube_analytics.stg_youtube_video_ids
[0m14:50:57.419813 [debug] [Thread-7 (]: Marking all children of 'model.youtube_analytics.stg_youtube_video_stats' to be skipped because of status 'error'.  Reason: Database Error in model stg_youtube_video_stats (dbt/models\staging\stg_youtube_video_stats.sql)
  Invalid project ID 'YOUR_PROJECT_ID'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_video_stats.sql.
[0m14:50:57.419813 [debug] [Thread-7 (]: Marking all children of 'model.youtube_analytics.stg_youtube_video_ids' to be skipped because of status 'error'.  Reason: Database Error in model stg_youtube_video_ids (dbt/models\staging\stg_youtube_video_ids.sql)
  Invalid project ID 'YOUR_PROJECT_ID'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_video_ids.sql.
[0m14:50:57.419813 [debug] [Thread-4 (]: Began running node model.youtube_analytics.fct_video_daily_metrics
[0m14:50:57.419813 [info ] [Thread-4 (]: 4 of 5 SKIP relation youtube_stg_youtube_analytics.fct_video_daily_metrics ..... [[33mSKIP[0m]
[0m14:50:57.419813 [debug] [Thread-4 (]: Finished running node model.youtube_analytics.fct_video_daily_metrics
[0m14:50:57.419813 [debug] [Thread-3 (]: Began running node model.youtube_analytics.agg_channel_trends_7d
[0m14:50:57.419813 [info ] [Thread-3 (]: 5 of 5 SKIP relation youtube_stg_youtube_analytics.agg_channel_trends_7d ....... [[33mSKIP[0m]
[0m14:50:57.419813 [debug] [Thread-3 (]: Finished running node model.youtube_analytics.agg_channel_trends_7d
[0m14:50:57.435854 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:50:57.534695 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:50:57.534695 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0' was properly closed.
[0m14:50:57.548006 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0' was properly closed.
[0m14:50:57.548006 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg' was properly closed.
[0m14:50:57.548006 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics' was properly closed.
[0m14:50:57.548006 [debug] [MainThread]: Connection 'model.youtube_analytics.stg_youtube_channels' was properly closed.
[0m14:50:57.548006 [debug] [MainThread]: Connection 'model.youtube_analytics.stg_youtube_video_ids' was properly closed.
[0m14:50:57.548006 [debug] [MainThread]: Connection 'model.youtube_analytics.stg_youtube_video_stats' was properly closed.
[0m14:50:57.548006 [info ] [MainThread]: 
[0m14:50:57.548006 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 3.01 seconds (3.01s).
[0m14:50:57.548006 [debug] [MainThread]: Command end result
[0m14:50:57.608336 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m14:50:57.611634 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m14:50:57.611634 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\run_results.json
[0m14:50:57.611634 [info ] [MainThread]: 
[0m14:50:57.627315 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m14:50:57.627315 [info ] [MainThread]: 
[0m14:50:57.627315 [error] [MainThread]: [31mFailure in model stg_youtube_channels (dbt/models\staging\stg_youtube_channels.sql)[0m
[0m14:50:57.627315 [error] [MainThread]:   Database Error in model stg_youtube_channels (dbt/models\staging\stg_youtube_channels.sql)
  Invalid project ID 'YOUR_PROJECT_ID'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_channels.sql
[0m14:50:57.627315 [info ] [MainThread]: 
[0m14:50:57.627315 [info ] [MainThread]:   compiled code at target\compiled\youtube_analytics\dbt/models\staging\stg_youtube_channels.sql
[0m14:50:57.627315 [info ] [MainThread]: 
[0m14:50:57.627315 [error] [MainThread]: [31mFailure in model stg_youtube_video_stats (dbt/models\staging\stg_youtube_video_stats.sql)[0m
[0m14:50:57.627315 [error] [MainThread]:   Database Error in model stg_youtube_video_stats (dbt/models\staging\stg_youtube_video_stats.sql)
  Invalid project ID 'YOUR_PROJECT_ID'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_video_stats.sql
[0m14:50:57.627315 [info ] [MainThread]: 
[0m14:50:57.643203 [info ] [MainThread]:   compiled code at target\compiled\youtube_analytics\dbt/models\staging\stg_youtube_video_stats.sql
[0m14:50:57.643203 [info ] [MainThread]: 
[0m14:50:57.643203 [error] [MainThread]: [31mFailure in model stg_youtube_video_ids (dbt/models\staging\stg_youtube_video_ids.sql)[0m
[0m14:50:57.643203 [error] [MainThread]:   Database Error in model stg_youtube_video_ids (dbt/models\staging\stg_youtube_video_ids.sql)
  Invalid project ID 'YOUR_PROJECT_ID'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_video_ids.sql
[0m14:50:57.643203 [info ] [MainThread]: 
[0m14:50:57.643203 [info ] [MainThread]:   compiled code at target\compiled\youtube_analytics\dbt/models\staging\stg_youtube_video_ids.sql
[0m14:50:57.643203 [info ] [MainThread]: 
[0m14:50:57.643203 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=2 NO-OP=0 TOTAL=5
[0m14:50:57.643203 [debug] [MainThread]: Command `dbt run` failed at 14:50:57.643203 after 14.92 seconds
[0m14:50:57.659414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205B6800990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205B6800A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205BC7CE410>]}
[0m14:50:57.659414 [debug] [MainThread]: Flushing usage events
[0m14:50:58.052253 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:53:17.146522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD126A5650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD15A9E650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD15A70750>]}


============================== 14:53:17.151067 | 7273ce77-692e-465c-9040-4146a72352ce ==============================
[0m14:53:17.151067 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:53:17.152066 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m14:53:23.956386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7273ce77-692e-465c-9040-4146a72352ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD441BAED0>]}
[0m14:53:24.134753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7273ce77-692e-465c-9040-4146a72352ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD126B28D0>]}
[0m14:53:24.136641 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m14:53:25.663522 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m14:53:26.325791 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m14:53:26.327745 [debug] [MainThread]: Partial parsing: updated file: youtube_analytics://dbt/models\staging\stg_youtube_video_ids.sql
[0m14:53:26.329667 [debug] [MainThread]: Partial parsing: updated file: youtube_analytics://dbt/models\staging\stg_youtube_video_stats.sql
[0m14:53:26.330787 [debug] [MainThread]: Partial parsing: updated file: youtube_analytics://dbt/models\staging\stg_youtube_channels.sql
[0m14:53:27.513221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7273ce77-692e-465c-9040-4146a72352ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD458295D0>]}
[0m14:53:27.683954 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m14:53:27.688848 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m14:53:27.750215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7273ce77-692e-465c-9040-4146a72352ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD45B07290>]}
[0m14:53:27.752215 [info ] [MainThread]: Found 5 models, 5 data tests, 495 macros
[0m14:53:27.754382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7273ce77-692e-465c-9040-4146a72352ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD45B25910>]}
[0m14:53:27.756798 [info ] [MainThread]: 
[0m14:53:27.758999 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m14:53:27.761103 [info ] [MainThread]: 
[0m14:53:27.764076 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:53:27.774922 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0'
[0m14:53:27.776915 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0'
[0m14:53:27.777931 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:27.779595 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:28.506302 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg'
[0m14:53:28.509479 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics'
[0m14:53:28.510575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:28.511481 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:29.107213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7273ce77-692e-465c-9040-4146a72352ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD4584BC90>]}
[0m14:53:29.109118 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:53:29.233066 [debug] [Thread-1 (]: Began running node model.youtube_analytics.stg_youtube_channels
[0m14:53:29.234065 [debug] [Thread-2 (]: Began running node model.youtube_analytics.stg_youtube_video_ids
[0m14:53:29.235064 [debug] [Thread-3 (]: Began running node model.youtube_analytics.stg_youtube_video_stats
[0m14:53:29.237065 [info ] [Thread-1 (]: 1 of 5 START sql view model youtube_stg_youtube_stg.stg_youtube_channels ....... [RUN]
[0m14:53:29.238985 [info ] [Thread-2 (]: 2 of 5 START sql view model youtube_stg_youtube_stg.stg_youtube_video_ids ...... [RUN]
[0m14:53:29.240100 [info ] [Thread-3 (]: 3 of 5 START sql view model youtube_stg_youtube_stg.stg_youtube_video_stats .... [RUN]
[0m14:53:29.243104 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_channels'
[0m14:53:29.245174 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_video_ids'
[0m14:53:29.247050 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_video_stats'
[0m14:53:29.248158 [debug] [Thread-1 (]: Began compiling node model.youtube_analytics.stg_youtube_channels
[0m14:53:29.249175 [debug] [Thread-2 (]: Began compiling node model.youtube_analytics.stg_youtube_video_ids
[0m14:53:29.251062 [debug] [Thread-3 (]: Began compiling node model.youtube_analytics.stg_youtube_video_stats
[0m14:53:29.263916 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_channels"
[0m14:53:29.267920 [debug] [Thread-2 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_video_ids"
[0m14:53:29.272455 [debug] [Thread-3 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_video_stats"
[0m14:53:29.275495 [debug] [Thread-1 (]: Began executing node model.youtube_analytics.stg_youtube_channels
[0m14:53:29.277998 [debug] [Thread-2 (]: Began executing node model.youtube_analytics.stg_youtube_video_ids
[0m14:53:29.342750 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_channels"
[0m14:53:29.343711 [debug] [Thread-3 (]: Began executing node model.youtube_analytics.stg_youtube_video_stats
[0m14:53:29.350143 [debug] [Thread-2 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_video_ids"
[0m14:53:29.357020 [debug] [Thread-3 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_video_stats"
[0m14:53:29.357971 [debug] [Thread-1 (]: On model.youtube_analytics.stg_youtube_channels: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_channels"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_channels`
  OPTIONS()
  as with src as (
  select
    id                                        as channel_id,
    snippet.title                             as channel_title,
    snippet.country                           as channel_country,
    snippet.publishedAt                       as channel_published_at,
    cast(statistics.viewCount       as int64) as channel_view_count,
    cast(statistics.subscriberCount as int64) as channel_subscribers,
    cast(statistics.videoCount      as int64) as channel_video_count,
    date(_partitiontime)                      as load_date
  from `orbital-nuance-471817-n0.youtube_raw.channels_raw`
)
select * from src;


[0m14:53:29.359899 [debug] [Thread-2 (]: On model.youtube_analytics.stg_youtube_video_ids: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_video_ids"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_ids`
  OPTIONS()
  as select
  videoId              as video_id,
  channelId            as channel_id,
  date(_partitiontime) as load_date
from `orbital-nuance-471817-n0.youtube_raw.video_ids_raw`;


[0m14:53:29.361895 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:53:29.362898 [debug] [Thread-3 (]: On model.youtube_analytics.stg_youtube_video_stats: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_video_stats"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
  OPTIONS()
  as with src as (
  select
    id                                     as video_id,
    snippet.channelId                      as channel_id,
    snippet.title                          as video_title,
    snippet.publishedAt                    as video_published_at,
    cast(statistics.viewCount    as int64) as views,
    cast(statistics.likeCount    as int64) as likes,
    cast(statistics.commentCount as int64) as comments,
    contentDetails.duration                as duration_iso,
    date(_partitiontime)                   as load_date
  from `orbital-nuance-471817-n0.youtube_raw.video_stats_raw`
),
parsed as (
  -- Parse durations like PT5M13S into seconds
  select
    *,
    (
      coalesce(
        safe.cast(regexp_extract(duration_iso, r'(\d+)H') as int64), 0
      ) * 3600
      +
      coalesce(
        safe.cast(regexp_extract(duration_iso, r'(\d+)M') as int64), 0
      ) * 60
      +
      coalesce(
        safe.cast(regexp_extract(duration_iso, r'(\d+)S') as int64), 0
      )
    ) as duration_seconds
  from src
)
select * from parsed;


[0m14:53:29.364974 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:53:29.480265 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:53:30.277391 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:641fba33-ce41-4cf0-b534-e23f7f9bdc0d&page=queryresults
[0m14:53:30.279384 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:8334bc12-cf13-4a40-a581-435494536897&page=queryresults
[0m14:53:30.298254 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:0f635dc3-c51a-4e46-8570-c14ccb11c4a0&page=queryresults
[0m14:53:30.480987 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:0f635dc3-c51a-4e46-8570-c14ccb11c4a0&page=queryresults
[0m14:53:30.482885 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:8334bc12-cf13-4a40-a581-435494536897&page=queryresults
[0m14:53:30.488011 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:641fba33-ce41-4cf0-b534-e23f7f9bdc0d&page=queryresults
[0m14:53:30.498850 [debug] [Thread-3 (]: Database Error in model stg_youtube_video_stats (dbt/models\staging\stg_youtube_video_stats.sql)
  Unrecognized name: _partitiontime at [16:10]
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_video_stats.sql
[0m14:53:30.502950 [debug] [Thread-2 (]: Database Error in model stg_youtube_video_ids (dbt/models\staging\stg_youtube_video_ids.sql)
  Unrecognized name: _partitiontime at [9:8]
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_video_ids.sql
[0m14:53:30.502950 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7273ce77-692e-465c-9040-4146a72352ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD45C8E4D0>]}
[0m14:53:30.506256 [debug] [Thread-1 (]: Database Error in model stg_youtube_channels (dbt/models\staging\stg_youtube_channels.sql)
  Unrecognized name: _partitiontime at [15:10]
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_channels.sql
[0m14:53:30.507350 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7273ce77-692e-465c-9040-4146a72352ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD45C1F7D0>]}
[0m14:53:30.509467 [error] [Thread-3 (]: 3 of 5 ERROR creating sql view model youtube_stg_youtube_stg.stg_youtube_video_stats  [[31mERROR[0m in 1.25s]
[0m14:53:30.511095 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7273ce77-692e-465c-9040-4146a72352ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD45A90790>]}
[0m14:53:30.512638 [debug] [Thread-3 (]: Finished running node model.youtube_analytics.stg_youtube_video_stats
[0m14:53:30.511095 [error] [Thread-2 (]: 2 of 5 ERROR creating sql view model youtube_stg_youtube_stg.stg_youtube_video_ids  [[31mERROR[0m in 1.26s]
[0m14:53:30.513648 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model youtube_stg_youtube_stg.stg_youtube_channels  [[31mERROR[0m in 1.27s]
[0m14:53:30.514648 [debug] [Thread-7 (]: Marking all children of 'model.youtube_analytics.stg_youtube_video_stats' to be skipped because of status 'error'.  Reason: Database Error in model stg_youtube_video_stats (dbt/models\staging\stg_youtube_video_stats.sql)
  Unrecognized name: _partitiontime at [16:10]
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_video_stats.sql.
[0m14:53:30.516647 [debug] [Thread-2 (]: Finished running node model.youtube_analytics.stg_youtube_video_ids
[0m14:53:30.516647 [debug] [Thread-1 (]: Finished running node model.youtube_analytics.stg_youtube_channels
[0m14:53:30.519832 [debug] [Thread-4 (]: Began running node model.youtube_analytics.fct_video_daily_metrics
[0m14:53:30.522314 [debug] [Thread-7 (]: Marking all children of 'model.youtube_analytics.stg_youtube_video_ids' to be skipped because of status 'error'.  Reason: Database Error in model stg_youtube_video_ids (dbt/models\staging\stg_youtube_video_ids.sql)
  Unrecognized name: _partitiontime at [9:8]
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_video_ids.sql.
[0m14:53:30.525330 [info ] [Thread-4 (]: 4 of 5 SKIP relation youtube_stg_youtube_analytics.fct_video_daily_metrics ..... [[33mSKIP[0m]
[0m14:53:30.528327 [debug] [Thread-7 (]: Marking all children of 'model.youtube_analytics.stg_youtube_channels' to be skipped because of status 'error'.  Reason: Database Error in model stg_youtube_channels (dbt/models\staging\stg_youtube_channels.sql)
  Unrecognized name: _partitiontime at [15:10]
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_channels.sql.
[0m14:53:30.531329 [debug] [Thread-4 (]: Finished running node model.youtube_analytics.fct_video_daily_metrics
[0m14:53:30.536328 [debug] [Thread-3 (]: Began running node model.youtube_analytics.agg_channel_trends_7d
[0m14:53:30.537313 [info ] [Thread-3 (]: 5 of 5 SKIP relation youtube_stg_youtube_analytics.agg_channel_trends_7d ....... [[33mSKIP[0m]
[0m14:53:30.537730 [debug] [Thread-3 (]: Finished running node model.youtube_analytics.agg_channel_trends_7d
[0m14:53:30.540920 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:53:30.760690 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:53:30.762696 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0' was properly closed.
[0m14:53:30.764699 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0' was properly closed.
[0m14:53:30.766578 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg' was properly closed.
[0m14:53:30.768653 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics' was properly closed.
[0m14:53:30.770545 [debug] [MainThread]: Connection 'model.youtube_analytics.stg_youtube_channels' was properly closed.
[0m14:53:30.770953 [debug] [MainThread]: Connection 'model.youtube_analytics.stg_youtube_video_ids' was properly closed.
[0m14:53:30.773119 [debug] [MainThread]: Connection 'model.youtube_analytics.stg_youtube_video_stats' was properly closed.
[0m14:53:30.775075 [info ] [MainThread]: 
[0m14:53:30.777837 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 3.01 seconds (3.01s).
[0m14:53:30.781372 [debug] [MainThread]: Command end result
[0m14:53:30.837471 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m14:53:30.842512 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m14:53:30.858577 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\run_results.json
[0m14:53:30.860462 [info ] [MainThread]: 
[0m14:53:30.861439 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m14:53:30.863328 [info ] [MainThread]: 
[0m14:53:30.865464 [error] [MainThread]: [31mFailure in model stg_youtube_video_stats (dbt/models\staging\stg_youtube_video_stats.sql)[0m
[0m14:53:30.867371 [error] [MainThread]:   Database Error in model stg_youtube_video_stats (dbt/models\staging\stg_youtube_video_stats.sql)
  Unrecognized name: _partitiontime at [16:10]
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_video_stats.sql
[0m14:53:30.868430 [info ] [MainThread]: 
[0m14:53:30.870997 [info ] [MainThread]:   compiled code at target\compiled\youtube_analytics\dbt/models\staging\stg_youtube_video_stats.sql
[0m14:53:30.873260 [info ] [MainThread]: 
[0m14:53:30.875214 [error] [MainThread]: [31mFailure in model stg_youtube_video_ids (dbt/models\staging\stg_youtube_video_ids.sql)[0m
[0m14:53:30.876339 [error] [MainThread]:   Database Error in model stg_youtube_video_ids (dbt/models\staging\stg_youtube_video_ids.sql)
  Unrecognized name: _partitiontime at [9:8]
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_video_ids.sql
[0m14:53:30.878331 [info ] [MainThread]: 
[0m14:53:30.879207 [info ] [MainThread]:   compiled code at target\compiled\youtube_analytics\dbt/models\staging\stg_youtube_video_ids.sql
[0m14:53:30.881222 [info ] [MainThread]: 
[0m14:53:30.882208 [error] [MainThread]: [31mFailure in model stg_youtube_channels (dbt/models\staging\stg_youtube_channels.sql)[0m
[0m14:53:30.884222 [error] [MainThread]:   Database Error in model stg_youtube_channels (dbt/models\staging\stg_youtube_channels.sql)
  Unrecognized name: _partitiontime at [15:10]
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_channels.sql
[0m14:53:30.885208 [info ] [MainThread]: 
[0m14:53:30.886967 [info ] [MainThread]:   compiled code at target\compiled\youtube_analytics\dbt/models\staging\stg_youtube_channels.sql
[0m14:53:30.887706 [info ] [MainThread]: 
[0m14:53:30.890378 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=2 NO-OP=0 TOTAL=5
[0m14:53:30.893286 [debug] [MainThread]: Command `dbt run` failed at 14:53:30.893286 after 13.82 seconds
[0m14:53:30.895566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD0F0D0990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD15A9E990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD15A78410>]}
[0m14:53:30.897558 [debug] [MainThread]: Flushing usage events
[0m14:53:31.306021 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:03:59.953931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002475D44F190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002475D4207D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002475D420510>]}


============================== 15:03:59.957953 | ec854a9e-14f5-4442-9068-c39472fef050 ==============================
[0m15:03:59.957953 [info ] [MainThread]: Running with dbt=1.10.11
[0m15:03:59.958935 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'False', 'printer_width': '80', 'quiet': 'False', 'log_path': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt'}
[0m15:04:07.182772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec854a9e-14f5-4442-9068-c39472fef050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002475D477090>]}
[0m15:04:07.400576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec854a9e-14f5-4442-9068-c39472fef050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002475A073650>]}
[0m15:04:07.400576 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m15:04:09.570813 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m15:04:10.227272 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:04:10.227272 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:04:10.308661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec854a9e-14f5-4442-9068-c39472fef050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002470D08C9D0>]}
[0m15:04:10.462004 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m15:04:10.468593 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m15:04:10.525229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec854a9e-14f5-4442-9068-c39472fef050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002470BD58A90>]}
[0m15:04:10.525229 [info ] [MainThread]: Found 5 models, 5 data tests, 495 macros
[0m15:04:10.529953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec854a9e-14f5-4442-9068-c39472fef050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002470BCE21D0>]}
[0m15:04:10.529953 [info ] [MainThread]: 
[0m15:04:10.529953 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m15:04:10.529953 [info ] [MainThread]: 
[0m15:04:10.537706 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:04:10.549866 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0'
[0m15:04:10.551673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:10.552814 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0'
[0m15:04:10.635156 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:11.309222 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg'
[0m15:04:11.312238 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:11.313237 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics'
[0m15:04:11.404487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:11.965255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec854a9e-14f5-4442-9068-c39472fef050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002470BC61390>]}
[0m15:04:11.967260 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:04:12.088260 [debug] [Thread-1 (]: Began running node model.youtube_analytics.stg_youtube_channels
[0m15:04:12.088260 [debug] [Thread-2 (]: Began running node model.youtube_analytics.stg_youtube_video_ids
[0m15:04:12.088260 [debug] [Thread-3 (]: Began running node model.youtube_analytics.stg_youtube_video_stats
[0m15:04:12.088260 [info ] [Thread-1 (]: 1 of 5 START sql view model youtube_stg_youtube_stg.stg_youtube_channels ....... [RUN]
[0m15:04:12.088260 [info ] [Thread-2 (]: 2 of 5 START sql view model youtube_stg_youtube_stg.stg_youtube_video_ids ...... [RUN]
[0m15:04:12.088260 [info ] [Thread-3 (]: 3 of 5 START sql view model youtube_stg_youtube_stg.stg_youtube_video_stats .... [RUN]
[0m15:04:12.088260 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_channels'
[0m15:04:12.099337 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_video_ids'
[0m15:04:12.099337 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_video_stats'
[0m15:04:12.104024 [debug] [Thread-1 (]: Began compiling node model.youtube_analytics.stg_youtube_channels
[0m15:04:12.104024 [debug] [Thread-2 (]: Began compiling node model.youtube_analytics.stg_youtube_video_ids
[0m15:04:12.104024 [debug] [Thread-3 (]: Began compiling node model.youtube_analytics.stg_youtube_video_stats
[0m15:04:12.126359 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_channels"
[0m15:04:12.131373 [debug] [Thread-2 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_video_ids"
[0m15:04:12.138184 [debug] [Thread-3 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_video_stats"
[0m15:04:12.138184 [debug] [Thread-1 (]: Began executing node model.youtube_analytics.stg_youtube_channels
[0m15:04:12.138184 [debug] [Thread-2 (]: Began executing node model.youtube_analytics.stg_youtube_video_ids
[0m15:04:12.186036 [debug] [Thread-3 (]: Began executing node model.youtube_analytics.stg_youtube_video_stats
[0m15:04:12.226210 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_channels"
[0m15:04:12.228041 [debug] [Thread-2 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_video_ids"
[0m15:04:12.239732 [debug] [Thread-3 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_video_stats"
[0m15:04:12.239732 [debug] [Thread-1 (]: On model.youtube_analytics.stg_youtube_channels: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_channels"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_channels`
  OPTIONS()
  as with src as (
  select
    id                                        as channel_id,
    snippet.title                             as channel_title,
    snippet.country                           as channel_country,
    snippet.publishedAt                       as channel_published_at,
    cast(statistics.viewCount       as int64) as channel_view_count,
    cast(statistics.subscriberCount as int64) as channel_subscribers,
    cast(statistics.videoCount      as int64) as channel_video_count,
    date(_partitiontime)                      as load_date
  from `orbital-nuance-471817-n0.youtube_raw.channels_raw`
)
select * from src;


[0m15:04:12.243886 [debug] [Thread-2 (]: On model.youtube_analytics.stg_youtube_video_ids: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_video_ids"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_ids`
  OPTIONS()
  as select
  videoId              as video_id,
  channelId            as channel_id,
  date(_partitiontime) as load_date
from `orbital-nuance-471817-n0.youtube_raw.video_ids_raw`;


[0m15:04:12.243886 [debug] [Thread-3 (]: On model.youtube_analytics.stg_youtube_video_stats: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_video_stats"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
  OPTIONS()
  as with src as (
  select
    id                                     as video_id,
    snippet.channelId                      as channel_id,
    snippet.title                          as video_title,
    snippet.publishedAt                    as video_published_at,
    cast(statistics.viewCount    as int64) as views,
    cast(statistics.likeCount    as int64) as likes,
    cast(statistics.commentCount as int64) as comments,
    contentDetails.duration                as duration_iso,
    date(_partitiontime)                   as load_date
  from `orbital-nuance-471817-n0.youtube_raw.video_stats_raw`
),
parsed as (
  -- Parse durations like PT5M13S into seconds
  select
    *,
    (
      coalesce(
        safe.cast(regexp_extract(duration_iso, r'(\d+)H') as int64), 0
      ) * 3600
      +
      coalesce(
        safe.cast(regexp_extract(duration_iso, r'(\d+)M') as int64), 0
      ) * 60
      +
      coalesce(
        safe.cast(regexp_extract(duration_iso, r'(\d+)S') as int64), 0
      )
    ) as duration_seconds
  from src
)
select * from parsed;


[0m15:04:12.247142 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:04:12.247142 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:04:12.247142 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:04:13.338776 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:03b6d25e-60c2-4094-9911-5a1179eba2c0&page=queryresults
[0m15:04:13.347600 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:5c5361ab-a642-418e-8ae9-c7f41e564d6c&page=queryresults
[0m15:04:13.385507 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:6f2a0486-b969-4833-a34f-de21f961250f&page=queryresults
[0m15:04:13.593620 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:6f2a0486-b969-4833-a34f-de21f961250f&page=queryresults
[0m15:04:13.603347 [debug] [Thread-3 (]: Database Error in model stg_youtube_video_stats (dbt/models\staging\stg_youtube_video_stats.sql)
  Function not found: `cast` at [25:9]
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_video_stats.sql
[0m15:04:13.607431 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec854a9e-14f5-4442-9068-c39472fef050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002470D2FEB90>]}
[0m15:04:13.608431 [error] [Thread-3 (]: 3 of 5 ERROR creating sql view model youtube_stg_youtube_stg.stg_youtube_video_stats  [[31mERROR[0m in 1.51s]
[0m15:04:13.609292 [debug] [Thread-3 (]: Finished running node model.youtube_analytics.stg_youtube_video_stats
[0m15:04:13.610390 [debug] [Thread-7 (]: Marking all children of 'model.youtube_analytics.stg_youtube_video_stats' to be skipped because of status 'error'.  Reason: Database Error in model stg_youtube_video_stats (dbt/models\staging\stg_youtube_video_stats.sql)
  Function not found: `cast` at [25:9]
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_video_stats.sql.
[0m15:04:13.612532 [debug] [Thread-4 (]: Began running node model.youtube_analytics.fct_video_daily_metrics
[0m15:04:13.614741 [info ] [Thread-4 (]: 4 of 5 SKIP relation youtube_stg_youtube_analytics.fct_video_daily_metrics ..... [[33mSKIP[0m]
[0m15:04:13.616794 [debug] [Thread-4 (]: Finished running node model.youtube_analytics.fct_video_daily_metrics
[0m15:04:13.617806 [debug] [Thread-3 (]: Began running node model.youtube_analytics.agg_channel_trends_7d
[0m15:04:13.617806 [info ] [Thread-3 (]: 5 of 5 SKIP relation youtube_stg_youtube_analytics.agg_channel_trends_7d ....... [[33mSKIP[0m]
[0m15:04:13.617806 [debug] [Thread-3 (]: Finished running node model.youtube_analytics.agg_channel_trends_7d
[0m15:04:13.890823 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec854a9e-14f5-4442-9068-c39472fef050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002470D1064D0>]}
[0m15:04:13.890823 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec854a9e-14f5-4442-9068-c39472fef050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002470D086010>]}
[0m15:04:13.890823 [info ] [Thread-1 (]: 1 of 5 OK created sql view model youtube_stg_youtube_stg.stg_youtube_channels .. [[32mCREATE VIEW (0 processed)[0m in 1.80s]
[0m15:04:13.899510 [info ] [Thread-2 (]: 2 of 5 OK created sql view model youtube_stg_youtube_stg.stg_youtube_video_ids . [[32mCREATE VIEW (0 processed)[0m in 1.79s]
[0m15:04:13.899510 [debug] [Thread-1 (]: Finished running node model.youtube_analytics.stg_youtube_channels
[0m15:04:13.899510 [debug] [Thread-2 (]: Finished running node model.youtube_analytics.stg_youtube_video_ids
[0m15:04:13.899510 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:04:14.009441 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:04:14.009441 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0' was properly closed.
[0m15:04:14.009441 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0' was properly closed.
[0m15:04:14.009441 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg' was properly closed.
[0m15:04:14.009441 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics' was properly closed.
[0m15:04:14.009441 [debug] [MainThread]: Connection 'model.youtube_analytics.stg_youtube_channels' was properly closed.
[0m15:04:14.025170 [debug] [MainThread]: Connection 'model.youtube_analytics.stg_youtube_video_ids' was properly closed.
[0m15:04:14.025170 [debug] [MainThread]: Connection 'model.youtube_analytics.stg_youtube_video_stats' was properly closed.
[0m15:04:14.027468 [info ] [MainThread]: 
[0m15:04:14.028528 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 3.50 seconds (3.50s).
[0m15:04:14.031943 [debug] [MainThread]: Command end result
[0m15:04:14.072018 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m15:04:14.072018 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m15:04:14.104248 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\run_results.json
[0m15:04:14.104248 [info ] [MainThread]: 
[0m15:04:14.104248 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:04:14.104248 [info ] [MainThread]: 
[0m15:04:14.104248 [error] [MainThread]: [31mFailure in model stg_youtube_video_stats (dbt/models\staging\stg_youtube_video_stats.sql)[0m
[0m15:04:14.104248 [error] [MainThread]:   Database Error in model stg_youtube_video_stats (dbt/models\staging\stg_youtube_video_stats.sql)
  Function not found: `cast` at [25:9]
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_video_stats.sql
[0m15:04:14.104248 [info ] [MainThread]: 
[0m15:04:14.120265 [info ] [MainThread]:   compiled code at target\compiled\youtube_analytics\dbt/models\staging\stg_youtube_video_stats.sql
[0m15:04:14.120265 [info ] [MainThread]: 
[0m15:04:14.120265 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=5
[0m15:04:14.120265 [debug] [MainThread]: Command `dbt run` failed at 15:04:14.120265 after 14.25 seconds
[0m15:04:14.120265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024756B00AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002475D182FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024756B85D10>]}
[0m15:04:14.120265 [debug] [MainThread]: Flushing usage events
[0m15:04:14.588985 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:08:14.211807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC43320210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC432D4E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC43323090>]}


============================== 15:08:14.228641 | e38222bf-9255-44ab-a3d2-538632ee71e1 ==============================
[0m15:08:14.228641 [info ] [MainThread]: Running with dbt=1.10.11
[0m15:08:14.229189 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\logs', 'profiles_dir': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m15:08:21.409178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e38222bf-9255-44ab-a3d2-538632ee71e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC719E9F10>]}
[0m15:08:21.572438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e38222bf-9255-44ab-a3d2-538632ee71e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC3FF63850>]}
[0m15:08:21.572438 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m15:08:23.470220 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m15:08:24.165043 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:08:24.165043 [debug] [MainThread]: Partial parsing: updated file: youtube_analytics://dbt/models\staging\stg_youtube_video_stats.sql
[0m15:08:25.461533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e38222bf-9255-44ab-a3d2-538632ee71e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC71A60090>]}
[0m15:08:25.602217 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m15:08:25.602217 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m15:08:25.667381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e38222bf-9255-44ab-a3d2-538632ee71e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC733B7B10>]}
[0m15:08:25.668843 [info ] [MainThread]: Found 5 models, 5 data tests, 495 macros
[0m15:08:25.669850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e38222bf-9255-44ab-a3d2-538632ee71e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC73327310>]}
[0m15:08:25.672867 [info ] [MainThread]: 
[0m15:08:25.673850 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m15:08:25.675299 [info ] [MainThread]: 
[0m15:08:25.677466 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:08:25.692087 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0'
[0m15:08:25.692087 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0'
[0m15:08:25.692087 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:25.696634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:26.696756 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg'
[0m15:08:26.696756 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:26.696756 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics'
[0m15:08:26.805427 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:27.674581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e38222bf-9255-44ab-a3d2-538632ee71e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC732557D0>]}
[0m15:08:27.674581 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:08:27.774396 [debug] [Thread-1 (]: Began running node model.youtube_analytics.stg_youtube_channels
[0m15:08:27.774396 [debug] [Thread-2 (]: Began running node model.youtube_analytics.stg_youtube_video_ids
[0m15:08:27.774396 [debug] [Thread-3 (]: Began running node model.youtube_analytics.stg_youtube_video_stats
[0m15:08:27.774396 [info ] [Thread-1 (]: 1 of 5 START sql view model youtube_stg_youtube_stg.stg_youtube_channels ....... [RUN]
[0m15:08:27.774396 [info ] [Thread-2 (]: 2 of 5 START sql view model youtube_stg_youtube_stg.stg_youtube_video_ids ...... [RUN]
[0m15:08:27.774396 [info ] [Thread-3 (]: 3 of 5 START sql view model youtube_stg_youtube_stg.stg_youtube_video_stats .... [RUN]
[0m15:08:27.774396 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_channels'
[0m15:08:27.786955 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_video_ids'
[0m15:08:27.786955 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_video_stats'
[0m15:08:27.790572 [debug] [Thread-1 (]: Began compiling node model.youtube_analytics.stg_youtube_channels
[0m15:08:27.790572 [debug] [Thread-2 (]: Began compiling node model.youtube_analytics.stg_youtube_video_ids
[0m15:08:27.790572 [debug] [Thread-3 (]: Began compiling node model.youtube_analytics.stg_youtube_video_stats
[0m15:08:27.806655 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_channels"
[0m15:08:27.811691 [debug] [Thread-2 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_video_ids"
[0m15:08:27.811691 [debug] [Thread-3 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_video_stats"
[0m15:08:27.811691 [debug] [Thread-1 (]: Began executing node model.youtube_analytics.stg_youtube_channels
[0m15:08:27.837853 [debug] [Thread-3 (]: Began executing node model.youtube_analytics.stg_youtube_video_stats
[0m15:08:27.856235 [debug] [Thread-2 (]: Began executing node model.youtube_analytics.stg_youtube_video_ids
[0m15:08:27.886050 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_channels"
[0m15:08:27.886050 [debug] [Thread-3 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_video_stats"
[0m15:08:27.899236 [debug] [Thread-2 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_video_ids"
[0m15:08:27.900788 [debug] [Thread-1 (]: On model.youtube_analytics.stg_youtube_channels: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_channels"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_channels`
  OPTIONS()
  as with src as (
  select
    id                                        as channel_id,
    snippet.title                             as channel_title,
    snippet.country                           as channel_country,
    snippet.publishedAt                       as channel_published_at,
    cast(statistics.viewCount       as int64) as channel_view_count,
    cast(statistics.subscriberCount as int64) as channel_subscribers,
    cast(statistics.videoCount      as int64) as channel_video_count,
    date(_partitiontime)                      as load_date
  from `orbital-nuance-471817-n0.youtube_raw.channels_raw`
)
select * from src;


[0m15:08:27.900788 [debug] [Thread-2 (]: On model.youtube_analytics.stg_youtube_video_ids: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_video_ids"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_ids`
  OPTIONS()
  as select
  videoId              as video_id,
  channelId            as channel_id,
  date(_partitiontime) as load_date
from `orbital-nuance-471817-n0.youtube_raw.video_ids_raw`;


[0m15:08:27.900788 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:08:27.900788 [debug] [Thread-3 (]: On model.youtube_analytics.stg_youtube_video_stats: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_video_stats"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
  OPTIONS()
  as with src as (
  select
    id                                     as video_id,
    snippet.channelId                      as channel_id,
    snippet.title                          as video_title,
    snippet.publishedAt                    as video_published_at,
    cast(statistics.viewCount    as int64) as views,
    cast(statistics.likeCount    as int64) as likes,
    cast(statistics.commentCount as int64) as comments,
    contentDetails.duration                as duration_iso,
    current_date()                         as load_date
  from `orbital-nuance-471817-n0.youtube_raw.video_stats_raw`
),
parsed as (
  select
    *,
    (
      coalesce(SAFE_CAST(REGEXP_EXTRACT(duration_iso, r'(\d+)H') AS INT64), 0) * 3600
      + coalesce(SAFE_CAST(REGEXP_EXTRACT(duration_iso, r'(\d+)M') AS INT64), 0) * 60
      + coalesce(SAFE_CAST(REGEXP_EXTRACT(duration_iso, r'(\d+)S') AS INT64), 0)
    ) as duration_seconds
  from src
)
select * from parsed;


[0m15:08:27.900788 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:08:28.005736 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:08:28.852116 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:cef28be1-7b23-4d0f-b394-64ae225621ed&page=queryresults
[0m15:08:28.867780 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:381c7324-b4fb-4653-8915-5a3dd0ae1a6a&page=queryresults
[0m15:08:29.403503 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e38222bf-9255-44ab-a3d2-538632ee71e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC72B62450>]}
[0m15:08:29.403503 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e38222bf-9255-44ab-a3d2-538632ee71e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC731D1590>]}
[0m15:08:29.403503 [info ] [Thread-3 (]: 3 of 5 OK created sql view model youtube_stg_youtube_stg.stg_youtube_video_stats  [[32mCREATE VIEW (0 processed)[0m in 1.62s]
[0m15:08:29.403503 [info ] [Thread-2 (]: 2 of 5 OK created sql view model youtube_stg_youtube_stg.stg_youtube_video_ids . [[32mCREATE VIEW (0 processed)[0m in 1.62s]
[0m15:08:29.414474 [debug] [Thread-3 (]: Finished running node model.youtube_analytics.stg_youtube_video_stats
[0m15:08:29.414474 [debug] [Thread-2 (]: Finished running node model.youtube_analytics.stg_youtube_video_ids
[0m15:08:29.414474 [debug] [Thread-4 (]: Began running node model.youtube_analytics.fct_video_daily_metrics
[0m15:08:29.414474 [info ] [Thread-4 (]: 4 of 5 START sql table model youtube_stg_youtube_analytics.fct_video_daily_metrics  [RUN]
[0m15:08:29.414474 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.youtube_analytics.fct_video_daily_metrics'
[0m15:08:29.414474 [debug] [Thread-4 (]: Began compiling node model.youtube_analytics.fct_video_daily_metrics
[0m15:08:29.430673 [debug] [Thread-4 (]: Writing injected SQL for node "model.youtube_analytics.fct_video_daily_metrics"
[0m15:08:29.434195 [debug] [Thread-4 (]: Began executing node model.youtube_analytics.fct_video_daily_metrics
[0m15:08:29.508104 [debug] [Thread-4 (]: Writing runtime sql for node "model.youtube_analytics.fct_video_daily_metrics"
[0m15:08:29.508104 [debug] [Thread-4 (]: On model.youtube_analytics.fct_video_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.fct_video_daily_metrics"} */

  
    

    create or replace table `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
      
    
    

    
    OPTIONS()
    as (
      with daily as (
  select
    video_id,
    channel_id,
    load_date,
    views,
    likes,
    comments
  from `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
),
with_lag as (
  select
    *,
    lag(views)    over (partition by video_id order by load_date) as prev_views,
    lag(likes)    over (partition by video_id order by load_date) as prev_likes,
    lag(comments) over (partition by video_id order by load_date) as prev_comments
  from daily
)
select
  video_id,
  channel_id,
  load_date,
  views,
  likes,
  comments,
  views    - coalesce(prev_views, 0)    as daily_views,
  likes    - coalesce(prev_likes, 0)    as daily_likes,
  comments - coalesce(prev_comments, 0) as daily_comments
from with_lag
    );
  
[0m15:08:29.508104 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:08:29.790575 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:f7752a7e-ff92-4789-a10c-f7763a5c953f&page=queryresults
[0m15:08:30.274355 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e38222bf-9255-44ab-a3d2-538632ee71e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC734D5890>]}
[0m15:08:30.274355 [info ] [Thread-1 (]: 1 of 5 OK created sql view model youtube_stg_youtube_stg.stg_youtube_channels .. [[32mCREATE VIEW (0 processed)[0m in 2.50s]
[0m15:08:30.274355 [debug] [Thread-1 (]: Finished running node model.youtube_analytics.stg_youtube_channels
[0m15:08:30.477890 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:287ee0bd-99dc-4e61-8862-5932cf355a97&page=queryresults
[0m15:08:32.730432 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e38222bf-9255-44ab-a3d2-538632ee71e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC734F5090>]}
[0m15:08:32.730432 [info ] [Thread-4 (]: 4 of 5 OK created sql table model youtube_stg_youtube_analytics.fct_video_daily_metrics  [[32mCREATE TABLE (20.0 rows, 1.2 KiB processed)[0m in 3.32s]
[0m15:08:32.730432 [debug] [Thread-4 (]: Finished running node model.youtube_analytics.fct_video_daily_metrics
[0m15:08:32.739479 [debug] [Thread-3 (]: Began running node model.youtube_analytics.agg_channel_trends_7d
[0m15:08:32.739479 [info ] [Thread-3 (]: 5 of 5 START sql table model youtube_stg_youtube_analytics.agg_channel_trends_7d  [RUN]
[0m15:08:32.741498 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.youtube_analytics.stg_youtube_video_stats, now model.youtube_analytics.agg_channel_trends_7d)
[0m15:08:32.743504 [debug] [Thread-3 (]: Began compiling node model.youtube_analytics.agg_channel_trends_7d
[0m15:08:32.749868 [debug] [Thread-3 (]: Writing injected SQL for node "model.youtube_analytics.agg_channel_trends_7d"
[0m15:08:32.751883 [debug] [Thread-3 (]: Began executing node model.youtube_analytics.agg_channel_trends_7d
[0m15:08:32.761765 [debug] [Thread-3 (]: Writing runtime sql for node "model.youtube_analytics.agg_channel_trends_7d"
[0m15:08:32.779016 [debug] [Thread-3 (]: On model.youtube_analytics.agg_channel_trends_7d: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.agg_channel_trends_7d"} */

  
    

    create or replace table `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`agg_channel_trends_7d`
      
    
    

    
    OPTIONS()
    as (
      with daily as (
  select
    channel_id,
    video_id,
    load_date,
    daily_views,
    daily_likes,
    daily_comments
  from `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
),
rollup as (
  select
    channel_id,
    load_date,
    sum(daily_views)    over (partition by channel_id order by load_date rows between 6 preceding and current row) as views_7d,
    sum(daily_likes)    over (partition by channel_id order by load_date rows between 6 preceding and current row) as likes_7d,
    sum(daily_comments) over (partition by channel_id order by load_date rows between 6 preceding and current row) as comments_7d
  from daily
)
select distinct channel_id, load_date, views_7d, likes_7d, comments_7d
from rollup
    );
  
[0m15:08:32.780106 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:08:33.449667 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:3c058c22-5125-40e7-b562-4305ec3f9ae3&page=queryresults
[0m15:08:33.449667 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:3c058c22-5125-40e7-b562-4305ec3f9ae3&page=queryresults
[0m15:08:33.456509 [debug] [Thread-3 (]: Database Error in model agg_channel_trends_7d (dbt/models\marts\agg_channel_trends_7d.sql)
  Syntax error: Expected keyword SELECT but got keyword ROLLUP at [24:1]
  compiled code at target\run\youtube_analytics\dbt/models\marts\agg_channel_trends_7d.sql
[0m15:08:33.458514 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e38222bf-9255-44ab-a3d2-538632ee71e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC738164D0>]}
[0m15:08:33.458514 [error] [Thread-3 (]: 5 of 5 ERROR creating sql table model youtube_stg_youtube_analytics.agg_channel_trends_7d  [[31mERROR[0m in 0.72s]
[0m15:08:33.458514 [debug] [Thread-3 (]: Finished running node model.youtube_analytics.agg_channel_trends_7d
[0m15:08:33.460519 [debug] [Thread-7 (]: Marking all children of 'model.youtube_analytics.agg_channel_trends_7d' to be skipped because of status 'error'.  Reason: Database Error in model agg_channel_trends_7d (dbt/models\marts\agg_channel_trends_7d.sql)
  Syntax error: Expected keyword SELECT but got keyword ROLLUP at [24:1]
  compiled code at target\run\youtube_analytics\dbt/models\marts\agg_channel_trends_7d.sql.
[0m15:08:33.462125 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:08:33.603241 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:08:33.604237 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0' was properly closed.
[0m15:08:33.605342 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0' was properly closed.
[0m15:08:33.607358 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg' was properly closed.
[0m15:08:33.608486 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics' was properly closed.
[0m15:08:33.609466 [debug] [MainThread]: Connection 'model.youtube_analytics.stg_youtube_channels' was properly closed.
[0m15:08:33.610466 [debug] [MainThread]: Connection 'model.youtube_analytics.stg_youtube_video_ids' was properly closed.
[0m15:08:33.611448 [debug] [MainThread]: Connection 'model.youtube_analytics.agg_channel_trends_7d' was properly closed.
[0m15:08:33.612360 [debug] [MainThread]: Connection 'model.youtube_analytics.fct_video_daily_metrics' was properly closed.
[0m15:08:33.614356 [info ] [MainThread]: 
[0m15:08:33.615483 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 7.94 seconds (7.94s).
[0m15:08:33.621760 [debug] [MainThread]: Command end result
[0m15:08:33.696202 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m15:08:33.699659 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m15:08:33.712057 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\run_results.json
[0m15:08:33.712057 [info ] [MainThread]: 
[0m15:08:33.712057 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:08:33.712057 [info ] [MainThread]: 
[0m15:08:33.712057 [error] [MainThread]: [31mFailure in model agg_channel_trends_7d (dbt/models\marts\agg_channel_trends_7d.sql)[0m
[0m15:08:33.712057 [error] [MainThread]:   Database Error in model agg_channel_trends_7d (dbt/models\marts\agg_channel_trends_7d.sql)
  Syntax error: Expected keyword SELECT but got keyword ROLLUP at [24:1]
  compiled code at target\run\youtube_analytics\dbt/models\marts\agg_channel_trends_7d.sql
[0m15:08:33.712057 [info ] [MainThread]: 
[0m15:08:33.712057 [info ] [MainThread]:   compiled code at target\compiled\youtube_analytics\dbt/models\marts\agg_channel_trends_7d.sql
[0m15:08:33.712057 [info ] [MainThread]: 
[0m15:08:33.712057 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m15:08:33.712057 [debug] [MainThread]: Command `dbt run` failed at 15:08:33.712057 after 19.57 seconds
[0m15:08:33.712057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC4334FA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC3C9A0990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC71AE98D0>]}
[0m15:08:33.728280 [debug] [MainThread]: Flushing usage events
[0m15:08:34.229545 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:13:05.086945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C29B8F8550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C29B8F2CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C29A743890>]}


============================== 15:13:05.086945 | d6b2e1d2-58a9-4dae-af5a-64d0de0b09b2 ==============================
[0m15:13:05.086945 [info ] [MainThread]: Running with dbt=1.10.11
[0m15:13:05.086945 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\logs', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m15:13:11.590095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6b2e1d2-58a9-4dae-af5a-64d0de0b09b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C29AA7A9D0>]}
[0m15:13:11.806343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6b2e1d2-58a9-4dae-af5a-64d0de0b09b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C298532A50>]}
[0m15:13:11.806343 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m15:13:13.633777 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m15:13:14.338911 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:13:14.338911 [debug] [MainThread]: Partial parsing: updated file: youtube_analytics://dbt/models\marts\agg_channel_trends_7d.sql
[0m15:13:15.010332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6b2e1d2-58a9-4dae-af5a-64d0de0b09b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2CB4CB490>]}
[0m15:13:15.231553 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m15:13:15.235663 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m15:13:15.303938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6b2e1d2-58a9-4dae-af5a-64d0de0b09b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2CB6CA510>]}
[0m15:13:15.306459 [info ] [MainThread]: Found 5 models, 5 data tests, 495 macros
[0m15:13:15.306459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6b2e1d2-58a9-4dae-af5a-64d0de0b09b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2CB7B4D90>]}
[0m15:13:15.306459 [info ] [MainThread]: 
[0m15:13:15.306459 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m15:13:15.306459 [info ] [MainThread]: 
[0m15:13:15.306459 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:13:15.325099 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0'
[0m15:13:15.325099 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:15.325099 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0'
[0m15:13:15.463392 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:16.176197 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics'
[0m15:13:16.180691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:16.182706 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg'
[0m15:13:16.182706 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:16.999128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6b2e1d2-58a9-4dae-af5a-64d0de0b09b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C29B9A5D10>]}
[0m15:13:17.001267 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:13:17.243021 [debug] [Thread-1 (]: Began running node model.youtube_analytics.stg_youtube_channels
[0m15:13:17.251733 [debug] [Thread-2 (]: Began running node model.youtube_analytics.stg_youtube_video_ids
[0m15:13:17.251733 [debug] [Thread-3 (]: Began running node model.youtube_analytics.stg_youtube_video_stats
[0m15:13:17.251733 [info ] [Thread-1 (]: 1 of 5 START sql view model youtube_stg_youtube_stg.stg_youtube_channels ....... [RUN]
[0m15:13:17.251733 [info ] [Thread-2 (]: 2 of 5 START sql view model youtube_stg_youtube_stg.stg_youtube_video_ids ...... [RUN]
[0m15:13:17.258739 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_channels'
[0m15:13:17.258739 [info ] [Thread-3 (]: 3 of 5 START sql view model youtube_stg_youtube_stg.stg_youtube_video_stats .... [RUN]
[0m15:13:17.258739 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_video_ids'
[0m15:13:17.258739 [debug] [Thread-1 (]: Began compiling node model.youtube_analytics.stg_youtube_channels
[0m15:13:17.258739 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_video_stats'
[0m15:13:17.258739 [debug] [Thread-2 (]: Began compiling node model.youtube_analytics.stg_youtube_video_ids
[0m15:13:17.275051 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_channels"
[0m15:13:17.275051 [debug] [Thread-3 (]: Began compiling node model.youtube_analytics.stg_youtube_video_stats
[0m15:13:17.290464 [debug] [Thread-2 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_video_ids"
[0m15:13:17.290464 [debug] [Thread-3 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_video_stats"
[0m15:13:17.290464 [debug] [Thread-1 (]: Began executing node model.youtube_analytics.stg_youtube_channels
[0m15:13:17.290464 [debug] [Thread-3 (]: Began executing node model.youtube_analytics.stg_youtube_video_stats
[0m15:13:17.306277 [debug] [Thread-2 (]: Began executing node model.youtube_analytics.stg_youtube_video_ids
[0m15:13:17.368673 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_channels"
[0m15:13:17.377334 [debug] [Thread-3 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_video_stats"
[0m15:13:17.384434 [debug] [Thread-2 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_video_ids"
[0m15:13:17.393194 [debug] [Thread-1 (]: On model.youtube_analytics.stg_youtube_channels: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_channels"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_channels`
  OPTIONS()
  as with src as (
  select
    id                                        as channel_id,
    snippet.title                             as channel_title,
    snippet.country                           as channel_country,
    snippet.publishedAt                       as channel_published_at,
    cast(statistics.viewCount       as int64) as channel_view_count,
    cast(statistics.subscriberCount as int64) as channel_subscribers,
    cast(statistics.videoCount      as int64) as channel_video_count,
    date(_partitiontime)                      as load_date
  from `orbital-nuance-471817-n0.youtube_raw.channels_raw`
)
select * from src;


[0m15:13:17.395561 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:13:17.395561 [debug] [Thread-3 (]: On model.youtube_analytics.stg_youtube_video_stats: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_video_stats"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
  OPTIONS()
  as with src as (
  select
    id                                     as video_id,
    snippet.channelId                      as channel_id,
    snippet.title                          as video_title,
    snippet.publishedAt                    as video_published_at,
    cast(statistics.viewCount    as int64) as views,
    cast(statistics.likeCount    as int64) as likes,
    cast(statistics.commentCount as int64) as comments,
    contentDetails.duration                as duration_iso,
    current_date()                         as load_date
  from `orbital-nuance-471817-n0.youtube_raw.video_stats_raw`
),
parsed as (
  select
    *,
    (
      coalesce(SAFE_CAST(REGEXP_EXTRACT(duration_iso, r'(\d+)H') AS INT64), 0) * 3600
      + coalesce(SAFE_CAST(REGEXP_EXTRACT(duration_iso, r'(\d+)M') AS INT64), 0) * 60
      + coalesce(SAFE_CAST(REGEXP_EXTRACT(duration_iso, r'(\d+)S') AS INT64), 0)
    ) as duration_seconds
  from src
)
select * from parsed;


[0m15:13:17.395561 [debug] [Thread-2 (]: On model.youtube_analytics.stg_youtube_video_ids: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_video_ids"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_ids`
  OPTIONS()
  as select
  videoId              as video_id,
  channelId            as channel_id,
  date(_partitiontime) as load_date
from `orbital-nuance-471817-n0.youtube_raw.video_ids_raw`;


[0m15:13:17.478920 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:13:17.478920 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:13:18.428054 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:b7f064c5-031d-4d0e-be07-78f2e9b4738a&page=queryresults
[0m15:13:18.431052 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:d73b3a5c-7d9d-437e-8467-376c7547ec6f&page=queryresults
[0m15:13:18.433802 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:455d64f3-d506-442b-b4f8-8944ca451c6f&page=queryresults
[0m15:13:19.078285 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6b2e1d2-58a9-4dae-af5a-64d0de0b09b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2CB995850>]}
[0m15:13:19.080399 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6b2e1d2-58a9-4dae-af5a-64d0de0b09b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2CB994ED0>]}
[0m15:13:19.081392 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6b2e1d2-58a9-4dae-af5a-64d0de0b09b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2CB9959D0>]}
[0m15:13:19.083390 [info ] [Thread-3 (]: 3 of 5 OK created sql view model youtube_stg_youtube_stg.stg_youtube_video_stats  [[32mCREATE VIEW (0 processed)[0m in 1.81s]
[0m15:13:19.085435 [info ] [Thread-1 (]: 1 of 5 OK created sql view model youtube_stg_youtube_stg.stg_youtube_channels .. [[32mCREATE VIEW (0 processed)[0m in 1.82s]
[0m15:13:19.086502 [info ] [Thread-2 (]: 2 of 5 OK created sql view model youtube_stg_youtube_stg.stg_youtube_video_ids . [[32mCREATE VIEW (0 processed)[0m in 1.82s]
[0m15:13:19.087557 [debug] [Thread-3 (]: Finished running node model.youtube_analytics.stg_youtube_video_stats
[0m15:13:19.087557 [debug] [Thread-1 (]: Finished running node model.youtube_analytics.stg_youtube_channels
[0m15:13:19.092365 [debug] [Thread-2 (]: Finished running node model.youtube_analytics.stg_youtube_video_ids
[0m15:13:19.092365 [debug] [Thread-4 (]: Began running node model.youtube_analytics.fct_video_daily_metrics
[0m15:13:19.092365 [info ] [Thread-4 (]: 4 of 5 START sql table model youtube_stg_youtube_analytics.fct_video_daily_metrics  [RUN]
[0m15:13:19.092365 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.youtube_analytics.fct_video_daily_metrics'
[0m15:13:19.100573 [debug] [Thread-4 (]: Began compiling node model.youtube_analytics.fct_video_daily_metrics
[0m15:13:19.108938 [debug] [Thread-4 (]: Writing injected SQL for node "model.youtube_analytics.fct_video_daily_metrics"
[0m15:13:19.110951 [debug] [Thread-4 (]: Began executing node model.youtube_analytics.fct_video_daily_metrics
[0m15:13:19.134729 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:13:19.790980 [debug] [Thread-4 (]: Writing runtime sql for node "model.youtube_analytics.fct_video_daily_metrics"
[0m15:13:19.790980 [debug] [Thread-4 (]: On model.youtube_analytics.fct_video_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.fct_video_daily_metrics"} */

  
    

    create or replace table `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
      
    
    

    
    OPTIONS()
    as (
      with daily as (
  select
    video_id,
    channel_id,
    load_date,
    views,
    likes,
    comments
  from `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
),
with_lag as (
  select
    *,
    lag(views)    over (partition by video_id order by load_date) as prev_views,
    lag(likes)    over (partition by video_id order by load_date) as prev_likes,
    lag(comments) over (partition by video_id order by load_date) as prev_comments
  from daily
)
select
  video_id,
  channel_id,
  load_date,
  views,
  likes,
  comments,
  views    - coalesce(prev_views, 0)    as daily_views,
  likes    - coalesce(prev_likes, 0)    as daily_likes,
  comments - coalesce(prev_comments, 0) as daily_comments
from with_lag
    );
  
[0m15:13:20.416574 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:b70816c8-9915-4170-a2d2-1b813cb5857a&page=queryresults
[0m15:13:23.149660 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6b2e1d2-58a9-4dae-af5a-64d0de0b09b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2CB860D10>]}
[0m15:13:23.149660 [info ] [Thread-4 (]: 4 of 5 OK created sql table model youtube_stg_youtube_analytics.fct_video_daily_metrics  [[32mCREATE TABLE (20.0 rows, 1.2 KiB processed)[0m in 4.06s]
[0m15:13:23.149660 [debug] [Thread-4 (]: Finished running node model.youtube_analytics.fct_video_daily_metrics
[0m15:13:23.149660 [debug] [Thread-3 (]: Began running node model.youtube_analytics.agg_channel_trends_7d
[0m15:13:23.156198 [info ] [Thread-3 (]: 5 of 5 START sql table model youtube_stg_youtube_analytics.agg_channel_trends_7d  [RUN]
[0m15:13:23.156198 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.youtube_analytics.stg_youtube_video_stats, now model.youtube_analytics.agg_channel_trends_7d)
[0m15:13:23.156198 [debug] [Thread-3 (]: Began compiling node model.youtube_analytics.agg_channel_trends_7d
[0m15:13:23.165677 [debug] [Thread-3 (]: Writing injected SQL for node "model.youtube_analytics.agg_channel_trends_7d"
[0m15:13:23.165677 [debug] [Thread-3 (]: Began executing node model.youtube_analytics.agg_channel_trends_7d
[0m15:13:23.181709 [debug] [Thread-3 (]: Writing runtime sql for node "model.youtube_analytics.agg_channel_trends_7d"
[0m15:13:23.186342 [debug] [Thread-3 (]: On model.youtube_analytics.agg_channel_trends_7d: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.agg_channel_trends_7d"} */

  
    

    create or replace table `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`agg_channel_trends_7d`
      
    
    

    
    OPTIONS()
    as (
      with daily as (
  select
    channel_id,
    video_id,
    load_date,
    daily_views,
    daily_likes,
    daily_comments
  from `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
),
rollup_cte as (
  select
    channel_id,
    load_date,
    sum(daily_views)    over (
      partition by channel_id
      order by load_date
      rows between 6 preceding and current row
    ) as views_7d,
    sum(daily_likes)    over (
      partition by channel_id
      order by load_date
      rows between 6 preceding and current row
    ) as likes_7d,
    sum(daily_comments) over (
      partition by channel_id
      order by load_date
      rows between 6 preceding and current row
    ) as comments_7d
  from daily
)
select distinct channel_id, load_date, views_7d, likes_7d, comments_7d
from rollup_cte
    );
  
[0m15:13:23.186342 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:13:24.263193 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:c5b39de7-75d4-4666-a239-056ae63fa5e4&page=queryresults
[0m15:13:26.625076 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6b2e1d2-58a9-4dae-af5a-64d0de0b09b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2CBD4FC50>]}
[0m15:13:26.626068 [info ] [Thread-3 (]: 5 of 5 OK created sql table model youtube_stg_youtube_analytics.agg_channel_trends_7d  [[32mCREATE TABLE (20.0 rows, 1.1 KiB processed)[0m in 3.47s]
[0m15:13:26.627069 [debug] [Thread-3 (]: Finished running node model.youtube_analytics.agg_channel_trends_7d
[0m15:13:26.631079 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:13:26.758498 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:13:26.760508 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0' was properly closed.
[0m15:13:26.763392 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0' was properly closed.
[0m15:13:26.764496 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics' was properly closed.
[0m15:13:26.765494 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg' was properly closed.
[0m15:13:26.766459 [debug] [MainThread]: Connection 'model.youtube_analytics.stg_youtube_channels' was properly closed.
[0m15:13:26.766459 [debug] [MainThread]: Connection 'model.youtube_analytics.stg_youtube_video_ids' was properly closed.
[0m15:13:26.767404 [debug] [MainThread]: Connection 'model.youtube_analytics.agg_channel_trends_7d' was properly closed.
[0m15:13:26.768429 [debug] [MainThread]: Connection 'model.youtube_analytics.fct_video_daily_metrics' was properly closed.
[0m15:13:26.769385 [info ] [MainThread]: 
[0m15:13:26.771117 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 11.46 seconds (11.46s).
[0m15:13:26.775515 [debug] [MainThread]: Command end result
[0m15:13:26.853188 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m15:13:26.859535 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m15:13:26.869295 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\run_results.json
[0m15:13:26.869295 [info ] [MainThread]: 
[0m15:13:26.869295 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:13:26.869295 [info ] [MainThread]: 
[0m15:13:26.869295 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m15:13:26.885119 [debug] [MainThread]: Command `dbt run` succeeded at 15:13:26.885119 after 21.87 seconds
[0m15:13:26.887618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C29B5787D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C29B92B3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C294F73D90>]}
[0m15:13:26.889631 [debug] [MainThread]: Flushing usage events
[0m15:13:27.353509 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:13:42.011398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EFA3C7690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EFA43FA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EFA410950>]}


============================== 15:13:42.017144 | 4fd32fa9-7dba-47c6-a0c4-3357a0f1c4bb ==============================
[0m15:13:42.017144 [info ] [MainThread]: Running with dbt=1.10.11
[0m15:13:42.018305 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'printer_width': '80', 'empty': 'None', 'use_experimental_parser': 'False', 'log_path': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m15:13:49.805867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4fd32fa9-7dba-47c6-a0c4-3357a0f1c4bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EA8CF5710>]}
[0m15:13:50.010719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4fd32fa9-7dba-47c6-a0c4-3357a0f1c4bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EF7052650>]}
[0m15:13:50.012720 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m15:13:52.055664 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m15:13:52.639038 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:13:52.640042 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:13:52.712808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fd32fa9-7dba-47c6-a0c4-3357a0f1c4bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EAA263190>]}
[0m15:13:52.884889 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m15:13:52.884889 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m15:13:52.980910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fd32fa9-7dba-47c6-a0c4-3357a0f1c4bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EAA44FE50>]}
[0m15:13:52.980910 [info ] [MainThread]: Found 5 models, 5 data tests, 495 macros
[0m15:13:52.980910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fd32fa9-7dba-47c6-a0c4-3357a0f1c4bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EA8BCCE50>]}
[0m15:13:52.987009 [info ] [MainThread]: 
[0m15:13:52.987009 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m15:13:52.987009 [info ] [MainThread]: 
[0m15:13:52.992563 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:13:53.001049 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg'
[0m15:13:53.004623 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:53.004623 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics'
[0m15:13:53.104761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:53.697775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fd32fa9-7dba-47c6-a0c4-3357a0f1c4bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EF9A85310>]}
[0m15:13:53.697775 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:13:53.842671 [debug] [Thread-1 (]: Began running node test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267
[0m15:13:53.843670 [debug] [Thread-2 (]: Began running node test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1
[0m15:13:53.844955 [debug] [Thread-3 (]: Began running node test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7
[0m15:13:53.846539 [debug] [Thread-4 (]: Began running node test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602
[0m15:13:53.848559 [info ] [Thread-1 (]: 1 of 5 START test not_null_fct_video_daily_metrics_load_date ................... [RUN]
[0m15:13:53.849553 [info ] [Thread-2 (]: 2 of 5 START test not_null_fct_video_daily_metrics_video_id .................... [RUN]
[0m15:13:53.850558 [info ] [Thread-3 (]: 3 of 5 START test not_null_stg_youtube_video_stats_load_date ................... [RUN]
[0m15:13:53.852016 [info ] [Thread-4 (]: 4 of 5 START test not_null_stg_youtube_video_stats_video_id .................... [RUN]
[0m15:13:53.853035 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267'
[0m15:13:53.853035 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1'
[0m15:13:53.853035 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7'
[0m15:13:53.853035 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602'
[0m15:13:53.853035 [debug] [Thread-1 (]: Began compiling node test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267
[0m15:13:53.853035 [debug] [Thread-2 (]: Began compiling node test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1
[0m15:13:53.853035 [debug] [Thread-3 (]: Began compiling node test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7
[0m15:13:53.853035 [debug] [Thread-4 (]: Began compiling node test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602
[0m15:13:53.905621 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267"
[0m15:13:53.907634 [debug] [Thread-2 (]: Writing injected SQL for node "test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1"
[0m15:13:53.916407 [debug] [Thread-3 (]: Writing injected SQL for node "test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7"
[0m15:13:53.932487 [debug] [Thread-4 (]: Writing injected SQL for node "test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602"
[0m15:13:53.932487 [debug] [Thread-2 (]: Began executing node test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1
[0m15:13:53.983329 [debug] [Thread-2 (]: Writing runtime sql for node "test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1"
[0m15:13:53.985337 [debug] [Thread-4 (]: Began executing node test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602
[0m15:13:53.985337 [debug] [Thread-3 (]: Began executing node test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7
[0m15:13:53.985337 [debug] [Thread-1 (]: Began executing node test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267
[0m15:13:53.993067 [debug] [Thread-4 (]: Writing runtime sql for node "test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602"
[0m15:13:54.004212 [debug] [Thread-3 (]: Writing runtime sql for node "test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7"
[0m15:13:54.011571 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267"
[0m15:13:54.011571 [debug] [Thread-2 (]: On test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select video_id
from `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
where video_id is null



  
  
      
    ) dbt_internal_test
[0m15:13:54.011571 [debug] [Thread-3 (]: On test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select load_date
from `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
where load_date is null



  
  
      
    ) dbt_internal_test
[0m15:13:54.011571 [debug] [Thread-4 (]: On test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select video_id
from `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
where video_id is null



  
  
      
    ) dbt_internal_test
[0m15:13:54.011571 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:13:54.011571 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:13:54.025317 [debug] [Thread-1 (]: On test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select load_date
from `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
where load_date is null



  
  
      
    ) dbt_internal_test
[0m15:13:54.026590 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:13:54.389516 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:13:55.383345 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:fd455fb4-9fd5-47ee-a6ec-7cb4d2d9937b&page=queryresults
[0m15:13:55.383345 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:a82b1058-cb2a-4337-9e0b-c61edcc411d3&page=queryresults
[0m15:13:55.399084 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:d0faa56b-cb99-424a-a606-c7f46aaa607b&page=queryresults
[0m15:13:55.399084 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:7e7b2de0-d47c-4616-be67-a3e72fc071b5&page=queryresults
[0m15:13:56.108000 [info ] [Thread-2 (]: 2 of 5 PASS not_null_fct_video_daily_metrics_video_id .......................... [[32mPASS[0m in 2.25s]
[0m15:13:56.108000 [debug] [Thread-2 (]: Finished running node test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1
[0m15:13:56.108000 [debug] [Thread-2 (]: Began running node test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e
[0m15:13:56.108000 [info ] [Thread-2 (]: 5 of 5 START test unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_  [RUN]
[0m15:13:56.120149 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1, now test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e)
[0m15:13:56.120149 [info ] [Thread-1 (]: 1 of 5 PASS not_null_fct_video_daily_metrics_load_date ......................... [[32mPASS[0m in 2.27s]
[0m15:13:56.120149 [debug] [Thread-2 (]: Began compiling node test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e
[0m15:13:56.120149 [debug] [Thread-1 (]: Finished running node test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267
[0m15:13:56.127349 [debug] [Thread-2 (]: Writing injected SQL for node "test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e"
[0m15:13:56.127349 [debug] [Thread-2 (]: Began executing node test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e
[0m15:13:56.127349 [debug] [Thread-2 (]: Writing runtime sql for node "test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e"
[0m15:13:56.127349 [debug] [Thread-2 (]: On test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select video_id || '-' || cast(load_date as string) as unique_field
  from `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
  where video_id || '-' || cast(load_date as string) is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:13:56.134300 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:13:56.220900 [info ] [Thread-4 (]: 4 of 5 PASS not_null_stg_youtube_video_stats_video_id .......................... [[32mPASS[0m in 2.37s]
[0m15:13:56.230308 [info ] [Thread-3 (]: 3 of 5 PASS not_null_stg_youtube_video_stats_load_date ......................... [[32mPASS[0m in 2.38s]
[0m15:13:56.231305 [debug] [Thread-4 (]: Finished running node test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602
[0m15:13:56.234516 [debug] [Thread-3 (]: Finished running node test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7
[0m15:13:57.244228 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:d210f247-ddb3-4cc1-9d23-7aeae4aba2f5&page=queryresults
[0m15:13:57.950787 [info ] [Thread-2 (]: 5 of 5 PASS unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_ .. [[32mPASS[0m in 1.83s]
[0m15:13:57.950787 [debug] [Thread-2 (]: Finished running node test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e
[0m15:13:57.954358 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:13:58.133101 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:13:58.133101 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg' was properly closed.
[0m15:13:58.133101 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics' was properly closed.
[0m15:13:58.133101 [debug] [MainThread]: Connection 'test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267' was properly closed.
[0m15:13:58.133101 [debug] [MainThread]: Connection 'test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e' was properly closed.
[0m15:13:58.133101 [debug] [MainThread]: Connection 'test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7' was properly closed.
[0m15:13:58.133101 [debug] [MainThread]: Connection 'test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602' was properly closed.
[0m15:13:58.133101 [info ] [MainThread]: 
[0m15:13:58.133101 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 5.14 seconds (5.14s).
[0m15:13:58.151214 [debug] [MainThread]: Command end result
[0m15:13:58.221094 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m15:13:58.226966 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m15:13:58.243127 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\run_results.json
[0m15:13:58.246638 [info ] [MainThread]: 
[0m15:13:58.246638 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:13:58.246638 [info ] [MainThread]: 
[0m15:13:58.246638 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m15:13:58.246638 [debug] [MainThread]: Command `dbt test` succeeded at 15:13:58.246638 after 16.32 seconds
[0m15:13:58.246638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EF7041490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EAA8C7E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EF3A93D90>]}
[0m15:13:58.246638 [debug] [MainThread]: Flushing usage events
[0m15:13:58.640580 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:38:00.363513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB63FA7650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB63FCF6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB63E5E510>]}


============================== 12:38:00.363513 | 8db8fab8-8c0f-4018-b615-54b8c38ef51b ==============================
[0m12:38:00.363513 [info ] [MainThread]: Running with dbt=1.10.11
[0m12:38:00.370924 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\logs', 'profiles_dir': 'C:\\Users\\lyx\\.dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m12:38:00.370924 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'youtube_analytics'
[0m12:38:00.370924 [debug] [MainThread]: Command `dbt run` failed at 12:38:00.370924 after 0.10 seconds
[0m12:38:00.370924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB5D650910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB6401D9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB5D6D5DD0>]}
[0m12:38:00.370924 [debug] [MainThread]: Flushing usage events
[0m12:38:00.792706 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:38:13.880185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC7F299C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC7EFEE4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC7F21E0D0>]}


============================== 12:38:13.884293 | 6f1b34ca-fd46-4cee-8b78-09fc1cd3d81d ==============================
[0m12:38:13.884293 [info ] [MainThread]: Running with dbt=1.10.11
[0m12:38:13.885343 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt debug', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\logs', 'profiles_dir': 'C:\\Users\\lyx\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m12:38:13.935148 [info ] [MainThread]: dbt version: 1.10.11
[0m12:38:13.935148 [info ] [MainThread]: python version: 3.11.1
[0m12:38:13.935148 [info ] [MainThread]: python path: C:\Users\lyx\AppData\Local\Programs\Python\Python311\python.exe
[0m12:38:13.935148 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m12:38:13.935148 [info ] [MainThread]: Using profiles dir at C:\Users\lyx\.dbt
[0m12:38:13.935148 [info ] [MainThread]: Using profiles.yml file at C:\Users\lyx\.dbt\profiles.yml
[0m12:38:13.935148 [info ] [MainThread]: Using dbt_project.yml file at D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\dbt_project.yml
[0m12:38:14.011860 [info ] [MainThread]: Configuration:
[0m12:38:14.011860 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m12:38:14.011860 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:38:14.027602 [info ] [MainThread]: Required dependencies:
[0m12:38:14.027602 [debug] [MainThread]: Executing "git --help"
[0m12:38:14.076116 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:38:14.076116 [debug] [MainThread]: STDERR: "b''"
[0m12:38:14.076116 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:38:14.076116 [info ] [MainThread]: Connection test skipped since no profile was found
[0m12:38:14.076116 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:38:14.076116 [info ] [MainThread]: dbt looked for a profiles.yml file in C:\Users\lyx\.dbt\profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m12:38:14.076116 [debug] [MainThread]: Command `dbt debug` failed at 12:38:14.076116 after 0.29 seconds
[0m12:38:14.076116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC7874F250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC7F21DFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC7F21FC10>]}
[0m12:38:14.076116 [debug] [MainThread]: Flushing usage events
[0m12:38:14.484493 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:49:56.250266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD8F89BB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD8F81E710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD8F81FC50>]}


============================== 12:49:56.253669 | 646471c5-917f-4cff-947b-ab1066cfab43 ==============================
[0m12:49:56.253669 [info ] [MainThread]: Running with dbt=1.10.11
[0m12:49:56.254639 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt debug', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'logs', 'profiles_dir': 'C:\\Users\\lyx\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m12:49:56.261429 [info ] [MainThread]: dbt version: 1.10.11
[0m12:49:56.261429 [info ] [MainThread]: python version: 3.11.1
[0m12:49:56.261429 [info ] [MainThread]: python path: C:\Users\lyx\AppData\Local\Programs\Python\Python311\python.exe
[0m12:49:56.261429 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m12:49:56.261429 [info ] [MainThread]: Using profiles dir at C:\Users\lyx\.dbt
[0m12:49:56.277438 [info ] [MainThread]: Using profiles.yml file at C:\Users\lyx\.dbt\profiles.yml
[0m12:49:56.277438 [info ] [MainThread]: Using dbt_project.yml file at D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\dbt_project.yml
[0m12:49:56.277438 [info ] [MainThread]: Configuration:
[0m12:49:56.277438 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m12:49:56.277438 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m12:49:56.277438 [info ] [MainThread]: Required dependencies:
[0m12:49:56.277438 [debug] [MainThread]: Executing "git --help"
[0m12:49:56.316837 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:49:56.316837 [debug] [MainThread]: STDERR: "b''"
[0m12:49:56.316837 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:49:56.316837 [info ] [MainThread]: Connection test skipped since no profile was found
[0m12:49:56.316837 [info ] [MainThread]: [31m2 checks failed:[0m
[0m12:49:56.316837 [info ] [MainThread]: dbt looked for a profiles.yml file in C:\Users\lyx\.dbt\profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m12:49:56.316837 [info ] [MainThread]: Project loading failed for the following reason:
 project path <D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\dbt_project.yml> not found

[0m12:49:56.316837 [debug] [MainThread]: Command `dbt debug` failed at 12:49:56.316837 after 0.16 seconds
[0m12:49:56.316837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD88F208D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD88F209D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD8F81E2D0>]}
[0m12:49:56.316837 [debug] [MainThread]: Flushing usage events
[0m12:49:56.754241 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:50:41.795576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E74C7A10D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E74C7A1090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E74FB8F8D0>]}


============================== 12:50:41.795576 | d5cfceb4-e347-4e4d-a2ca-bc3cb04ba577 ==============================
[0m12:50:41.795576 [info ] [MainThread]: Running with dbt=1.10.11
[0m12:50:41.795576 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'log_path': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\lyx\\.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m12:50:41.824248 [info ] [MainThread]: dbt version: 1.10.11
[0m12:50:41.824248 [info ] [MainThread]: python version: 3.11.1
[0m12:50:41.824248 [info ] [MainThread]: python path: C:\Users\lyx\AppData\Local\Programs\Python\Python311\python.exe
[0m12:50:41.824248 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m12:50:41.824248 [info ] [MainThread]: Using profiles dir at C:\Users\lyx\.dbt
[0m12:50:41.824248 [info ] [MainThread]: Using profiles.yml file at C:\Users\lyx\.dbt\profiles.yml
[0m12:50:41.824248 [info ] [MainThread]: Using dbt_project.yml file at D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\dbt_project.yml
[0m12:50:41.917764 [info ] [MainThread]: Configuration:
[0m12:50:41.917764 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m12:50:41.917764 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:50:41.917764 [info ] [MainThread]: Required dependencies:
[0m12:50:41.917764 [debug] [MainThread]: Executing "git --help"
[0m12:50:41.965758 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:50:41.967661 [debug] [MainThread]: STDERR: "b''"
[0m12:50:41.967661 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:50:41.967661 [info ] [MainThread]: Connection test skipped since no profile was found
[0m12:50:41.967661 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:50:41.970321 [info ] [MainThread]: dbt looked for a profiles.yml file in C:\Users\lyx\.dbt\profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m12:50:41.970321 [debug] [MainThread]: Command `dbt debug` failed at 12:50:41.970321 after 0.25 seconds
[0m12:50:41.970321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E74F8DE710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7491E0910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E74BD2F150>]}
[0m12:50:41.970321 [debug] [MainThread]: Flushing usage events
[0m12:50:42.355265 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:20:17.417350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001652384E590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001652384E710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016523AFB950>]}


============================== 13:20:17.417350 | b669bbc6-f85c-4a91-b199-74f1b17f65e7 ==============================
[0m13:20:17.417350 [info ] [MainThread]: Running with dbt=1.10.11
[0m13:20:17.417350 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\logs', 'profiles_dir': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m13:20:17.433392 [info ] [MainThread]: dbt version: 1.10.11
[0m13:20:17.433392 [info ] [MainThread]: python version: 3.11.1
[0m13:20:17.433392 [info ] [MainThread]: python path: D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\.venv\Scripts\python.exe
[0m13:20:17.433392 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m13:20:22.321594 [info ] [MainThread]: Using profiles dir at D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\dbt
[0m13:20:22.322525 [info ] [MainThread]: Using profiles.yml file at D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\dbt\profiles.yml
[0m13:20:22.324213 [info ] [MainThread]: Using dbt_project.yml file at D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\dbt_project.yml
[0m13:20:22.326231 [info ] [MainThread]: adapter type: bigquery
[0m13:20:22.329160 [info ] [MainThread]: adapter version: 1.10.2
[0m13:20:22.551362 [info ] [MainThread]: Configuration:
[0m13:20:22.553251 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:20:22.554252 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:20:22.554252 [info ] [MainThread]: Required dependencies:
[0m13:20:22.557145 [debug] [MainThread]: Executing "git --help"
[0m13:20:22.608707 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:20:22.608707 [debug] [MainThread]: STDERR: "b''"
[0m13:20:22.608707 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:20:22.608707 [info ] [MainThread]: Connection:
[0m13:20:22.608707 [info ] [MainThread]:   method: service-account
[0m13:20:22.608707 [info ] [MainThread]:   database: orbital-nuance-471817-n0
[0m13:20:22.608707 [info ] [MainThread]:   execution_project: orbital-nuance-471817-n0
[0m13:20:22.608707 [info ] [MainThread]:   schema: youtube_stg
[0m13:20:22.608707 [info ] [MainThread]:   location: US
[0m13:20:22.621089 [info ] [MainThread]:   priority: None
[0m13:20:22.621089 [info ] [MainThread]:   maximum_bytes_billed: None
[0m13:20:22.621089 [info ] [MainThread]:   impersonate_service_account: None
[0m13:20:22.621089 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m13:20:22.621089 [info ] [MainThread]:   job_retries: 1
[0m13:20:22.621089 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m13:20:22.621089 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m13:20:22.636772 [info ] [MainThread]:   timeout_seconds: None
[0m13:20:22.640331 [info ] [MainThread]:   client_id: None
[0m13:20:22.642334 [info ] [MainThread]:   token_uri: None
[0m13:20:22.645005 [info ] [MainThread]:   compute_region: None
[0m13:20:22.647142 [info ] [MainThread]:   dataproc_cluster_name: None
[0m13:20:22.650005 [info ] [MainThread]:   gcs_bucket: None
[0m13:20:22.652134 [info ] [MainThread]:   dataproc_batch: None
[0m13:20:22.655009 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m13:20:24.059858 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m13:20:24.059858 [debug] [MainThread]: On debug: select 1 as id
[0m13:20:24.059858 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:20:24.919316 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:a4c95fc0-0043-44b4-abe8-69fb51067163&page=queryresults
[0m13:20:29.954426 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:20:29.955876 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:20:29.958068 [debug] [MainThread]: Command `dbt debug` succeeded at 13:20:29.956960 after 12.64 seconds
[0m13:20:29.958068 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:20:29.959063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016523B23E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016523B23A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016550931750>]}
[0m13:20:29.959063 [debug] [MainThread]: Flushing usage events
[0m13:20:30.442677 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:21:38.092161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DCF55FD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DCF52BFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DCF4FDCD0>]}


============================== 13:21:38.099165 | cf902f82-64ad-433f-9276-9c13cc335082 ==============================
[0m13:21:38.099165 [info ] [MainThread]: Running with dbt=1.10.11
[0m13:21:38.100300 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'log_path': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m13:21:42.918867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf902f82-64ad-433f-9276-9c13cc335082', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DFC39EE90>]}
[0m13:21:43.089949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf902f82-64ad-433f-9276-9c13cc335082', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DCBEB7110>]}
[0m13:21:43.089949 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m13:21:44.637514 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m13:21:47.183270 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:21:47.183270 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:21:47.278764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf902f82-64ad-433f-9276-9c13cc335082', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DFC891C10>]}
[0m13:21:47.429286 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m13:21:47.432554 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m13:21:47.496785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf902f82-64ad-433f-9276-9c13cc335082', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DFC488A90>]}
[0m13:21:47.496785 [info ] [MainThread]: Found 5 models, 5 data tests, 495 macros
[0m13:21:47.496785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf902f82-64ad-433f-9276-9c13cc335082', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DFC81CF50>]}
[0m13:21:47.512522 [info ] [MainThread]: 
[0m13:21:47.515487 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m13:21:47.517101 [info ] [MainThread]: 
[0m13:21:47.517101 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:21:47.528956 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0'
[0m13:21:47.528956 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:47.528956 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0'
[0m13:21:47.597561 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:48.597364 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics'
[0m13:21:48.597364 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg'
[0m13:21:48.597364 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:48.606662 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:49.321313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf902f82-64ad-433f-9276-9c13cc335082', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DCECEC6D0>]}
[0m13:21:49.323240 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:21:49.355980 [debug] [Thread-1 (]: Began running node model.youtube_analytics.stg_youtube_channels
[0m13:21:49.355980 [debug] [Thread-2 (]: Began running node model.youtube_analytics.stg_youtube_video_ids
[0m13:21:49.355980 [debug] [Thread-3 (]: Began running node model.youtube_analytics.stg_youtube_video_stats
[0m13:21:49.355980 [info ] [Thread-1 (]: 1 of 5 START sql view model youtube_stg_youtube_stg.stg_youtube_channels ....... [RUN]
[0m13:21:49.355980 [info ] [Thread-2 (]: 2 of 5 START sql view model youtube_stg_youtube_stg.stg_youtube_video_ids ...... [RUN]
[0m13:21:49.355980 [info ] [Thread-3 (]: 3 of 5 START sql view model youtube_stg_youtube_stg.stg_youtube_video_stats .... [RUN]
[0m13:21:49.366371 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_channels'
[0m13:21:49.366371 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_video_ids'
[0m13:21:49.366371 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_video_stats'
[0m13:21:49.366371 [debug] [Thread-1 (]: Began compiling node model.youtube_analytics.stg_youtube_channels
[0m13:21:49.371992 [debug] [Thread-2 (]: Began compiling node model.youtube_analytics.stg_youtube_video_ids
[0m13:21:49.371992 [debug] [Thread-3 (]: Began compiling node model.youtube_analytics.stg_youtube_video_stats
[0m13:21:49.387799 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_channels"
[0m13:21:49.387799 [debug] [Thread-2 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_video_ids"
[0m13:21:49.387799 [debug] [Thread-3 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_video_stats"
[0m13:21:49.403725 [debug] [Thread-1 (]: Began executing node model.youtube_analytics.stg_youtube_channels
[0m13:21:49.403725 [debug] [Thread-2 (]: Began executing node model.youtube_analytics.stg_youtube_video_ids
[0m13:21:49.464227 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_channels"
[0m13:21:49.464994 [debug] [Thread-3 (]: Began executing node model.youtube_analytics.stg_youtube_video_stats
[0m13:21:49.469772 [debug] [Thread-2 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_video_ids"
[0m13:21:49.480343 [debug] [Thread-3 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_video_stats"
[0m13:21:49.480343 [debug] [Thread-1 (]: On model.youtube_analytics.stg_youtube_channels: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_channels"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_channels`
  OPTIONS()
  as with src as (
  select
    id                                        as channel_id,
    snippet.title                             as channel_title,
    snippet.country                           as channel_country,
    snippet.publishedAt                       as channel_published_at,
    cast(statistics.viewCount       as int64) as channel_view_count,
    cast(statistics.subscriberCount as int64) as channel_subscribers,
    cast(statistics.videoCount      as int64) as channel_video_count,
    date(_partitiontime)                      as load_date
  from `orbital-nuance-471817-n0.youtube_raw.channels_raw`
)
select * from src;


[0m13:21:49.480343 [debug] [Thread-2 (]: On model.youtube_analytics.stg_youtube_video_ids: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_video_ids"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_ids`
  OPTIONS()
  as select
  videoId              as video_id,
  channelId            as channel_id,
  date(_partitiontime) as load_date
from `orbital-nuance-471817-n0.youtube_raw.video_ids_raw`;


[0m13:21:49.480343 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:21:49.480343 [debug] [Thread-3 (]: On model.youtube_analytics.stg_youtube_video_stats: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_video_stats"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
  OPTIONS()
  as with src as (
  select
    id                                     as video_id,
    snippet.channelId                      as channel_id,
    snippet.title                          as video_title,
    snippet.publishedAt                    as video_published_at,
    cast(statistics.viewCount    as int64) as views,
    cast(statistics.likeCount    as int64) as likes,
    cast(statistics.commentCount as int64) as comments,
    contentDetails.duration                as duration_iso,
    current_date()                         as load_date
  from `orbital-nuance-471817-n0.youtube_raw.video_stats_raw`
),
parsed as (
  select
    *,
    (
      coalesce(SAFE_CAST(REGEXP_EXTRACT(duration_iso, r'(\d+)H') AS INT64), 0) * 3600
      + coalesce(SAFE_CAST(REGEXP_EXTRACT(duration_iso, r'(\d+)M') AS INT64), 0) * 60
      + coalesce(SAFE_CAST(REGEXP_EXTRACT(duration_iso, r'(\d+)S') AS INT64), 0)
    ) as duration_seconds
  from src
)
select * from parsed;


[0m13:21:49.480343 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:21:49.560122 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:21:50.543105 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:d359648b-082f-4c2f-b070-5a150f7d318a&page=queryresults
[0m13:21:50.544741 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:3ab79647-c1e0-4616-b705-d119c7d89427&page=queryresults
[0m13:21:50.548657 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:97d8b9c5-88df-4391-a5c4-943596136777&page=queryresults
[0m13:21:51.069343 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf902f82-64ad-433f-9276-9c13cc335082', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DFC886B10>]}
[0m13:21:51.071465 [info ] [Thread-2 (]: 2 of 5 OK created sql view model youtube_stg_youtube_stg.stg_youtube_video_ids . [[32mCREATE VIEW (0 processed)[0m in 1.70s]
[0m13:21:51.074482 [debug] [Thread-2 (]: Finished running node model.youtube_analytics.stg_youtube_video_ids
[0m13:21:51.138067 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf902f82-64ad-433f-9276-9c13cc335082', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DFCA66390>]}
[0m13:21:51.138067 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf902f82-64ad-433f-9276-9c13cc335082', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DFCA67450>]}
[0m13:21:51.138067 [info ] [Thread-1 (]: 1 of 5 OK created sql view model youtube_stg_youtube_stg.stg_youtube_channels .. [[32mCREATE VIEW (0 processed)[0m in 1.78s]
[0m13:21:51.138067 [debug] [Thread-1 (]: Finished running node model.youtube_analytics.stg_youtube_channels
[0m13:21:51.138067 [info ] [Thread-3 (]: 3 of 5 OK created sql view model youtube_stg_youtube_stg.stg_youtube_video_stats  [[32mCREATE VIEW (0 processed)[0m in 1.77s]
[0m13:21:51.138067 [debug] [Thread-3 (]: Finished running node model.youtube_analytics.stg_youtube_video_stats
[0m13:21:51.153718 [debug] [Thread-4 (]: Began running node model.youtube_analytics.fct_video_daily_metrics
[0m13:21:51.153718 [info ] [Thread-4 (]: 4 of 5 START sql table model youtube_stg_youtube_analytics.fct_video_daily_metrics  [RUN]
[0m13:21:51.153718 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.youtube_analytics.fct_video_daily_metrics'
[0m13:21:51.153718 [debug] [Thread-4 (]: Began compiling node model.youtube_analytics.fct_video_daily_metrics
[0m13:21:51.153718 [debug] [Thread-4 (]: Writing injected SQL for node "model.youtube_analytics.fct_video_daily_metrics"
[0m13:21:51.153718 [debug] [Thread-4 (]: Began executing node model.youtube_analytics.fct_video_daily_metrics
[0m13:21:51.183594 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:21:51.788268 [debug] [Thread-4 (]: Writing runtime sql for node "model.youtube_analytics.fct_video_daily_metrics"
[0m13:21:51.788268 [debug] [Thread-4 (]: On model.youtube_analytics.fct_video_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.fct_video_daily_metrics"} */

  
    

    create or replace table `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
      
    
    

    
    OPTIONS()
    as (
      with daily as (
  select
    video_id,
    channel_id,
    load_date,
    views,
    likes,
    comments
  from `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
),
with_lag as (
  select
    *,
    lag(views)    over (partition by video_id order by load_date) as prev_views,
    lag(likes)    over (partition by video_id order by load_date) as prev_likes,
    lag(comments) over (partition by video_id order by load_date) as prev_comments
  from daily
)
select
  video_id,
  channel_id,
  load_date,
  views,
  likes,
  comments,
  views    - coalesce(prev_views, 0)    as daily_views,
  likes    - coalesce(prev_likes, 0)    as daily_likes,
  comments - coalesce(prev_comments, 0) as daily_comments
from with_lag
    );
  
[0m13:21:52.582726 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:bc0c1740-b4ce-4b84-90ea-ccadfb9d52dc&page=queryresults
[0m13:21:55.256744 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf902f82-64ad-433f-9276-9c13cc335082', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DFCB51650>]}
[0m13:21:55.256744 [info ] [Thread-4 (]: 4 of 5 OK created sql table model youtube_stg_youtube_analytics.fct_video_daily_metrics  [[32mCREATE TABLE (20.0 rows, 1.2 KiB processed)[0m in 4.10s]
[0m13:21:55.256744 [debug] [Thread-4 (]: Finished running node model.youtube_analytics.fct_video_daily_metrics
[0m13:21:55.256744 [debug] [Thread-1 (]: Began running node model.youtube_analytics.agg_channel_trends_7d
[0m13:21:55.256744 [info ] [Thread-1 (]: 5 of 5 START sql table model youtube_stg_youtube_analytics.agg_channel_trends_7d  [RUN]
[0m13:21:55.262273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.youtube_analytics.stg_youtube_channels, now model.youtube_analytics.agg_channel_trends_7d)
[0m13:21:55.262273 [debug] [Thread-1 (]: Began compiling node model.youtube_analytics.agg_channel_trends_7d
[0m13:21:55.262273 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_analytics.agg_channel_trends_7d"
[0m13:21:55.262273 [debug] [Thread-1 (]: Began executing node model.youtube_analytics.agg_channel_trends_7d
[0m13:21:55.281887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:55.872568 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_analytics.agg_channel_trends_7d"
[0m13:21:55.873569 [debug] [Thread-1 (]: On model.youtube_analytics.agg_channel_trends_7d: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.agg_channel_trends_7d"} */

  
    

    create or replace table `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`agg_channel_trends_7d`
      
    
    

    
    OPTIONS()
    as (
      with daily as (
  select
    channel_id,
    video_id,
    load_date,
    daily_views,
    daily_likes,
    daily_comments
  from `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
),
rollup_cte as (
  select
    channel_id,
    load_date,
    sum(daily_views)    over (
      partition by channel_id
      order by load_date
      rows between 6 preceding and current row
    ) as views_7d,
    sum(daily_likes)    over (
      partition by channel_id
      order by load_date
      rows between 6 preceding and current row
    ) as likes_7d,
    sum(daily_comments) over (
      partition by channel_id
      order by load_date
      rows between 6 preceding and current row
    ) as comments_7d
  from daily
)
select distinct channel_id, load_date, views_7d, likes_7d, comments_7d
from rollup_cte
    );
  
[0m13:21:56.481437 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:11e2a9e2-0a54-4d44-9e2a-ffac5770369c&page=queryresults
[0m13:21:59.044829 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf902f82-64ad-433f-9276-9c13cc335082', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DFCA66050>]}
[0m13:21:59.046187 [info ] [Thread-1 (]: 5 of 5 OK created sql table model youtube_stg_youtube_analytics.agg_channel_trends_7d  [[32mCREATE TABLE (20.0 rows, 1.1 KiB processed)[0m in 3.78s]
[0m13:21:59.047095 [debug] [Thread-1 (]: Finished running node model.youtube_analytics.agg_channel_trends_7d
[0m13:21:59.049558 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:21:59.054758 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:21:59.055922 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0' was properly closed.
[0m13:21:59.057117 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0' was properly closed.
[0m13:21:59.058081 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics' was properly closed.
[0m13:21:59.058081 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg' was properly closed.
[0m13:21:59.058081 [debug] [MainThread]: Connection 'model.youtube_analytics.agg_channel_trends_7d' was properly closed.
[0m13:21:59.058081 [debug] [MainThread]: Connection 'model.youtube_analytics.stg_youtube_video_ids' was properly closed.
[0m13:21:59.058081 [debug] [MainThread]: Connection 'model.youtube_analytics.stg_youtube_video_stats' was properly closed.
[0m13:21:59.058081 [debug] [MainThread]: Connection 'model.youtube_analytics.fct_video_daily_metrics' was properly closed.
[0m13:21:59.058081 [info ] [MainThread]: 
[0m13:21:59.058081 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 11.54 seconds (11.54s).
[0m13:21:59.058081 [debug] [MainThread]: Command end result
[0m13:21:59.136324 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m13:21:59.136324 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m13:21:59.154630 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\run_results.json
[0m13:21:59.155580 [info ] [MainThread]: 
[0m13:21:59.157639 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:21:59.158806 [info ] [MainThread]: 
[0m13:21:59.160884 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m13:21:59.163991 [debug] [MainThread]: Command `dbt run` succeeded at 13:21:59.162993 after 21.14 seconds
[0m13:21:59.164978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DCF567810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DCF564950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DCF2AED50>]}
[0m13:21:59.165975 [debug] [MainThread]: Flushing usage events
[0m13:21:59.715780 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:22:08.411139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE14ABB0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE14B23ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE14B23E90>]}


============================== 13:22:08.411139 | 5deb8d57-d14b-4c07-9ba8-68d757a6bd31 ==============================
[0m13:22:08.411139 [info ] [MainThread]: Running with dbt=1.10.11
[0m13:22:08.411139 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'None', 'log_cache_events': 'False', 'quiet': 'False', 'log_path': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m13:22:13.200126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5deb8d57-d14b-4c07-9ba8-68d757a6bd31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE13B7C950>]}
[0m13:22:13.365635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5deb8d57-d14b-4c07-9ba8-68d757a6bd31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE11475F10>]}
[0m13:22:13.367640 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m13:22:14.965362 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m13:22:15.262818 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:22:15.262818 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:22:15.349630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5deb8d57-d14b-4c07-9ba8-68d757a6bd31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE41E5C950>]}
[0m13:22:15.496989 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m13:22:15.496989 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m13:22:15.594145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5deb8d57-d14b-4c07-9ba8-68d757a6bd31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE4214E650>]}
[0m13:22:15.597209 [info ] [MainThread]: Found 5 models, 5 data tests, 495 macros
[0m13:22:15.597209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5deb8d57-d14b-4c07-9ba8-68d757a6bd31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE41DD5690>]}
[0m13:22:15.597209 [info ] [MainThread]: 
[0m13:22:15.597209 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m13:22:15.597209 [info ] [MainThread]: 
[0m13:22:15.607075 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:22:15.619302 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg'
[0m13:22:15.619302 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:22:15.622993 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics'
[0m13:22:15.683009 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:22:16.355136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5deb8d57-d14b-4c07-9ba8-68d757a6bd31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE41E5C6D0>]}
[0m13:22:16.355136 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:22:16.370832 [debug] [Thread-1 (]: Began running node test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267
[0m13:22:16.370832 [debug] [Thread-2 (]: Began running node test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1
[0m13:22:16.370832 [debug] [Thread-3 (]: Began running node test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7
[0m13:22:16.370832 [debug] [Thread-4 (]: Began running node test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602
[0m13:22:16.370832 [info ] [Thread-1 (]: 1 of 5 START test not_null_fct_video_daily_metrics_load_date ................... [RUN]
[0m13:22:16.370832 [info ] [Thread-2 (]: 2 of 5 START test not_null_fct_video_daily_metrics_video_id .................... [RUN]
[0m13:22:16.370832 [info ] [Thread-3 (]: 3 of 5 START test not_null_stg_youtube_video_stats_load_date ................... [RUN]
[0m13:22:16.384201 [info ] [Thread-4 (]: 4 of 5 START test not_null_stg_youtube_video_stats_video_id .................... [RUN]
[0m13:22:16.384201 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267'
[0m13:22:16.386900 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1'
[0m13:22:16.386900 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7'
[0m13:22:16.386900 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602'
[0m13:22:16.386900 [debug] [Thread-1 (]: Began compiling node test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267
[0m13:22:16.386900 [debug] [Thread-2 (]: Began compiling node test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1
[0m13:22:16.386900 [debug] [Thread-3 (]: Began compiling node test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7
[0m13:22:16.386900 [debug] [Thread-4 (]: Began compiling node test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602
[0m13:22:16.435120 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267"
[0m13:22:16.446257 [debug] [Thread-2 (]: Writing injected SQL for node "test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1"
[0m13:22:16.449228 [debug] [Thread-3 (]: Writing injected SQL for node "test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7"
[0m13:22:16.457531 [debug] [Thread-4 (]: Writing injected SQL for node "test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602"
[0m13:22:16.465173 [debug] [Thread-1 (]: Began executing node test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267
[0m13:22:16.468050 [debug] [Thread-2 (]: Began executing node test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1
[0m13:22:16.468050 [debug] [Thread-3 (]: Began executing node test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7
[0m13:22:16.481402 [debug] [Thread-4 (]: Began executing node test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602
[0m13:22:16.512581 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267"
[0m13:22:16.512581 [debug] [Thread-2 (]: Writing runtime sql for node "test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1"
[0m13:22:16.512581 [debug] [Thread-3 (]: Writing runtime sql for node "test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7"
[0m13:22:16.530197 [debug] [Thread-4 (]: Writing runtime sql for node "test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602"
[0m13:22:16.530197 [debug] [Thread-1 (]: On test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select load_date
from `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
where load_date is null



  
  
      
    ) dbt_internal_test
[0m13:22:16.530197 [debug] [Thread-2 (]: On test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select video_id
from `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
where video_id is null



  
  
      
    ) dbt_internal_test
[0m13:22:16.530197 [debug] [Thread-3 (]: On test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select load_date
from `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
where load_date is null



  
  
      
    ) dbt_internal_test
[0m13:22:16.530197 [debug] [Thread-4 (]: On test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select video_id
from `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
where video_id is null



  
  
      
    ) dbt_internal_test
[0m13:22:16.530197 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:22:16.530197 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:22:16.530197 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:22:16.545399 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:22:17.645825 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:5001c2dc-2828-469a-8ff3-af45e2ac1f0b&page=queryresults
[0m13:22:17.646833 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:e8553ea1-a1b1-4b64-a7e1-bf7721dcc802&page=queryresults
[0m13:22:17.888168 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:f756660d-2634-4492-88d0-67b2385b2e95&page=queryresults
[0m13:22:17.965843 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:b682fe62-a28f-44d1-b2f2-7b73fc08ccf4&page=queryresults
[0m13:22:18.481423 [info ] [Thread-3 (]: 3 of 5 PASS not_null_stg_youtube_video_stats_load_date ......................... [[32mPASS[0m in 2.09s]
[0m13:22:18.481423 [debug] [Thread-3 (]: Finished running node test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7
[0m13:22:18.481423 [debug] [Thread-3 (]: Began running node test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e
[0m13:22:18.481423 [info ] [Thread-3 (]: 5 of 5 START test unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_  [RUN]
[0m13:22:18.481423 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7, now test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e)
[0m13:22:18.493948 [debug] [Thread-3 (]: Began compiling node test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e
[0m13:22:18.500132 [debug] [Thread-3 (]: Writing injected SQL for node "test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e"
[0m13:22:18.501072 [debug] [Thread-3 (]: Began executing node test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e
[0m13:22:18.503131 [debug] [Thread-3 (]: Writing runtime sql for node "test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e"
[0m13:22:18.503131 [debug] [Thread-3 (]: On test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select video_id || '-' || cast(load_date as string) as unique_field
  from `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
  where video_id || '-' || cast(load_date as string) is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:22:18.504490 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:22:18.582531 [info ] [Thread-1 (]: 1 of 5 PASS not_null_fct_video_daily_metrics_load_date ......................... [[32mPASS[0m in 2.20s]
[0m13:22:18.582531 [debug] [Thread-1 (]: Finished running node test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267
[0m13:22:18.652173 [info ] [Thread-2 (]: 2 of 5 PASS not_null_fct_video_daily_metrics_video_id .......................... [[32mPASS[0m in 2.27s]
[0m13:22:18.652173 [debug] [Thread-2 (]: Finished running node test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1
[0m13:22:18.755861 [info ] [Thread-4 (]: 4 of 5 PASS not_null_stg_youtube_video_stats_video_id .......................... [[32mPASS[0m in 2.37s]
[0m13:22:18.755861 [debug] [Thread-4 (]: Finished running node test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602
[0m13:22:19.625347 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:16aac89f-a66b-4630-96cf-f0d9ca8d219c&page=queryresults
[0m13:22:20.548937 [info ] [Thread-3 (]: 5 of 5 PASS unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_ .. [[32mPASS[0m in 2.07s]
[0m13:22:20.550944 [debug] [Thread-3 (]: Finished running node test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e
[0m13:22:20.550944 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:22:20.556009 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:22:20.560480 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg' was properly closed.
[0m13:22:20.560480 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics' was properly closed.
[0m13:22:20.560480 [debug] [MainThread]: Connection 'test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267' was properly closed.
[0m13:22:20.560480 [debug] [MainThread]: Connection 'test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1' was properly closed.
[0m13:22:20.560480 [debug] [MainThread]: Connection 'test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e' was properly closed.
[0m13:22:20.560480 [debug] [MainThread]: Connection 'test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602' was properly closed.
[0m13:22:20.560480 [info ] [MainThread]: 
[0m13:22:20.560480 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 4.95 seconds (4.95s).
[0m13:22:20.573353 [debug] [MainThread]: Command end result
[0m13:22:20.632702 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m13:22:20.636716 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m13:22:20.652732 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\run_results.json
[0m13:22:20.652732 [info ] [MainThread]: 
[0m13:22:20.652732 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:22:20.652732 [info ] [MainThread]: 
[0m13:22:20.652732 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m13:22:20.652732 [debug] [MainThread]: Command `dbt test` succeeded at 13:22:20.652732 after 12.32 seconds
[0m13:22:20.668964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE14AF4A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE14AF44D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE1486ED50>]}
[0m13:22:20.668964 [debug] [MainThread]: Flushing usage events
[0m13:22:21.042581 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:27:49.854971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001564058F390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001564058F190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001564052F650>]}


============================== 13:27:49.854971 | 11a477d1-5eb0-42f3-a9e1-4496987b9761 ==============================
[0m13:27:49.854971 [info ] [MainThread]: Running with dbt=1.10.11
[0m13:27:49.854971 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select marts', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'log_cache_events': 'False', 'log_path': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m13:27:55.102426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11a477d1-5eb0-42f3-a9e1-4496987b9761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001563F5FCB10>]}
[0m13:27:55.231084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11a477d1-5eb0-42f3-a9e1-4496987b9761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001563CEF77D0>]}
[0m13:27:55.231084 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m13:27:56.794108 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m13:27:57.121822 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m13:27:57.121822 [debug] [MainThread]: Partial parsing: added file: youtube_analytics://dbt/models\marts\dim_channel.sql
[0m13:27:57.125989 [debug] [MainThread]: Partial parsing: added file: youtube_analytics://dbt/models\marts\video_latest_snapshot.sql
[0m13:27:57.696849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11a477d1-5eb0-42f3-a9e1-4496987b9761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001566D398310>]}
[0m13:27:57.881993 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m13:27:57.889429 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m13:27:57.957011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11a477d1-5eb0-42f3-a9e1-4496987b9761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001566DC22A50>]}
[0m13:27:57.957011 [info ] [MainThread]: Found 7 models, 5 data tests, 495 macros
[0m13:27:57.959023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11a477d1-5eb0-42f3-a9e1-4496987b9761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001566DABE890>]}
[0m13:27:57.963096 [info ] [MainThread]: 
[0m13:27:57.963096 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m13:27:57.966292 [info ] [MainThread]: 
[0m13:27:57.966292 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:27:57.982088 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0'
[0m13:27:57.990249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:58.781149 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics'
[0m13:27:58.784716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:58.784716 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg'
[0m13:27:58.872171 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:59.498115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11a477d1-5eb0-42f3-a9e1-4496987b9761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001566D3A3690>]}
[0m13:27:59.499855 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:27:59.512121 [debug] [Thread-2 (]: Began running node model.youtube_analytics.fct_video_daily_metrics
[0m13:27:59.505670 [debug] [Thread-1 (]: Began running node model.youtube_analytics.dim_channel
[0m13:27:59.512121 [debug] [Thread-3 (]: Began running node model.youtube_analytics.video_latest_snapshot
[0m13:27:59.515299 [info ] [Thread-2 (]: 2 of 4 START sql table model youtube_stg_youtube_analytics.fct_video_daily_metrics  [RUN]
[0m13:27:59.516804 [info ] [Thread-1 (]: 1 of 4 START sql table model youtube_stg_youtube_analytics.dim_channel ......... [RUN]
[0m13:27:59.516804 [info ] [Thread-3 (]: 3 of 4 START sql table model youtube_stg_youtube_analytics.video_latest_snapshot  [RUN]
[0m13:27:59.519593 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.youtube_analytics.fct_video_daily_metrics'
[0m13:27:59.520581 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.youtube_analytics.dim_channel'
[0m13:27:59.520581 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.youtube_analytics.video_latest_snapshot'
[0m13:27:59.524176 [debug] [Thread-2 (]: Began compiling node model.youtube_analytics.fct_video_daily_metrics
[0m13:27:59.524176 [debug] [Thread-1 (]: Began compiling node model.youtube_analytics.dim_channel
[0m13:27:59.527914 [debug] [Thread-3 (]: Began compiling node model.youtube_analytics.video_latest_snapshot
[0m13:27:59.544696 [debug] [Thread-2 (]: Writing injected SQL for node "model.youtube_analytics.fct_video_daily_metrics"
[0m13:27:59.551803 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_analytics.dim_channel"
[0m13:27:59.556626 [debug] [Thread-3 (]: Writing injected SQL for node "model.youtube_analytics.video_latest_snapshot"
[0m13:27:59.559653 [debug] [Thread-1 (]: Began executing node model.youtube_analytics.dim_channel
[0m13:27:59.562030 [debug] [Thread-2 (]: Began executing node model.youtube_analytics.fct_video_daily_metrics
[0m13:27:59.605554 [debug] [Thread-3 (]: Began executing node model.youtube_analytics.video_latest_snapshot
[0m13:27:59.637891 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:27:59.654097 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_analytics.dim_channel"
[0m13:27:59.661301 [debug] [Thread-3 (]: Writing runtime sql for node "model.youtube_analytics.video_latest_snapshot"
[0m13:27:59.730636 [debug] [Thread-1 (]: On model.youtube_analytics.dim_channel: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.dim_channel"} */

  
    

    create or replace table `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`dim_channel`
      
    
    

    
    OPTIONS()
    as (
      with ranked as (
  select
    channel_id,
    channel_title,
    channel_country,
    channel_published_at,
    channel_view_count,
    channel_subscribers,
    channel_video_count,
    load_date,
    row_number() over (partition by channel_id order by load_date desc) as rn
  from `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_channels`
)
select
  channel_id,
  channel_title,
  channel_country,
  channel_published_at,
  channel_view_count,
  channel_subscribers,
  channel_video_count,
  load_date as snapshot_date
from ranked
where rn = 1
    );
  
[0m13:27:59.730636 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:27:59.746439 [debug] [Thread-3 (]: On model.youtube_analytics.video_latest_snapshot: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.video_latest_snapshot"} */

  
    

    create or replace table `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`video_latest_snapshot`
      
    
    

    
    OPTIONS()
    as (
      with ranked as (
  select
    s.video_id,
    s.channel_id,
    s.video_title,
    s.video_published_at,
    s.views,
    s.likes,
    s.comments,
    s.duration_seconds,
    s.load_date,
    row_number() over (partition by s.video_id order by s.load_date desc) as rn
  from `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats` s
)
select
  r.video_id,
  r.channel_id,
  r.video_title,
  r.video_published_at,
  r.views,
  r.likes,
  r.comments,
  r.duration_seconds,
  r.load_date as snapshot_date
from ranked r
where rn = 1
    );
  
[0m13:27:59.825180 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:28:00.409665 [debug] [Thread-2 (]: Writing runtime sql for node "model.youtube_analytics.fct_video_daily_metrics"
[0m13:28:00.411673 [debug] [Thread-2 (]: On model.youtube_analytics.fct_video_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.fct_video_daily_metrics"} */

  
    

    create or replace table `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
      
    
    

    
    OPTIONS()
    as (
      with daily as (
  select
    video_id,
    channel_id,
    load_date,
    views,
    likes,
    comments
  from `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
),
with_lag as (
  select
    *,
    lag(views)    over (partition by video_id order by load_date) as prev_views,
    lag(likes)    over (partition by video_id order by load_date) as prev_likes,
    lag(comments) over (partition by video_id order by load_date) as prev_comments
  from daily
)
select
  video_id,
  channel_id,
  load_date,
  views,
  likes,
  comments,
  views    - coalesce(prev_views, 0)    as daily_views,
  likes    - coalesce(prev_likes, 0)    as daily_likes,
  comments - coalesce(prev_comments, 0) as daily_comments
from with_lag
    );
  
[0m13:28:00.831640 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:13ef2244-dd72-4f57-ae3b-04d31100f755&page=queryresults
[0m13:28:00.845106 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:3749ca96-ddd0-4887-96fe-663ec3df74a1&page=queryresults
[0m13:28:01.132234 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:8287ae3e-83ad-4bc5-bd45-cfa1810d66f7&page=queryresults
[0m13:28:03.001234 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11a477d1-5eb0-42f3-a9e1-4496987b9761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001566DADD190>]}
[0m13:28:03.001234 [info ] [Thread-1 (]: 1 of 4 OK created sql table model youtube_stg_youtube_analytics.dim_channel .... [[32mCREATE TABLE (2.0 rows, 142.0 Bytes processed)[0m in 3.48s]
[0m13:28:03.001234 [debug] [Thread-1 (]: Finished running node model.youtube_analytics.dim_channel
[0m13:28:03.025413 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11a477d1-5eb0-42f3-a9e1-4496987b9761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001566DCA1350>]}
[0m13:28:03.025413 [info ] [Thread-3 (]: 3 of 4 OK created sql table model youtube_stg_youtube_analytics.video_latest_snapshot  [[32mCREATE TABLE (20.0 rows, 2.4 KiB processed)[0m in 3.50s]
[0m13:28:03.027426 [debug] [Thread-3 (]: Finished running node model.youtube_analytics.video_latest_snapshot
[0m13:28:03.104612 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11a477d1-5eb0-42f3-a9e1-4496987b9761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001566DCFB210>]}
[0m13:28:03.104612 [info ] [Thread-2 (]: 2 of 4 OK created sql table model youtube_stg_youtube_analytics.fct_video_daily_metrics  [[32mCREATE TABLE (20.0 rows, 1.2 KiB processed)[0m in 3.59s]
[0m13:28:03.104612 [debug] [Thread-2 (]: Finished running node model.youtube_analytics.fct_video_daily_metrics
[0m13:28:03.104612 [debug] [Thread-4 (]: Began running node model.youtube_analytics.agg_channel_trends_7d
[0m13:28:03.104612 [info ] [Thread-4 (]: 4 of 4 START sql table model youtube_stg_youtube_analytics.agg_channel_trends_7d  [RUN]
[0m13:28:03.116416 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.youtube_analytics.agg_channel_trends_7d'
[0m13:28:03.116416 [debug] [Thread-4 (]: Began compiling node model.youtube_analytics.agg_channel_trends_7d
[0m13:28:03.124602 [debug] [Thread-4 (]: Writing injected SQL for node "model.youtube_analytics.agg_channel_trends_7d"
[0m13:28:03.126640 [debug] [Thread-4 (]: Began executing node model.youtube_analytics.agg_channel_trends_7d
[0m13:28:03.130667 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:28:03.687544 [debug] [Thread-4 (]: Writing runtime sql for node "model.youtube_analytics.agg_channel_trends_7d"
[0m13:28:03.689558 [debug] [Thread-4 (]: On model.youtube_analytics.agg_channel_trends_7d: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.agg_channel_trends_7d"} */

  
    

    create or replace table `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`agg_channel_trends_7d`
      
    
    

    
    OPTIONS()
    as (
      with daily as (
  select
    channel_id,
    video_id,
    load_date,
    daily_views,
    daily_likes,
    daily_comments
  from `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
),
rollup_cte as (
  select
    channel_id,
    load_date,
    sum(daily_views)    over (
      partition by channel_id
      order by load_date
      rows between 6 preceding and current row
    ) as views_7d,
    sum(daily_likes)    over (
      partition by channel_id
      order by load_date
      rows between 6 preceding and current row
    ) as likes_7d,
    sum(daily_comments) over (
      partition by channel_id
      order by load_date
      rows between 6 preceding and current row
    ) as comments_7d
  from daily
)
select distinct channel_id, load_date, views_7d, likes_7d, comments_7d
from rollup_cte
    );
  
[0m13:28:04.157838 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:f29f3998-6c0a-48d5-95d2-543af42655c1&page=queryresults
[0m13:28:06.558354 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11a477d1-5eb0-42f3-a9e1-4496987b9761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001566E0AA890>]}
[0m13:28:06.558354 [info ] [Thread-4 (]: 4 of 4 OK created sql table model youtube_stg_youtube_analytics.agg_channel_trends_7d  [[32mCREATE TABLE (20.0 rows, 1.1 KiB processed)[0m in 3.44s]
[0m13:28:06.560361 [debug] [Thread-4 (]: Finished running node model.youtube_analytics.agg_channel_trends_7d
[0m13:28:06.560361 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:28:06.568611 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:28:06.568611 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0' was properly closed.
[0m13:28:06.571010 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics' was properly closed.
[0m13:28:06.571010 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg' was properly closed.
[0m13:28:06.573053 [debug] [MainThread]: Connection 'model.youtube_analytics.fct_video_daily_metrics' was properly closed.
[0m13:28:06.574067 [debug] [MainThread]: Connection 'model.youtube_analytics.dim_channel' was properly closed.
[0m13:28:06.574067 [debug] [MainThread]: Connection 'model.youtube_analytics.video_latest_snapshot' was properly closed.
[0m13:28:06.577276 [debug] [MainThread]: Connection 'model.youtube_analytics.agg_channel_trends_7d' was properly closed.
[0m13:28:06.577276 [info ] [MainThread]: 
[0m13:28:06.577276 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 8.61 seconds (8.61s).
[0m13:28:06.577276 [debug] [MainThread]: Command end result
[0m13:28:06.641183 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m13:28:06.641183 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m13:28:06.653364 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\run_results.json
[0m13:28:06.653364 [info ] [MainThread]: 
[0m13:28:06.653364 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:28:06.664805 [info ] [MainThread]: 
[0m13:28:06.664805 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m13:28:06.669309 [debug] [MainThread]: Command `dbt run` succeeded at 13:28:06.669309 after 16.88 seconds
[0m13:28:06.671047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156405B6410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156405B6310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015639AA10D0>]}
[0m13:28:06.672753 [debug] [MainThread]: Flushing usage events
[0m13:28:07.262515 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:29:06.669685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABFCCE710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABFF1B990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABFF717D0>]}


============================== 13:29:06.669685 | 9a5b5568-65e9-4cbb-ba6f-81aae034848e ==============================
[0m13:29:06.669685 [info ] [MainThread]: Running with dbt=1.10.11
[0m13:29:06.669685 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'empty': 'None', 'indirect_selection': 'eager', 'log_path': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\logs', 'profiles_dir': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m13:29:11.187530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a5b5568-65e9-4cbb-ba6f-81aae034848e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABCB75090>]}
[0m13:29:11.371118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a5b5568-65e9-4cbb-ba6f-81aae034848e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABC8E7C90>]}
[0m13:29:11.372543 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m13:29:12.880712 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m13:29:13.278714 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:29:13.278714 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:29:13.341273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a5b5568-65e9-4cbb-ba6f-81aae034848e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAED381CD0>]}
[0m13:29:13.511914 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m13:29:13.511914 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m13:29:13.632779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a5b5568-65e9-4cbb-ba6f-81aae034848e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAED5B1E10>]}
[0m13:29:13.638105 [info ] [MainThread]: Found 7 models, 5 data tests, 495 macros
[0m13:29:13.638105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a5b5568-65e9-4cbb-ba6f-81aae034848e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAED29FBD0>]}
[0m13:29:13.641344 [info ] [MainThread]: 
[0m13:29:13.643360 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m13:29:13.643360 [info ] [MainThread]: 
[0m13:29:13.646860 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:29:13.656070 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics'
[0m13:29:13.656070 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:29:13.656070 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg'
[0m13:29:13.732621 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:29:14.254503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a5b5568-65e9-4cbb-ba6f-81aae034848e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABF718750>]}
[0m13:29:14.254503 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:29:14.264062 [debug] [Thread-1 (]: Began running node test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267
[0m13:29:14.264062 [debug] [Thread-2 (]: Began running node test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1
[0m13:29:14.264062 [debug] [Thread-3 (]: Began running node test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7
[0m13:29:14.264062 [debug] [Thread-4 (]: Began running node test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602
[0m13:29:14.264062 [info ] [Thread-1 (]: 1 of 5 START test not_null_fct_video_daily_metrics_load_date ................... [RUN]
[0m13:29:14.275089 [info ] [Thread-2 (]: 2 of 5 START test not_null_fct_video_daily_metrics_video_id .................... [RUN]
[0m13:29:14.275089 [info ] [Thread-3 (]: 3 of 5 START test not_null_stg_youtube_video_stats_load_date ................... [RUN]
[0m13:29:14.278015 [info ] [Thread-4 (]: 4 of 5 START test not_null_stg_youtube_video_stats_video_id .................... [RUN]
[0m13:29:14.280862 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267'
[0m13:29:14.280862 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1'
[0m13:29:14.283836 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7'
[0m13:29:14.285843 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602'
[0m13:29:14.287850 [debug] [Thread-1 (]: Began compiling node test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267
[0m13:29:14.287850 [debug] [Thread-2 (]: Began compiling node test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1
[0m13:29:14.289858 [debug] [Thread-3 (]: Began compiling node test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7
[0m13:29:14.291862 [debug] [Thread-4 (]: Began compiling node test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602
[0m13:29:14.324739 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267"
[0m13:29:14.343793 [debug] [Thread-2 (]: Writing injected SQL for node "test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1"
[0m13:29:14.351693 [debug] [Thread-3 (]: Writing injected SQL for node "test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7"
[0m13:29:14.358481 [debug] [Thread-4 (]: Writing injected SQL for node "test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602"
[0m13:29:14.358481 [debug] [Thread-1 (]: Began executing node test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267
[0m13:29:14.358481 [debug] [Thread-2 (]: Began executing node test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1
[0m13:29:14.358481 [debug] [Thread-3 (]: Began executing node test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7
[0m13:29:14.410314 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267"
[0m13:29:14.410314 [debug] [Thread-4 (]: Began executing node test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602
[0m13:29:14.420366 [debug] [Thread-2 (]: Writing runtime sql for node "test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1"
[0m13:29:14.431527 [debug] [Thread-3 (]: Writing runtime sql for node "test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7"
[0m13:29:14.431527 [debug] [Thread-1 (]: On test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select load_date
from `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
where load_date is null



  
  
      
    ) dbt_internal_test
[0m13:29:14.437799 [debug] [Thread-4 (]: Writing runtime sql for node "test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602"
[0m13:29:14.437799 [debug] [Thread-2 (]: On test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select video_id
from `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
where video_id is null



  
  
      
    ) dbt_internal_test
[0m13:29:14.445501 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:29:14.445501 [debug] [Thread-3 (]: On test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select load_date
from `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
where load_date is null



  
  
      
    ) dbt_internal_test
[0m13:29:14.452245 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:29:14.445501 [debug] [Thread-4 (]: On test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select video_id
from `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
where video_id is null



  
  
      
    ) dbt_internal_test
[0m13:29:14.512448 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:29:14.590606 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:29:15.465026 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:d3ee6dca-14c5-487d-8c22-b0c21b9127e6&page=queryresults
[0m13:29:15.465026 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:856bc682-4202-4757-8fa6-d025e00ad45c&page=queryresults
[0m13:29:15.681723 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:c1415d81-76e4-4aae-bd13-5d216f554672&page=queryresults
[0m13:29:15.695635 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:5b4bdece-65d9-4c9d-8f27-13cc4a06b9b8&page=queryresults
[0m13:29:16.122140 [info ] [Thread-1 (]: 1 of 5 PASS not_null_fct_video_daily_metrics_load_date ......................... [[32mPASS[0m in 1.84s]
[0m13:29:16.122140 [debug] [Thread-1 (]: Finished running node test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267
[0m13:29:16.122140 [debug] [Thread-1 (]: Began running node test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e
[0m13:29:16.122140 [info ] [Thread-1 (]: 5 of 5 START test unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_  [RUN]
[0m13:29:16.122140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267, now test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e)
[0m13:29:16.122140 [debug] [Thread-1 (]: Began compiling node test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e
[0m13:29:16.138012 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e"
[0m13:29:16.138012 [debug] [Thread-1 (]: Began executing node test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e
[0m13:29:16.138012 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e"
[0m13:29:16.138012 [debug] [Thread-1 (]: On test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select video_id || '-' || cast(load_date as string) as unique_field
  from `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
  where video_id || '-' || cast(load_date as string) is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:29:16.138012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:29:16.208284 [info ] [Thread-2 (]: 2 of 5 PASS not_null_fct_video_daily_metrics_video_id .......................... [[32mPASS[0m in 1.93s]
[0m13:29:16.210873 [debug] [Thread-2 (]: Finished running node test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1
[0m13:29:16.297858 [info ] [Thread-4 (]: 4 of 5 PASS not_null_stg_youtube_video_stats_video_id .......................... [[32mPASS[0m in 2.01s]
[0m13:29:16.300925 [info ] [Thread-3 (]: 3 of 5 PASS not_null_stg_youtube_video_stats_load_date ......................... [[32mPASS[0m in 2.02s]
[0m13:29:16.301818 [debug] [Thread-4 (]: Finished running node test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602
[0m13:29:16.301818 [debug] [Thread-3 (]: Finished running node test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7
[0m13:29:17.105780 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:c866081a-d1f2-49f4-85fc-d9deeb17ec90&page=queryresults
[0m13:29:17.849410 [info ] [Thread-1 (]: 5 of 5 PASS unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_ .. [[32mPASS[0m in 1.73s]
[0m13:29:17.850532 [debug] [Thread-1 (]: Finished running node test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e
[0m13:29:17.855183 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:29:17.859178 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:29:17.859178 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics' was properly closed.
[0m13:29:17.859178 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg' was properly closed.
[0m13:29:17.859178 [debug] [MainThread]: Connection 'test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e' was properly closed.
[0m13:29:17.859178 [debug] [MainThread]: Connection 'test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1' was properly closed.
[0m13:29:17.859178 [debug] [MainThread]: Connection 'test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7' was properly closed.
[0m13:29:17.866861 [debug] [MainThread]: Connection 'test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602' was properly closed.
[0m13:29:17.866861 [info ] [MainThread]: 
[0m13:29:17.866861 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 4.22 seconds (4.22s).
[0m13:29:17.872001 [debug] [MainThread]: Command end result
[0m13:29:17.939252 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m13:29:17.945259 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m13:29:17.963506 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\run_results.json
[0m13:29:17.964942 [info ] [MainThread]: 
[0m13:29:17.966956 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:29:17.966956 [info ] [MainThread]: 
[0m13:29:17.970202 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m13:29:17.975079 [debug] [MainThread]: Command `dbt test` succeeded at 13:29:17.975079 after 11.36 seconds
[0m13:29:17.977096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABFFA9B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABFFABE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAB931BCD0>]}
[0m13:29:17.977096 [debug] [MainThread]: Flushing usage events
[0m13:29:18.434001 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:17:24.809076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAFB62F750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAFB565410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAFB67DE10>]}


============================== 15:17:24.813398 | 96a34773-ff66-4fd0-a2ea-8ddaecf70e41 ==============================
[0m15:17:24.813398 [info ] [MainThread]: Running with dbt=1.10.11
[0m15:17:24.813398 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select fct_video_daily_metrics --full-refresh', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'log_cache_events': 'False', 'log_path': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m15:17:36.966419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96a34773-ff66-4fd0-a2ea-8ddaecf70e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAFB67E750>]}
[0m15:17:37.121043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96a34773-ff66-4fd0-a2ea-8ddaecf70e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAF7FF7850>]}
[0m15:17:37.121043 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m15:17:38.745261 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m15:17:39.919297 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m15:17:39.919297 [debug] [MainThread]: Partial parsing: updated file: youtube_analytics://dbt/models\marts\dim_channel.sql
[0m15:17:39.919297 [debug] [MainThread]: Partial parsing: updated file: youtube_analytics://dbt/models\marts\video_latest_snapshot.sql
[0m15:17:39.935245 [debug] [MainThread]: Partial parsing: updated file: youtube_analytics://dbt/models\marts\fct_video_daily_metrics.sql
[0m15:17:39.935245 [debug] [MainThread]: Partial parsing: updated file: youtube_analytics://dbt/models\marts\agg_channel_trends_7d.sql
[0m15:17:40.964657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96a34773-ff66-4fd0-a2ea-8ddaecf70e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAF8C3F4D0>]}
[0m15:17:41.137294 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m15:17:41.149858 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m15:17:41.220888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96a34773-ff66-4fd0-a2ea-8ddaecf70e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAA9CF8610>]}
[0m15:17:41.220888 [info ] [MainThread]: Found 7 models, 5 data tests, 495 macros
[0m15:17:41.220888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96a34773-ff66-4fd0-a2ea-8ddaecf70e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAA9D5BC90>]}
[0m15:17:41.226541 [info ] [MainThread]: 
[0m15:17:41.226541 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m15:17:41.226541 [info ] [MainThread]: 
[0m15:17:41.226541 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:17:41.234220 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0'
[0m15:17:41.235364 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:42.084134 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics'
[0m15:17:42.084134 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg'
[0m15:17:42.084134 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:42.090432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:42.796538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96a34773-ff66-4fd0-a2ea-8ddaecf70e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAA94C4C90>]}
[0m15:17:42.797865 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:17:42.808384 [debug] [Thread-1 (]: Began running node model.youtube_analytics.fct_video_daily_metrics
[0m15:17:42.815241 [info ] [Thread-1 (]: 1 of 1 START sql incremental model youtube_stg_youtube_analytics.fct_video_daily_metrics  [RUN]
[0m15:17:42.815241 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.youtube_analytics.fct_video_daily_metrics'
[0m15:17:42.818372 [debug] [Thread-1 (]: Began compiling node model.youtube_analytics.fct_video_daily_metrics
[0m15:17:42.839944 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_analytics.fct_video_daily_metrics"
[0m15:17:42.844388 [debug] [Thread-1 (]: Began executing node model.youtube_analytics.fct_video_daily_metrics
[0m15:17:42.965748 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:17:43.661337 [debug] [Thread-1 (]: Hard refreshing `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics` because it is not replaceable
[0m15:17:43.932808 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_analytics.fct_video_daily_metrics"
[0m15:17:43.932808 [debug] [Thread-1 (]: On model.youtube_analytics.fct_video_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.fct_video_daily_metrics"} */

  
    

    create or replace table `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
      
    partition by load_date
    cluster by channel_id, video_id

    
    OPTIONS()
    as (
      

-- Only pull rows we need. On incremental runs, reprocess the latest day too
-- so window functions (lag) compute correctly at the boundary.
with src as (
  select
    id                                     as video_id,
    snippet.channelId                      as channel_id,
    date(current_date())                   as load_date,
    cast(statistics.viewCount    as int64) as views,
    cast(statistics.likeCount    as int64) as likes,
    cast(statistics.commentCount as int64) as comments
  from `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
  
),
with_lag as (
  select
    *,
    lag(views)    over (partition by video_id order by load_date) as prev_views,
    lag(likes)    over (partition by video_id order by load_date) as prev_likes,
    lag(comments) over (partition by video_id order by load_date) as prev_comments
  from src
)
select
  video_id,
  channel_id,
  load_date,
  views,
  likes,
  comments,
  views    - coalesce(prev_views, 0)    as daily_views,
  likes    - coalesce(prev_likes, 0)    as daily_likes,
  comments - coalesce(prev_comments, 0) as daily_comments
from with_lag
    );
  
[0m15:17:44.836435 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:77b078c5-db08-481f-ad00-3b33f00ffae6&page=queryresults
[0m15:17:45.137597 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:77b078c5-db08-481f-ad00-3b33f00ffae6&page=queryresults
[0m15:17:45.230534 [debug] [Thread-1 (]: Database Error in model fct_video_daily_metrics (dbt/models\marts\fct_video_daily_metrics.sql)
  Unrecognized name: id at [20:5]
  compiled code at target\run\youtube_analytics\dbt/models\marts\fct_video_daily_metrics.sql
[0m15:17:45.241423 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96a34773-ff66-4fd0-a2ea-8ddaecf70e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAF76E1A90>]}
[0m15:17:45.241423 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model youtube_stg_youtube_analytics.fct_video_daily_metrics  [[31mERROR[0m in 2.43s]
[0m15:17:45.241423 [debug] [Thread-1 (]: Finished running node model.youtube_analytics.fct_video_daily_metrics
[0m15:17:45.241423 [debug] [Thread-7 (]: Marking all children of 'model.youtube_analytics.fct_video_daily_metrics' to be skipped because of status 'error'.  Reason: Database Error in model fct_video_daily_metrics (dbt/models\marts\fct_video_daily_metrics.sql)
  Unrecognized name: id at [20:5]
  compiled code at target\run\youtube_analytics\dbt/models\marts\fct_video_daily_metrics.sql.
[0m15:17:45.246825 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:17:45.246825 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:17:45.246825 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0' was properly closed.
[0m15:17:45.246825 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics' was properly closed.
[0m15:17:45.246825 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg' was properly closed.
[0m15:17:45.246825 [debug] [MainThread]: Connection 'model.youtube_analytics.fct_video_daily_metrics' was properly closed.
[0m15:17:45.246825 [info ] [MainThread]: 
[0m15:17:45.246825 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 4.02 seconds (4.02s).
[0m15:17:45.263821 [debug] [MainThread]: Command end result
[0m15:17:45.327330 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m15:17:45.327330 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m15:17:45.341154 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\run_results.json
[0m15:17:45.341154 [info ] [MainThread]: 
[0m15:17:45.341154 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:17:45.353793 [info ] [MainThread]: 
[0m15:17:45.357343 [error] [MainThread]: [31mFailure in model fct_video_daily_metrics (dbt/models\marts\fct_video_daily_metrics.sql)[0m
[0m15:17:45.357343 [error] [MainThread]:   Database Error in model fct_video_daily_metrics (dbt/models\marts\fct_video_daily_metrics.sql)
  Unrecognized name: id at [20:5]
  compiled code at target\run\youtube_analytics\dbt/models\marts\fct_video_daily_metrics.sql
[0m15:17:45.357343 [info ] [MainThread]: 
[0m15:17:45.357343 [info ] [MainThread]:   compiled code at target\compiled\youtube_analytics\dbt/models\marts\fct_video_daily_metrics.sql
[0m15:17:45.357343 [info ] [MainThread]: 
[0m15:17:45.357343 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m15:17:45.357343 [debug] [MainThread]: Command `dbt run` failed at 15:17:45.357343 after 20.66 seconds
[0m15:17:45.357343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAFB2F91D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAA9933E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAA944FC50>]}
[0m15:17:45.357343 [debug] [MainThread]: Flushing usage events
[0m15:17:45.858117 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:20:09.982213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB13EBF190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB13DDFF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB13EDBD50>]}


============================== 15:20:09.984224 | df17593a-fa17-4bf0-b275-b69468b8c673 ==============================
[0m15:20:09.984224 [info ] [MainThread]: Running with dbt=1.10.11
[0m15:20:09.984224 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select fct_video_daily_metrics --full-refresh', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'printer_width': '80', 'log_path': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m15:20:15.510844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df17593a-fa17-4bf0-b275-b69468b8c673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB40CC4C50>]}
[0m15:20:15.669010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df17593a-fa17-4bf0-b275-b69468b8c673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB10869CD0>]}
[0m15:20:15.685063 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m15:20:17.173281 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m15:20:17.576387 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:20:17.578402 [debug] [MainThread]: Partial parsing: updated file: youtube_analytics://dbt/models\marts\fct_video_daily_metrics.sql
[0m15:20:18.480693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df17593a-fa17-4bf0-b275-b69468b8c673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB41481D10>]}
[0m15:20:18.636871 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m15:20:18.636871 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m15:20:18.699105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df17593a-fa17-4bf0-b275-b69468b8c673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB415A0810>]}
[0m15:20:18.714184 [info ] [MainThread]: Found 7 models, 5 data tests, 495 macros
[0m15:20:18.716099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df17593a-fa17-4bf0-b275-b69468b8c673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB414A5450>]}
[0m15:20:18.716099 [info ] [MainThread]: 
[0m15:20:18.716099 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m15:20:18.716099 [info ] [MainThread]: 
[0m15:20:18.716099 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:20:18.716099 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0'
[0m15:20:18.725755 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:19.481181 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics'
[0m15:20:19.482235 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:19.482235 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg'
[0m15:20:19.487200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:20.107051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df17593a-fa17-4bf0-b275-b69468b8c673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB4145E610>]}
[0m15:20:20.107051 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:20:20.120674 [debug] [Thread-1 (]: Began running node model.youtube_analytics.fct_video_daily_metrics
[0m15:20:20.120674 [info ] [Thread-1 (]: 1 of 1 START sql incremental model youtube_stg_youtube_analytics.fct_video_daily_metrics  [RUN]
[0m15:20:20.120674 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.youtube_analytics.fct_video_daily_metrics'
[0m15:20:20.120674 [debug] [Thread-1 (]: Began compiling node model.youtube_analytics.fct_video_daily_metrics
[0m15:20:20.152153 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_analytics.fct_video_daily_metrics"
[0m15:20:20.152153 [debug] [Thread-1 (]: Began executing node model.youtube_analytics.fct_video_daily_metrics
[0m15:20:20.323512 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_analytics.fct_video_daily_metrics"
[0m15:20:20.339317 [debug] [Thread-1 (]: On model.youtube_analytics.fct_video_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.fct_video_daily_metrics"} */

  
    

    create or replace table `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
      
    partition by load_date
    cluster by channel_id, video_id

    
    OPTIONS()
    as (
      

-- Pull from the staging model's flattened columns
with src as (
  select
    video_id,
    channel_id,
    load_date,
    views,
    likes,
    comments
  from `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
  
),

with_lag as (
  select
    *,
    lag(views)    over (partition by video_id order by load_date) as prev_views,
    lag(likes)    over (partition by video_id order by load_date) as prev_likes,
    lag(comments) over (partition by video_id order by load_date) as prev_comments
  from src
)

select
  video_id,
  channel_id,
  load_date,
  views,
  likes,
  comments,
  views    - coalesce(prev_views, 0)    as daily_views,
  likes    - coalesce(prev_likes, 0)    as daily_likes,
  comments - coalesce(prev_comments, 0) as daily_comments
from with_lag
    );
  
[0m15:20:20.339317 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:20:21.408237 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:eb0278c0-574b-4a2b-8dcb-02a0954db9b8&page=queryresults
[0m15:20:26.271626 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df17593a-fa17-4bf0-b275-b69468b8c673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB41B23F10>]}
[0m15:20:26.271626 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model youtube_stg_youtube_analytics.fct_video_daily_metrics  [[32mCREATE TABLE (20.0 rows, 1.2 KiB processed)[0m in 6.15s]
[0m15:20:26.273253 [debug] [Thread-1 (]: Finished running node model.youtube_analytics.fct_video_daily_metrics
[0m15:20:26.273253 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:20:26.278219 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:20:26.278219 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0' was properly closed.
[0m15:20:26.278219 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics' was properly closed.
[0m15:20:26.286422 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg' was properly closed.
[0m15:20:26.286938 [debug] [MainThread]: Connection 'model.youtube_analytics.fct_video_daily_metrics' was properly closed.
[0m15:20:26.288953 [info ] [MainThread]: 
[0m15:20:26.288953 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 7.57 seconds (7.57s).
[0m15:20:26.288953 [debug] [MainThread]: Command end result
[0m15:20:26.350599 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m15:20:26.358920 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m15:20:26.370949 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\run_results.json
[0m15:20:26.370949 [info ] [MainThread]: 
[0m15:20:26.370949 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:20:26.370949 [info ] [MainThread]: 
[0m15:20:26.370949 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:20:26.386964 [debug] [MainThread]: Command `dbt run` succeeded at 15:20:26.386964 after 16.48 seconds
[0m15:20:26.386964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB13F37F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB13F37DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB13B791D0>]}
[0m15:20:26.386964 [debug] [MainThread]: Flushing usage events
[0m15:20:26.874764 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:20:41.442217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001717AEB8D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001717AF1FC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001717AF1F650>]}


============================== 15:20:41.446356 | b5da7546-33e4-4359-992c-515889f0718d ==============================
[0m15:20:41.446356 [info ] [MainThread]: Running with dbt=1.10.11
[0m15:20:41.447346 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'log_path': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m15:20:46.277944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5da7546-33e4-4359-992c-515889f0718d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001717AEEFD90>]}
[0m15:20:46.430754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5da7546-33e4-4359-992c-515889f0718d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017177877B90>]}
[0m15:20:46.430754 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m15:20:47.886659 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m15:20:48.213934 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:20:48.213934 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:20:48.323616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5da7546-33e4-4359-992c-515889f0718d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001712829F6D0>]}
[0m15:20:48.516032 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m15:20:48.521161 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m15:20:48.575132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5da7546-33e4-4359-992c-515889f0718d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017127DCB8D0>]}
[0m15:20:48.576914 [info ] [MainThread]: Found 7 models, 5 data tests, 495 macros
[0m15:20:48.576914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5da7546-33e4-4359-992c-515889f0718d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017128352350>]}
[0m15:20:48.583841 [info ] [MainThread]: 
[0m15:20:48.583841 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m15:20:48.583841 [info ] [MainThread]: 
[0m15:20:48.583841 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:20:48.590953 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0'
[0m15:20:48.590953 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0'
[0m15:20:48.590953 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:48.606856 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:49.267803 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics'
[0m15:20:49.267803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:49.269819 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg'
[0m15:20:49.341064 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:49.871131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5da7546-33e4-4359-992c-515889f0718d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001717AECA410>]}
[0m15:20:49.871131 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:20:49.886884 [debug] [Thread-1 (]: Began running node model.youtube_analytics.stg_youtube_channels
[0m15:20:49.886884 [debug] [Thread-2 (]: Began running node model.youtube_analytics.stg_youtube_video_ids
[0m15:20:49.886884 [debug] [Thread-3 (]: Began running node model.youtube_analytics.stg_youtube_video_stats
[0m15:20:49.886884 [info ] [Thread-1 (]: 1 of 7 START sql view model youtube_stg_youtube_stg.stg_youtube_channels ....... [RUN]
[0m15:20:49.886884 [info ] [Thread-2 (]: 2 of 7 START sql view model youtube_stg_youtube_stg.stg_youtube_video_ids ...... [RUN]
[0m15:20:49.886884 [info ] [Thread-3 (]: 3 of 7 START sql view model youtube_stg_youtube_stg.stg_youtube_video_stats .... [RUN]
[0m15:20:49.886884 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_channels'
[0m15:20:49.902977 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_video_ids'
[0m15:20:49.902977 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_video_stats'
[0m15:20:49.907320 [debug] [Thread-1 (]: Began compiling node model.youtube_analytics.stg_youtube_channels
[0m15:20:49.907320 [debug] [Thread-2 (]: Began compiling node model.youtube_analytics.stg_youtube_video_ids
[0m15:20:49.907320 [debug] [Thread-3 (]: Began compiling node model.youtube_analytics.stg_youtube_video_stats
[0m15:20:49.926421 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_channels"
[0m15:20:49.934699 [debug] [Thread-2 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_video_ids"
[0m15:20:49.941432 [debug] [Thread-3 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_video_stats"
[0m15:20:49.944699 [debug] [Thread-1 (]: Began executing node model.youtube_analytics.stg_youtube_channels
[0m15:20:49.944699 [debug] [Thread-2 (]: Began executing node model.youtube_analytics.stg_youtube_video_ids
[0m15:20:49.946054 [debug] [Thread-3 (]: Began executing node model.youtube_analytics.stg_youtube_video_stats
[0m15:20:50.027402 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_channels"
[0m15:20:50.027402 [debug] [Thread-2 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_video_ids"
[0m15:20:50.027402 [debug] [Thread-3 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_video_stats"
[0m15:20:50.043248 [debug] [Thread-1 (]: On model.youtube_analytics.stg_youtube_channels: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_channels"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_channels`
  OPTIONS()
  as with src as (
  select
    id                                        as channel_id,
    snippet.title                             as channel_title,
    snippet.country                           as channel_country,
    snippet.publishedAt                       as channel_published_at,
    cast(statistics.viewCount       as int64) as channel_view_count,
    cast(statistics.subscriberCount as int64) as channel_subscribers,
    cast(statistics.videoCount      as int64) as channel_video_count,
    date(_partitiontime)                      as load_date
  from `orbital-nuance-471817-n0.youtube_raw.channels_raw`
)
select * from src;


[0m15:20:50.043248 [debug] [Thread-2 (]: On model.youtube_analytics.stg_youtube_video_ids: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_video_ids"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_ids`
  OPTIONS()
  as select
  videoId              as video_id,
  channelId            as channel_id,
  date(_partitiontime) as load_date
from `orbital-nuance-471817-n0.youtube_raw.video_ids_raw`;


[0m15:20:50.046353 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:20:50.046353 [debug] [Thread-3 (]: On model.youtube_analytics.stg_youtube_video_stats: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_video_stats"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
  OPTIONS()
  as with src as (
  select
    id                                     as video_id,
    snippet.channelId                      as channel_id,
    snippet.title                          as video_title,
    snippet.publishedAt                    as video_published_at,
    cast(statistics.viewCount    as int64) as views,
    cast(statistics.likeCount    as int64) as likes,
    cast(statistics.commentCount as int64) as comments,
    contentDetails.duration                as duration_iso,
    current_date()                         as load_date
  from `orbital-nuance-471817-n0.youtube_raw.video_stats_raw`
),
parsed as (
  select
    *,
    (
      coalesce(SAFE_CAST(REGEXP_EXTRACT(duration_iso, r'(\d+)H') AS INT64), 0) * 3600
      + coalesce(SAFE_CAST(REGEXP_EXTRACT(duration_iso, r'(\d+)M') AS INT64), 0) * 60
      + coalesce(SAFE_CAST(REGEXP_EXTRACT(duration_iso, r'(\d+)S') AS INT64), 0)
    ) as duration_seconds
  from src
)
select * from parsed;


[0m15:20:50.046353 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:20:50.106562 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:20:50.997960 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:b97b3d4b-e876-4088-a818-164018e17727&page=queryresults
[0m15:20:50.997960 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:0f89f19c-f321-4c6f-8704-02b440e97e2e&page=queryresults
[0m15:20:50.997960 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:97350cee-cde6-49f9-9028-6f87f418a80b&page=queryresults
[0m15:20:51.677488 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5da7546-33e4-4359-992c-515889f0718d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017127C5E7D0>]}
[0m15:20:51.677488 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5da7546-33e4-4359-992c-515889f0718d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001712853C450>]}
[0m15:20:51.677488 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5da7546-33e4-4359-992c-515889f0718d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171284DB490>]}
[0m15:20:51.677488 [info ] [Thread-1 (]: 1 of 7 OK created sql view model youtube_stg_youtube_stg.stg_youtube_channels .. [[32mCREATE VIEW (0 processed)[0m in 1.77s]
[0m15:20:51.685158 [info ] [Thread-2 (]: 2 of 7 OK created sql view model youtube_stg_youtube_stg.stg_youtube_video_ids . [[32mCREATE VIEW (0 processed)[0m in 1.77s]
[0m15:20:51.687435 [info ] [Thread-3 (]: 3 of 7 OK created sql view model youtube_stg_youtube_stg.stg_youtube_video_stats  [[32mCREATE VIEW (0 processed)[0m in 1.77s]
[0m15:20:51.687435 [debug] [Thread-1 (]: Finished running node model.youtube_analytics.stg_youtube_channels
[0m15:20:51.687435 [debug] [Thread-2 (]: Finished running node model.youtube_analytics.stg_youtube_video_ids
[0m15:20:51.693686 [debug] [Thread-3 (]: Finished running node model.youtube_analytics.stg_youtube_video_stats
[0m15:20:51.693686 [debug] [Thread-4 (]: Began running node model.youtube_analytics.dim_channel
[0m15:20:51.701199 [debug] [Thread-1 (]: Began running node model.youtube_analytics.fct_video_daily_metrics
[0m15:20:51.702229 [debug] [Thread-2 (]: Began running node model.youtube_analytics.video_latest_snapshot
[0m15:20:51.704204 [info ] [Thread-4 (]: 4 of 7 START sql view model youtube_stg_youtube_analytics.dim_channel .......... [RUN]
[0m15:20:51.706208 [info ] [Thread-1 (]: 5 of 7 START sql incremental model youtube_stg_youtube_analytics.fct_video_daily_metrics  [RUN]
[0m15:20:51.707492 [info ] [Thread-2 (]: 6 of 7 START sql view model youtube_stg_youtube_analytics.video_latest_snapshot  [RUN]
[0m15:20:51.710396 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.youtube_analytics.dim_channel'
[0m15:20:51.712393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.youtube_analytics.stg_youtube_channels, now model.youtube_analytics.fct_video_daily_metrics)
[0m15:20:51.713289 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.youtube_analytics.stg_youtube_video_ids, now model.youtube_analytics.video_latest_snapshot)
[0m15:20:51.714291 [debug] [Thread-4 (]: Began compiling node model.youtube_analytics.dim_channel
[0m15:20:51.714291 [debug] [Thread-1 (]: Began compiling node model.youtube_analytics.fct_video_daily_metrics
[0m15:20:51.714291 [debug] [Thread-2 (]: Began compiling node model.youtube_analytics.video_latest_snapshot
[0m15:20:51.730208 [debug] [Thread-4 (]: Writing injected SQL for node "model.youtube_analytics.dim_channel"
[0m15:20:51.746126 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_analytics.fct_video_daily_metrics"
[0m15:20:51.762833 [debug] [Thread-2 (]: Writing injected SQL for node "model.youtube_analytics.video_latest_snapshot"
[0m15:20:51.762833 [debug] [Thread-4 (]: Began executing node model.youtube_analytics.dim_channel
[0m15:20:51.778041 [debug] [Thread-1 (]: Began executing node model.youtube_analytics.fct_video_daily_metrics
[0m15:20:51.778041 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:20:51.839292 [debug] [Thread-2 (]: Began executing node model.youtube_analytics.video_latest_snapshot
[0m15:20:51.871330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:51.887780 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:20:52.013018 [debug] [Thread-4 (]: Compilation Error in model dim_channel (dbt/models\marts\dim_channel.sql)
  Trying to create view `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`dim_channel`, but it currently exists as a table. Either drop `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`dim_channel` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
  > called by macro handle_existing_table (macros\relations\view\replace.sql)
  > called by macro bigquery__create_or_replace_view (macros\relations\view\replace.sql)
  > called by macro materialization_view_bigquery (macros\materializations\view.sql)
  > called by model dim_channel (dbt/models\marts\dim_channel.sql)
[0m15:20:52.013018 [debug] [Thread-2 (]: Compilation Error in model video_latest_snapshot (dbt/models\marts\video_latest_snapshot.sql)
  Trying to create view `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`video_latest_snapshot`, but it currently exists as a table. Either drop `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`video_latest_snapshot` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
  > called by macro handle_existing_table (macros\relations\view\replace.sql)
  > called by macro bigquery__create_or_replace_view (macros\relations\view\replace.sql)
  > called by macro materialization_view_bigquery (macros\materializations\view.sql)
  > called by model video_latest_snapshot (dbt/models\marts\video_latest_snapshot.sql)
[0m15:20:52.013018 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5da7546-33e4-4359-992c-515889f0718d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017128586490>]}
[0m15:20:52.013018 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5da7546-33e4-4359-992c-515889f0718d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017128C06CD0>]}
[0m15:20:52.022084 [error] [Thread-4 (]: 4 of 7 ERROR creating sql view model youtube_stg_youtube_analytics.dim_channel . [[31mERROR[0m in 0.30s]
[0m15:20:52.024894 [error] [Thread-2 (]: 6 of 7 ERROR creating sql view model youtube_stg_youtube_analytics.video_latest_snapshot  [[31mERROR[0m in 0.30s]
[0m15:20:52.024894 [debug] [Thread-4 (]: Finished running node model.youtube_analytics.dim_channel
[0m15:20:52.028742 [debug] [Thread-2 (]: Finished running node model.youtube_analytics.video_latest_snapshot
[0m15:20:52.030032 [debug] [Thread-7 (]: Marking all children of 'model.youtube_analytics.dim_channel' to be skipped because of status 'error'.  Reason: Compilation Error in model dim_channel (dbt/models\marts\dim_channel.sql)
  Trying to create view `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`dim_channel`, but it currently exists as a table. Either drop `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`dim_channel` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
  > called by macro handle_existing_table (macros\relations\view\replace.sql)
  > called by macro bigquery__create_or_replace_view (macros\relations\view\replace.sql)
  > called by macro materialization_view_bigquery (macros\materializations\view.sql)
  > called by model dim_channel (dbt/models\marts\dim_channel.sql).
[0m15:20:52.035280 [debug] [Thread-7 (]: Marking all children of 'model.youtube_analytics.video_latest_snapshot' to be skipped because of status 'error'.  Reason: Compilation Error in model video_latest_snapshot (dbt/models\marts\video_latest_snapshot.sql)
  Trying to create view `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`video_latest_snapshot`, but it currently exists as a table. Either drop `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`video_latest_snapshot` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
  > called by macro handle_existing_table (macros\relations\view\replace.sql)
  > called by macro bigquery__create_or_replace_view (macros\relations\view\replace.sql)
  > called by macro materialization_view_bigquery (macros\materializations\view.sql)
  > called by model video_latest_snapshot (dbt/models\marts\video_latest_snapshot.sql).
[0m15:20:52.559214 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_analytics.fct_video_daily_metrics"
[0m15:20:52.560960 [debug] [Thread-1 (]: On model.youtube_analytics.fct_video_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.fct_video_daily_metrics"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics` as DBT_INTERNAL_DEST
        using (

-- Pull from the staging model's flattened columns
with src as (
  select
    video_id,
    channel_id,
    load_date,
    views,
    likes,
    comments
  from `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
  
    -- Reprocess yesterday + today so lag() boundaries stay correct
    where load_date >= (
      select date_sub(coalesce(max(load_date), date '1900-01-01'), interval 1 day)
      from `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
    )
  
),

with_lag as (
  select
    *,
    lag(views)    over (partition by video_id order by load_date) as prev_views,
    lag(likes)    over (partition by video_id order by load_date) as prev_likes,
    lag(comments) over (partition by video_id order by load_date) as prev_comments
  from src
)

select
  video_id,
  channel_id,
  load_date,
  views,
  likes,
  comments,
  views    - coalesce(prev_views, 0)    as daily_views,
  likes    - coalesce(prev_likes, 0)    as daily_likes,
  comments - coalesce(prev_comments, 0) as daily_comments
from with_lag
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.video_id = DBT_INTERNAL_DEST.video_id
                ) and (
                    DBT_INTERNAL_SOURCE.load_date = DBT_INTERNAL_DEST.load_date
                )

    
    when matched then update set
        `video_id` = DBT_INTERNAL_SOURCE.`video_id`,`channel_id` = DBT_INTERNAL_SOURCE.`channel_id`,`load_date` = DBT_INTERNAL_SOURCE.`load_date`,`views` = DBT_INTERNAL_SOURCE.`views`,`likes` = DBT_INTERNAL_SOURCE.`likes`,`comments` = DBT_INTERNAL_SOURCE.`comments`,`daily_views` = DBT_INTERNAL_SOURCE.`daily_views`,`daily_likes` = DBT_INTERNAL_SOURCE.`daily_likes`,`daily_comments` = DBT_INTERNAL_SOURCE.`daily_comments`
    

    when not matched then insert
        (`video_id`, `channel_id`, `load_date`, `views`, `likes`, `comments`, `daily_views`, `daily_likes`, `daily_comments`)
    values
        (`video_id`, `channel_id`, `load_date`, `views`, `likes`, `comments`, `daily_views`, `daily_likes`, `daily_comments`)


    
[0m15:20:53.250886 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:121606ae-0064-4dff-806e-593c5954a52e&page=queryresults
[0m15:20:56.056332 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5da7546-33e4-4359-992c-515889f0718d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017128BC5110>]}
[0m15:20:56.056332 [info ] [Thread-1 (]: 5 of 7 OK created sql incremental model youtube_stg_youtube_analytics.fct_video_daily_metrics  [[32mMERGE (20.0 rows, 3.1 KiB processed)[0m in 4.34s]
[0m15:20:56.058675 [debug] [Thread-1 (]: Finished running node model.youtube_analytics.fct_video_daily_metrics
[0m15:20:56.058675 [debug] [Thread-3 (]: Began running node model.youtube_analytics.agg_channel_trends_7d
[0m15:20:56.061238 [info ] [Thread-3 (]: 7 of 7 START sql view model youtube_stg_youtube_analytics.agg_channel_trends_7d  [RUN]
[0m15:20:56.063383 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.youtube_analytics.stg_youtube_video_stats, now model.youtube_analytics.agg_channel_trends_7d)
[0m15:20:56.066566 [debug] [Thread-3 (]: Began compiling node model.youtube_analytics.agg_channel_trends_7d
[0m15:20:56.074526 [debug] [Thread-3 (]: Writing injected SQL for node "model.youtube_analytics.agg_channel_trends_7d"
[0m15:20:56.074526 [debug] [Thread-3 (]: Began executing node model.youtube_analytics.agg_channel_trends_7d
[0m15:20:56.074526 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:20:56.089976 [debug] [Thread-3 (]: Compilation Error in model agg_channel_trends_7d (dbt/models\marts\agg_channel_trends_7d.sql)
  Trying to create view `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`agg_channel_trends_7d`, but it currently exists as a table. Either drop `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`agg_channel_trends_7d` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
  > called by macro handle_existing_table (macros\relations\view\replace.sql)
  > called by macro bigquery__create_or_replace_view (macros\relations\view\replace.sql)
  > called by macro materialization_view_bigquery (macros\materializations\view.sql)
  > called by model agg_channel_trends_7d (dbt/models\marts\agg_channel_trends_7d.sql)
[0m15:20:56.089976 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5da7546-33e4-4359-992c-515889f0718d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017128CF66D0>]}
[0m15:20:56.089976 [error] [Thread-3 (]: 7 of 7 ERROR creating sql view model youtube_stg_youtube_analytics.agg_channel_trends_7d  [[31mERROR[0m in 0.03s]
[0m15:20:56.106075 [debug] [Thread-3 (]: Finished running node model.youtube_analytics.agg_channel_trends_7d
[0m15:20:56.106075 [debug] [Thread-7 (]: Marking all children of 'model.youtube_analytics.agg_channel_trends_7d' to be skipped because of status 'error'.  Reason: Compilation Error in model agg_channel_trends_7d (dbt/models\marts\agg_channel_trends_7d.sql)
  Trying to create view `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`agg_channel_trends_7d`, but it currently exists as a table. Either drop `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`agg_channel_trends_7d` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
  > called by macro handle_existing_table (macros\relations\view\replace.sql)
  > called by macro bigquery__create_or_replace_view (macros\relations\view\replace.sql)
  > called by macro materialization_view_bigquery (macros\materializations\view.sql)
  > called by model agg_channel_trends_7d (dbt/models\marts\agg_channel_trends_7d.sql).
[0m15:20:56.110128 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:20:56.110128 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:20:56.110128 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0' was properly closed.
[0m15:20:56.122151 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0' was properly closed.
[0m15:20:56.122151 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics' was properly closed.
[0m15:20:56.122151 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg' was properly closed.
[0m15:20:56.122151 [debug] [MainThread]: Connection 'model.youtube_analytics.fct_video_daily_metrics' was properly closed.
[0m15:20:56.122151 [debug] [MainThread]: Connection 'model.youtube_analytics.video_latest_snapshot' was properly closed.
[0m15:20:56.122151 [debug] [MainThread]: Connection 'model.youtube_analytics.agg_channel_trends_7d' was properly closed.
[0m15:20:56.122151 [debug] [MainThread]: Connection 'model.youtube_analytics.dim_channel' was properly closed.
[0m15:20:56.122151 [info ] [MainThread]: 
[0m15:20:56.137581 [info ] [MainThread]: Finished running 1 incremental model, 6 view models in 0 hours 0 minutes and 7.54 seconds (7.54s).
[0m15:20:56.137581 [debug] [MainThread]: Command end result
[0m15:20:56.199941 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m15:20:56.203812 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m15:20:56.221324 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\run_results.json
[0m15:20:56.221324 [info ] [MainThread]: 
[0m15:20:56.221324 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m15:20:56.221324 [info ] [MainThread]: 
[0m15:20:56.231305 [error] [MainThread]: [31mFailure in model dim_channel (dbt/models\marts\dim_channel.sql)[0m
[0m15:20:56.231305 [error] [MainThread]:   Compilation Error in model dim_channel (dbt/models\marts\dim_channel.sql)
  Trying to create view `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`dim_channel`, but it currently exists as a table. Either drop `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`dim_channel` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
  > called by macro handle_existing_table (macros\relations\view\replace.sql)
  > called by macro bigquery__create_or_replace_view (macros\relations\view\replace.sql)
  > called by macro materialization_view_bigquery (macros\materializations\view.sql)
  > called by model dim_channel (dbt/models\marts\dim_channel.sql)
[0m15:20:56.231305 [info ] [MainThread]: 
[0m15:20:56.231305 [info ] [MainThread]:   compiled code at target\compiled\youtube_analytics\dbt/models\marts\dim_channel.sql
[0m15:20:56.237728 [info ] [MainThread]: 
[0m15:20:56.237728 [error] [MainThread]: [31mFailure in model video_latest_snapshot (dbt/models\marts\video_latest_snapshot.sql)[0m
[0m15:20:56.237728 [error] [MainThread]:   Compilation Error in model video_latest_snapshot (dbt/models\marts\video_latest_snapshot.sql)
  Trying to create view `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`video_latest_snapshot`, but it currently exists as a table. Either drop `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`video_latest_snapshot` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
  > called by macro handle_existing_table (macros\relations\view\replace.sql)
  > called by macro bigquery__create_or_replace_view (macros\relations\view\replace.sql)
  > called by macro materialization_view_bigquery (macros\materializations\view.sql)
  > called by model video_latest_snapshot (dbt/models\marts\video_latest_snapshot.sql)
[0m15:20:56.237728 [info ] [MainThread]: 
[0m15:20:56.237728 [info ] [MainThread]:   compiled code at target\compiled\youtube_analytics\dbt/models\marts\video_latest_snapshot.sql
[0m15:20:56.237728 [info ] [MainThread]: 
[0m15:20:56.247076 [error] [MainThread]: [31mFailure in model agg_channel_trends_7d (dbt/models\marts\agg_channel_trends_7d.sql)[0m
[0m15:20:56.247076 [error] [MainThread]:   Compilation Error in model agg_channel_trends_7d (dbt/models\marts\agg_channel_trends_7d.sql)
  Trying to create view `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`agg_channel_trends_7d`, but it currently exists as a table. Either drop `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`agg_channel_trends_7d` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
  > called by macro handle_existing_table (macros\relations\view\replace.sql)
  > called by macro bigquery__create_or_replace_view (macros\relations\view\replace.sql)
  > called by macro materialization_view_bigquery (macros\materializations\view.sql)
  > called by model agg_channel_trends_7d (dbt/models\marts\agg_channel_trends_7d.sql)
[0m15:20:56.247076 [info ] [MainThread]: 
[0m15:20:56.247076 [info ] [MainThread]:   compiled code at target\compiled\youtube_analytics\dbt/models\marts\agg_channel_trends_7d.sql
[0m15:20:56.247076 [info ] [MainThread]: 
[0m15:20:56.247076 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=7
[0m15:20:56.247076 [debug] [MainThread]: Command `dbt run` failed at 15:20:56.247076 after 14.88 seconds
[0m15:20:56.247076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001717AC6E7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001717AF47F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017174440910>]}
[0m15:20:56.247076 [debug] [MainThread]: Flushing usage events
[0m15:20:56.746000 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:25:34.574549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8FAD1B310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8FAD1B190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8FAD1BAD0>]}


============================== 15:25:34.574549 | 667d7d39-4767-45fa-82dd-8a7b433bcac0 ==============================
[0m15:25:34.574549 [info ] [MainThread]: Running with dbt=1.10.11
[0m15:25:34.574549 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --select dim_channel video_latest_snapshot agg_channel_trends_7d --full-refresh', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'log_path': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\logs', 'profiles_dir': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m15:25:39.762162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '667d7d39-4767-45fa-82dd-8a7b433bcac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8A7AE8450>]}
[0m15:25:39.906853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '667d7d39-4767-45fa-82dd-8a7b433bcac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8F76DC3D0>]}
[0m15:25:39.906853 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m15:25:41.370865 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m15:25:41.710788 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:25:41.710788 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:25:41.792851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '667d7d39-4767-45fa-82dd-8a7b433bcac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8FAD5E190>]}
[0m15:25:41.966116 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m15:25:41.966116 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m15:25:42.043033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '667d7d39-4767-45fa-82dd-8a7b433bcac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8A81B9490>]}
[0m15:25:42.043033 [info ] [MainThread]: Found 7 models, 5 data tests, 495 macros
[0m15:25:42.043033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '667d7d39-4767-45fa-82dd-8a7b433bcac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8A7B79CD0>]}
[0m15:25:42.051444 [info ] [MainThread]: 
[0m15:25:42.053449 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m15:25:42.053449 [info ] [MainThread]: 
[0m15:25:42.053449 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:25:42.066065 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0'
[0m15:25:42.068048 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:42.840163 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics'
[0m15:25:42.840163 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg'
[0m15:25:42.840163 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:42.840163 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:43.558613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '667d7d39-4767-45fa-82dd-8a7b433bcac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8F78C1510>]}
[0m15:25:43.558613 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:25:43.574691 [debug] [Thread-1 (]: Began running node model.youtube_analytics.agg_channel_trends_7d
[0m15:25:43.574691 [debug] [Thread-2 (]: Began running node model.youtube_analytics.dim_channel
[0m15:25:43.574691 [debug] [Thread-3 (]: Began running node model.youtube_analytics.video_latest_snapshot
[0m15:25:43.574691 [info ] [Thread-1 (]: 1 of 3 START sql view model youtube_stg_youtube_analytics.agg_channel_trends_7d  [RUN]
[0m15:25:43.592253 [info ] [Thread-2 (]: 2 of 3 START sql view model youtube_stg_youtube_analytics.dim_channel .......... [RUN]
[0m15:25:43.594404 [info ] [Thread-3 (]: 3 of 3 START sql view model youtube_stg_youtube_analytics.video_latest_snapshot  [RUN]
[0m15:25:43.596527 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.youtube_analytics.agg_channel_trends_7d'
[0m15:25:43.598441 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.youtube_analytics.dim_channel'
[0m15:25:43.600706 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.youtube_analytics.video_latest_snapshot'
[0m15:25:43.601708 [debug] [Thread-1 (]: Began compiling node model.youtube_analytics.agg_channel_trends_7d
[0m15:25:43.603783 [debug] [Thread-2 (]: Began compiling node model.youtube_analytics.dim_channel
[0m15:25:43.604721 [debug] [Thread-3 (]: Began compiling node model.youtube_analytics.video_latest_snapshot
[0m15:25:43.626917 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_analytics.agg_channel_trends_7d"
[0m15:25:43.633903 [debug] [Thread-2 (]: Writing injected SQL for node "model.youtube_analytics.dim_channel"
[0m15:25:43.641939 [debug] [Thread-3 (]: Writing injected SQL for node "model.youtube_analytics.video_latest_snapshot"
[0m15:25:43.644816 [debug] [Thread-2 (]: Began executing node model.youtube_analytics.dim_channel
[0m15:25:43.645954 [debug] [Thread-1 (]: Began executing node model.youtube_analytics.agg_channel_trends_7d
[0m15:25:43.686372 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:25:43.686372 [debug] [Thread-3 (]: Began executing node model.youtube_analytics.video_latest_snapshot
[0m15:25:43.691806 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:25:43.765315 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:25:44.490528 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_analytics.agg_channel_trends_7d"
[0m15:25:44.490528 [debug] [Thread-2 (]: Writing runtime sql for node "model.youtube_analytics.dim_channel"
[0m15:25:44.492537 [debug] [Thread-3 (]: Writing runtime sql for node "model.youtube_analytics.video_latest_snapshot"
[0m15:25:44.494544 [debug] [Thread-1 (]: On model.youtube_analytics.agg_channel_trends_7d: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.agg_channel_trends_7d"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`agg_channel_trends_7d`
  OPTIONS()
  as 

with daily as (
  select
    channel_id,
    video_id,
    load_date,
    daily_views,
    daily_likes,
    daily_comments
  from `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
),
rollup_cte as (
  select
    channel_id,
    load_date,
    sum(daily_views)    over (
      partition by channel_id
      order by load_date
      rows between 6 preceding and current row
    ) as views_7d,
    sum(daily_likes)    over (
      partition by channel_id
      order by load_date
      rows between 6 preceding and current row
    ) as likes_7d,
    sum(daily_comments) over (
      partition by channel_id
      order by load_date
      rows between 6 preceding and current row
    ) as comments_7d
  from daily
)
select distinct channel_id, load_date, views_7d, likes_7d, comments_7d
from rollup_cte;


[0m15:25:44.496042 [debug] [Thread-2 (]: On model.youtube_analytics.dim_channel: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.dim_channel"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`dim_channel`
  OPTIONS()
  as 

with ranked as (
  select
    channel_id,
    channel_title,
    channel_country,
    channel_published_at,
    channel_view_count,
    channel_subscribers,
    channel_video_count,
    load_date,
    row_number() over (partition by channel_id order by load_date desc) as rn
  from `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_channels`
)
select
  channel_id,
  channel_title,
  channel_country,
  channel_published_at,
  channel_view_count,
  channel_subscribers,
  channel_video_count,
  load_date as snapshot_date
from ranked
where rn = 1;


[0m15:25:44.498252 [debug] [Thread-3 (]: On model.youtube_analytics.video_latest_snapshot: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.video_latest_snapshot"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`video_latest_snapshot`
  OPTIONS()
  as 

with ranked as (
  select
    s.video_id,
    s.channel_id,
    s.video_title,
    s.video_published_at,
    s.views,
    s.likes,
    s.comments,
    s.duration_seconds,
    s.load_date,
    row_number() over (partition by s.video_id order by s.load_date desc) as rn
  from `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats` s
)
select
  r.video_id,
  r.channel_id,
  r.video_title,
  r.video_published_at,
  r.views,
  r.likes,
  r.comments,
  r.duration_seconds,
  r.load_date as snapshot_date
from ranked r
where rn = 1;


[0m15:25:45.091392 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:1cb2ef3d-3b88-4f7b-824d-31e4d69aa82e&page=queryresults
[0m15:25:45.093490 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:979a831d-3c2d-45c4-b05e-9c341b90aca9&page=queryresults
[0m15:25:45.169318 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:303875d2-ee68-47aa-af8a-e09913be21ae&page=queryresults
[0m15:25:45.612253 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '667d7d39-4767-45fa-82dd-8a7b433bcac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8A8288BD0>]}
[0m15:25:45.613283 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '667d7d39-4767-45fa-82dd-8a7b433bcac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8A8982AD0>]}
[0m15:25:45.615283 [info ] [Thread-1 (]: 1 of 3 OK created sql view model youtube_stg_youtube_analytics.agg_channel_trends_7d  [[32mCREATE VIEW (0 processed)[0m in 2.00s]
[0m15:25:45.617273 [info ] [Thread-2 (]: 2 of 3 OK created sql view model youtube_stg_youtube_analytics.dim_channel ..... [[32mCREATE VIEW (0 processed)[0m in 2.01s]
[0m15:25:45.618688 [debug] [Thread-1 (]: Finished running node model.youtube_analytics.agg_channel_trends_7d
[0m15:25:45.619735 [debug] [Thread-2 (]: Finished running node model.youtube_analytics.dim_channel
[0m15:25:45.636701 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '667d7d39-4767-45fa-82dd-8a7b433bcac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8A8035790>]}
[0m15:25:45.636701 [info ] [Thread-3 (]: 3 of 3 OK created sql view model youtube_stg_youtube_analytics.video_latest_snapshot  [[32mCREATE VIEW (0 processed)[0m in 2.04s]
[0m15:25:45.636701 [debug] [Thread-3 (]: Finished running node model.youtube_analytics.video_latest_snapshot
[0m15:25:45.636701 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:25:45.645395 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:25:45.645395 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0' was properly closed.
[0m15:25:45.645395 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics' was properly closed.
[0m15:25:45.645395 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg' was properly closed.
[0m15:25:45.645395 [debug] [MainThread]: Connection 'model.youtube_analytics.agg_channel_trends_7d' was properly closed.
[0m15:25:45.645395 [debug] [MainThread]: Connection 'model.youtube_analytics.dim_channel' was properly closed.
[0m15:25:45.652171 [debug] [MainThread]: Connection 'model.youtube_analytics.video_latest_snapshot' was properly closed.
[0m15:25:45.652171 [info ] [MainThread]: 
[0m15:25:45.652171 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 3.60 seconds (3.60s).
[0m15:25:45.652171 [debug] [MainThread]: Command end result
[0m15:25:45.712367 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m15:25:45.717842 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m15:25:45.729735 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\run_results.json
[0m15:25:45.729735 [info ] [MainThread]: 
[0m15:25:45.729735 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:25:45.729735 [info ] [MainThread]: 
[0m15:25:45.729735 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m15:25:45.729735 [debug] [MainThread]: Command `dbt run` succeeded at 15:25:45.729735 after 11.22 seconds
[0m15:25:45.729735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8F4251250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8F42500D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8FAD08C90>]}
[0m15:25:45.729735 [debug] [MainThread]: Flushing usage events
[0m15:25:46.158571 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:25:56.180620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DEC9F99D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DECA63FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DECA34310>]}


============================== 15:25:56.183339 | a91098a3-7279-472e-9a16-f2aabe8091d8 ==============================
[0m15:25:56.183339 [info ] [MainThread]: Running with dbt=1.10.11
[0m15:25:56.183339 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\logs', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m15:26:01.069866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a91098a3-7279-472e-9a16-f2aabe8091d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D99873110>]}
[0m15:26:01.248270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a91098a3-7279-472e-9a16-f2aabe8091d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DE93C5C10>]}
[0m15:26:01.248270 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m15:26:02.668801 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m15:26:03.018141 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:26:03.018141 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:26:03.117987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a91098a3-7279-472e-9a16-f2aabe8091d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D998C2F10>]}
[0m15:26:03.309722 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m15:26:03.318508 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m15:26:03.401463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a91098a3-7279-472e-9a16-f2aabe8091d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D9A0A21D0>]}
[0m15:26:03.401463 [info ] [MainThread]: Found 7 models, 5 data tests, 495 macros
[0m15:26:03.401463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a91098a3-7279-472e-9a16-f2aabe8091d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D99DACE50>]}
[0m15:26:03.418778 [info ] [MainThread]: 
[0m15:26:03.418778 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m15:26:03.418778 [info ] [MainThread]: 
[0m15:26:03.418778 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:26:03.435307 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics'
[0m15:26:03.435307 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:26:03.435307 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg'
[0m15:26:03.504969 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:26:04.148463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a91098a3-7279-472e-9a16-f2aabe8091d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D99D28750>]}
[0m15:26:04.149590 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:26:04.168327 [debug] [Thread-2 (]: Began running node test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1
[0m15:26:04.155823 [debug] [Thread-1 (]: Began running node test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267
[0m15:26:04.168327 [debug] [Thread-3 (]: Began running node test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7
[0m15:26:04.168327 [debug] [Thread-4 (]: Began running node test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602
[0m15:26:04.168327 [info ] [Thread-2 (]: 2 of 5 START test not_null_fct_video_daily_metrics_video_id .................... [RUN]
[0m15:26:04.168327 [info ] [Thread-1 (]: 1 of 5 START test not_null_fct_video_daily_metrics_load_date ................... [RUN]
[0m15:26:04.168327 [info ] [Thread-3 (]: 3 of 5 START test not_null_stg_youtube_video_stats_load_date ................... [RUN]
[0m15:26:04.168327 [info ] [Thread-4 (]: 4 of 5 START test not_null_stg_youtube_video_stats_video_id .................... [RUN]
[0m15:26:04.168327 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1'
[0m15:26:04.168327 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267'
[0m15:26:04.186179 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7'
[0m15:26:04.186179 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602'
[0m15:26:04.189408 [debug] [Thread-2 (]: Began compiling node test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1
[0m15:26:04.189408 [debug] [Thread-1 (]: Began compiling node test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267
[0m15:26:04.193340 [debug] [Thread-3 (]: Began compiling node test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7
[0m15:26:04.193340 [debug] [Thread-4 (]: Began compiling node test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602
[0m15:26:04.242747 [debug] [Thread-2 (]: Writing injected SQL for node "test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1"
[0m15:26:04.257888 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267"
[0m15:26:04.265598 [debug] [Thread-3 (]: Writing injected SQL for node "test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7"
[0m15:26:04.277448 [debug] [Thread-4 (]: Writing injected SQL for node "test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602"
[0m15:26:04.277448 [debug] [Thread-2 (]: Began executing node test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1
[0m15:26:04.277448 [debug] [Thread-1 (]: Began executing node test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267
[0m15:26:04.277448 [debug] [Thread-3 (]: Began executing node test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7
[0m15:26:04.293346 [debug] [Thread-4 (]: Began executing node test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602
[0m15:26:04.325398 [debug] [Thread-2 (]: Writing runtime sql for node "test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1"
[0m15:26:04.342965 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267"
[0m15:26:04.349531 [debug] [Thread-3 (]: Writing runtime sql for node "test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7"
[0m15:26:04.360585 [debug] [Thread-4 (]: Writing runtime sql for node "test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602"
[0m15:26:04.363480 [debug] [Thread-2 (]: On test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select video_id
from `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
where video_id is null



  
  
      
    ) dbt_internal_test
[0m15:26:04.366026 [debug] [Thread-1 (]: On test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select load_date
from `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
where load_date is null



  
  
      
    ) dbt_internal_test
[0m15:26:04.369010 [debug] [Thread-3 (]: On test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select load_date
from `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
where load_date is null



  
  
      
    ) dbt_internal_test
[0m15:26:04.370015 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:26:04.371439 [debug] [Thread-4 (]: On test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select video_id
from `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
where video_id is null



  
  
      
    ) dbt_internal_test
[0m15:26:04.372611 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:26:04.374517 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:26:04.436860 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:26:05.467108 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:22c9ef06-dede-4532-abf5-b5d3fd142d35&page=queryresults
[0m15:26:05.478487 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:6755c4ca-44f1-4aeb-ac7b-9eef91df71a3&page=queryresults
[0m15:26:05.510101 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:4ec79a78-9f8e-474e-90d9-c74e5cd5f534&page=queryresults
[0m15:26:05.578015 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:19c961ff-22c6-450e-a02a-f77e240d994e&page=queryresults
[0m15:26:06.292798 [info ] [Thread-2 (]: 2 of 5 PASS not_null_fct_video_daily_metrics_video_id .......................... [[32mPASS[0m in 2.12s]
[0m15:26:06.295911 [info ] [Thread-1 (]: 1 of 5 PASS not_null_fct_video_daily_metrics_load_date ......................... [[32mPASS[0m in 2.13s]
[0m15:26:06.300508 [debug] [Thread-2 (]: Finished running node test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1
[0m15:26:06.297405 [info ] [Thread-4 (]: 4 of 5 PASS not_null_stg_youtube_video_stats_video_id .......................... [[32mPASS[0m in 2.11s]
[0m15:26:06.301659 [debug] [Thread-1 (]: Finished running node test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267
[0m15:26:06.300508 [info ] [Thread-3 (]: 3 of 5 PASS not_null_stg_youtube_video_stats_load_date ......................... [[32mPASS[0m in 2.12s]
[0m15:26:06.302684 [debug] [Thread-2 (]: Began running node test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e
[0m15:26:06.303688 [debug] [Thread-4 (]: Finished running node test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602
[0m15:26:06.303688 [debug] [Thread-3 (]: Finished running node test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7
[0m15:26:06.305179 [info ] [Thread-2 (]: 5 of 5 START test unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_  [RUN]
[0m15:26:06.306185 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1, now test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e)
[0m15:26:06.306185 [debug] [Thread-2 (]: Began compiling node test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e
[0m15:26:06.312776 [debug] [Thread-2 (]: Writing injected SQL for node "test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e"
[0m15:26:06.313655 [debug] [Thread-2 (]: Began executing node test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e
[0m15:26:06.315758 [debug] [Thread-2 (]: Writing runtime sql for node "test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e"
[0m15:26:06.316656 [debug] [Thread-2 (]: On test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select video_id || '-' || cast(load_date as string) as unique_field
  from `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
  where video_id || '-' || cast(load_date as string) is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:26:06.316656 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:26:07.412399 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:40b4ac36-20e4-4517-84f1-622ff311dec3&page=queryresults
[0m15:26:08.125669 [info ] [Thread-2 (]: 5 of 5 PASS unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_ .. [[32mPASS[0m in 1.82s]
[0m15:26:08.125669 [debug] [Thread-2 (]: Finished running node test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e
[0m15:26:08.138813 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:26:08.141648 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:26:08.143659 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics' was properly closed.
[0m15:26:08.144481 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg' was properly closed.
[0m15:26:08.144481 [debug] [MainThread]: Connection 'test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e' was properly closed.
[0m15:26:08.144481 [debug] [MainThread]: Connection 'test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267' was properly closed.
[0m15:26:08.144481 [debug] [MainThread]: Connection 'test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7' was properly closed.
[0m15:26:08.144481 [debug] [MainThread]: Connection 'test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602' was properly closed.
[0m15:26:08.144481 [info ] [MainThread]: 
[0m15:26:08.144481 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 4.73 seconds (4.73s).
[0m15:26:08.153814 [debug] [MainThread]: Command end result
[0m15:26:08.198592 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m15:26:08.198592 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m15:26:08.215722 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\run_results.json
[0m15:26:08.215722 [info ] [MainThread]: 
[0m15:26:08.215722 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:26:08.215722 [info ] [MainThread]: 
[0m15:26:08.215722 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m15:26:08.215722 [debug] [MainThread]: Command `dbt test` succeeded at 15:26:08.215722 after 12.11 seconds
[0m15:26:08.230512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DE5F7EFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DE5DEBCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DEC6B5690>]}
[0m15:26:08.230512 [debug] [MainThread]: Flushing usage events
[0m15:26:08.636380 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:59:20.209500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276AC56B190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276AC56B6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276AC568CD0>]}


============================== 14:59:20.209500 | 01e689fd-593b-40c6-9f73-379ddbf66dbc ==============================
[0m14:59:20.209500 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:59:20.223350 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'printer_width': '80', 'empty': 'False', 'indirect_selection': 'eager', 'log_path': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\logs', 'profiles_dir': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m14:59:34.839772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01e689fd-593b-40c6-9f73-379ddbf66dbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276AB62C810>]}
[0m14:59:34.986078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01e689fd-593b-40c6-9f73-379ddbf66dbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276A8F25AD0>]}
[0m14:59:34.988089 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m14:59:36.773680 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m14:59:36.985861 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:59:36.985861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '01e689fd-593b-40c6-9f73-379ddbf66dbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276ABCEFF90>]}
[0m14:59:41.952283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01e689fd-593b-40c6-9f73-379ddbf66dbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276D9CB2C90>]}
[0m14:59:42.114872 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m14:59:42.146529 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m14:59:42.235365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01e689fd-593b-40c6-9f73-379ddbf66dbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276D9E63B90>]}
[0m14:59:42.235365 [info ] [MainThread]: Found 7 models, 5 data tests, 495 macros
[0m14:59:42.237379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01e689fd-593b-40c6-9f73-379ddbf66dbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276D9C08210>]}
[0m14:59:42.240544 [info ] [MainThread]: 
[0m14:59:42.240544 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m14:59:42.240544 [info ] [MainThread]: 
[0m14:59:42.240544 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:59:42.259672 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_YOUR_GCP_PROJECT_ID_HERE'
[0m14:59:42.261673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:59:42.262669 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_YOUR_GCP_PROJECT_ID_HERE'
[0m14:59:42.264671 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:59:43.000276 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:59:43.004304 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:59:43.004304 [debug] [MainThread]: Connection 'list_YOUR_GCP_PROJECT_ID_HERE' was properly closed.
[0m14:59:43.006319 [debug] [MainThread]: Connection 'list_YOUR_GCP_PROJECT_ID_HERE' was properly closed.
[0m14:59:43.006319 [info ] [MainThread]: 
[0m14:59:43.006319 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.77 seconds (0.77s).
[0m14:59:43.006319 [error] [MainThread]: Encountered an error:
Database Error
  Invalid project ID 'YOUR_GCP_PROJECT_ID_HERE'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
[0m14:59:43.012204 [debug] [MainThread]: Command `dbt run` failed at 14:59:43.012204 after 23.00 seconds
[0m14:59:43.012204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276AC238310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276A5AF4810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276AC31E810>]}
[0m14:59:43.012204 [debug] [MainThread]: Flushing usage events
[0m14:59:43.478844 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:59:46.355059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001474B5C96D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001474B37E750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001474B5CAF90>]}


============================== 14:59:46.363937 | 2039982f-a4c5-402e-966c-1bdc8f89cef1 ==============================
[0m14:59:46.363937 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:59:46.363937 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt'}
[0m14:59:51.364341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2039982f-a4c5-402e-966c-1bdc8f89cef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001474B626DD0>]}
[0m14:59:51.568159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2039982f-a4c5-402e-966c-1bdc8f89cef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014747F97810>]}
[0m14:59:51.568159 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m14:59:53.010153 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m15:00:58.252751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021472059690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002147205A950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021472059390>]}


============================== 15:00:58.256896 | 73dac9a0-da04-44fc-bff2-898b6f3d4da0 ==============================
[0m15:00:58.256896 [info ] [MainThread]: Running with dbt=1.10.11
[0m15:00:58.258661 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'log_path': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt'}
[0m15:01:04.161632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73dac9a0-da04-44fc-bff2-898b6f3d4da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002141F497850>]}
[0m15:01:04.301793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73dac9a0-da04-44fc-bff2-898b6f3d4da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002146EA25E50>]}
[0m15:01:04.301793 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m15:01:06.270221 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m15:01:06.520362 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m15:01:06.536083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '73dac9a0-da04-44fc-bff2-898b6f3d4da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021471079110>]}
[0m15:01:09.483198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73dac9a0-da04-44fc-bff2-898b6f3d4da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002141FC30510>]}
[0m15:01:09.693483 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m15:01:09.701330 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m15:01:09.760426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73dac9a0-da04-44fc-bff2-898b6f3d4da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002141FDD0710>]}
[0m15:01:09.762440 [info ] [MainThread]: Found 7 models, 5 data tests, 495 macros
[0m15:01:09.762440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73dac9a0-da04-44fc-bff2-898b6f3d4da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002141FD931D0>]}
[0m15:01:09.762440 [info ] [MainThread]: 
[0m15:01:09.762440 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m15:01:09.762440 [info ] [MainThread]: 
[0m15:01:09.772202 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:01:09.780244 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0'
[0m15:01:09.780244 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0'
[0m15:01:09.780244 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:09.780244 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:11.101222 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics'
[0m15:01:11.101222 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:11.101222 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg'
[0m15:01:11.194457 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:11.890240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73dac9a0-da04-44fc-bff2-898b6f3d4da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002141FC59350>]}
[0m15:01:11.891565 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:01:11.910958 [debug] [Thread-1 (]: Began running node model.youtube_analytics.stg_youtube_channels
[0m15:01:11.910958 [debug] [Thread-2 (]: Began running node model.youtube_analytics.stg_youtube_video_ids
[0m15:01:11.910958 [debug] [Thread-3 (]: Began running node model.youtube_analytics.stg_youtube_video_stats
[0m15:01:11.910958 [info ] [Thread-1 (]: 1 of 7 START sql view model youtube_stg_youtube_stg.stg_youtube_channels ....... [RUN]
[0m15:01:11.910958 [info ] [Thread-2 (]: 2 of 7 START sql view model youtube_stg_youtube_stg.stg_youtube_video_ids ...... [RUN]
[0m15:01:11.910958 [info ] [Thread-3 (]: 3 of 7 START sql view model youtube_stg_youtube_stg.stg_youtube_video_stats .... [RUN]
[0m15:01:11.910958 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_channels'
[0m15:01:11.910958 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_video_ids'
[0m15:01:11.910958 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_video_stats'
[0m15:01:11.926628 [debug] [Thread-1 (]: Began compiling node model.youtube_analytics.stg_youtube_channels
[0m15:01:11.926628 [debug] [Thread-2 (]: Began compiling node model.youtube_analytics.stg_youtube_video_ids
[0m15:01:11.926628 [debug] [Thread-3 (]: Began compiling node model.youtube_analytics.stg_youtube_video_stats
[0m15:01:11.942285 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_channels"
[0m15:01:11.948683 [debug] [Thread-2 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_video_ids"
[0m15:01:11.950692 [debug] [Thread-3 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_video_stats"
[0m15:01:11.950692 [debug] [Thread-2 (]: Began executing node model.youtube_analytics.stg_youtube_video_ids
[0m15:01:11.958074 [debug] [Thread-1 (]: Began executing node model.youtube_analytics.stg_youtube_channels
[0m15:01:11.958074 [debug] [Thread-3 (]: Began executing node model.youtube_analytics.stg_youtube_video_stats
[0m15:01:12.020684 [debug] [Thread-2 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_video_ids"
[0m15:01:12.036486 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_channels"
[0m15:01:12.041450 [debug] [Thread-3 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_video_stats"
[0m15:01:12.043464 [debug] [Thread-2 (]: On model.youtube_analytics.stg_youtube_video_ids: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_video_ids"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_ids`
  OPTIONS()
  as select
  videoId              as video_id,
  channelId            as channel_id,
  date(_partitiontime) as load_date
from `orbital-nuance-471817-n0.youtube_raw.video_ids_raw`;


[0m15:01:12.046411 [debug] [Thread-1 (]: On model.youtube_analytics.stg_youtube_channels: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_channels"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_channels`
  OPTIONS()
  as with src as (
  select
    id                                        as channel_id,
    snippet.title                             as channel_title,
    snippet.country                           as channel_country,
    snippet.publishedAt                       as channel_published_at,
    cast(statistics.viewCount       as int64) as channel_view_count,
    cast(statistics.subscriberCount as int64) as channel_subscribers,
    cast(statistics.videoCount      as int64) as channel_video_count,
    date(_partitiontime)                      as load_date
  from `orbital-nuance-471817-n0.youtube_raw.channels_raw`
)
select * from src;


[0m15:01:12.046411 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:01:12.046411 [debug] [Thread-3 (]: On model.youtube_analytics.stg_youtube_video_stats: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_video_stats"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
  OPTIONS()
  as with src as (
  select
    id                                     as video_id,
    snippet.channelId                      as channel_id,
    snippet.title                          as video_title,
    snippet.publishedAt                    as video_published_at,
    cast(statistics.viewCount    as int64) as views,
    cast(statistics.likeCount    as int64) as likes,
    cast(statistics.commentCount as int64) as comments,
    contentDetails.duration                as duration_iso,
    current_date()                         as load_date
  from `orbital-nuance-471817-n0.youtube_raw.video_stats_raw`
),
parsed as (
  select
    *,
    (
      coalesce(SAFE_CAST(REGEXP_EXTRACT(duration_iso, r'(\d+)H') AS INT64), 0) * 3600
      + coalesce(SAFE_CAST(REGEXP_EXTRACT(duration_iso, r'(\d+)M') AS INT64), 0) * 60
      + coalesce(SAFE_CAST(REGEXP_EXTRACT(duration_iso, r'(\d+)S') AS INT64), 0)
    ) as duration_seconds
  from src
)
select * from parsed;


[0m15:01:12.052303 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:01:12.052303 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:01:12.909772 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:c412c1c1-e62f-40fb-b76b-a1fbd9e4b110&page=queryresults
[0m15:01:12.943948 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:6ee83a71-4d01-4ceb-b473-1d70aadcb538&page=queryresults
[0m15:01:12.965872 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:93141a40-e5ec-4407-aa24-05b616c35d43&page=queryresults
[0m15:01:17.639315 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73dac9a0-da04-44fc-bff2-898b6f3d4da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002141FD13F10>]}
[0m15:01:17.639315 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73dac9a0-da04-44fc-bff2-898b6f3d4da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002141F533310>]}
[0m15:01:17.639315 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73dac9a0-da04-44fc-bff2-898b6f3d4da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002142035C250>]}
[0m15:01:17.644655 [info ] [Thread-3 (]: 3 of 7 OK created sql view model youtube_stg_youtube_stg.stg_youtube_video_stats  [[32mCREATE VIEW (0 processed)[0m in 5.70s]
[0m15:01:17.645712 [info ] [Thread-2 (]: 2 of 7 OK created sql view model youtube_stg_youtube_stg.stg_youtube_video_ids . [[32mCREATE VIEW (0 processed)[0m in 5.72s]
[0m15:01:17.646690 [debug] [Thread-3 (]: Finished running node model.youtube_analytics.stg_youtube_video_stats
[0m15:01:17.646690 [info ] [Thread-1 (]: 1 of 7 OK created sql view model youtube_stg_youtube_stg.stg_youtube_channels .. [[32mCREATE VIEW (0 processed)[0m in 5.73s]
[0m15:01:17.646690 [debug] [Thread-2 (]: Finished running node model.youtube_analytics.stg_youtube_video_ids
[0m15:01:17.646690 [debug] [Thread-4 (]: Began running node model.youtube_analytics.fct_video_daily_metrics
[0m15:01:17.646690 [debug] [Thread-3 (]: Began running node model.youtube_analytics.video_latest_snapshot
[0m15:01:17.646690 [debug] [Thread-1 (]: Finished running node model.youtube_analytics.stg_youtube_channels
[0m15:01:17.646690 [info ] [Thread-4 (]: 4 of 7 START sql incremental model youtube_stg_youtube_analytics.fct_video_daily_metrics  [RUN]
[0m15:01:17.646690 [info ] [Thread-3 (]: 5 of 7 START sql view model youtube_stg_youtube_analytics.video_latest_snapshot  [RUN]
[0m15:01:17.661422 [debug] [Thread-2 (]: Began running node model.youtube_analytics.dim_channel
[0m15:01:17.661422 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.youtube_analytics.fct_video_daily_metrics'
[0m15:01:17.661422 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.youtube_analytics.stg_youtube_video_stats, now model.youtube_analytics.video_latest_snapshot)
[0m15:01:17.661422 [info ] [Thread-2 (]: 6 of 7 START sql view model youtube_stg_youtube_analytics.dim_channel .......... [RUN]
[0m15:01:17.661422 [debug] [Thread-4 (]: Began compiling node model.youtube_analytics.fct_video_daily_metrics
[0m15:01:17.661422 [debug] [Thread-3 (]: Began compiling node model.youtube_analytics.video_latest_snapshot
[0m15:01:17.661422 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.youtube_analytics.stg_youtube_video_ids, now model.youtube_analytics.dim_channel)
[0m15:01:17.685286 [debug] [Thread-4 (]: Writing injected SQL for node "model.youtube_analytics.fct_video_daily_metrics"
[0m15:01:17.694641 [debug] [Thread-3 (]: Writing injected SQL for node "model.youtube_analytics.video_latest_snapshot"
[0m15:01:17.696717 [debug] [Thread-2 (]: Began compiling node model.youtube_analytics.dim_channel
[0m15:01:17.698702 [debug] [Thread-4 (]: Began executing node model.youtube_analytics.fct_video_daily_metrics
[0m15:01:17.704808 [debug] [Thread-2 (]: Writing injected SQL for node "model.youtube_analytics.dim_channel"
[0m15:01:17.706699 [debug] [Thread-3 (]: Began executing node model.youtube_analytics.video_latest_snapshot
[0m15:01:17.771624 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:01:17.787474 [debug] [Thread-3 (]: Writing runtime sql for node "model.youtube_analytics.video_latest_snapshot"
[0m15:01:17.787474 [debug] [Thread-2 (]: Began executing node model.youtube_analytics.dim_channel
[0m15:01:17.864273 [debug] [Thread-3 (]: On model.youtube_analytics.video_latest_snapshot: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.video_latest_snapshot"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`video_latest_snapshot`
  OPTIONS()
  as 

with ranked as (
  select
    s.video_id,
    s.channel_id,
    s.video_title,
    s.video_published_at,
    s.views,
    s.likes,
    s.comments,
    s.duration_seconds,
    s.load_date,
    row_number() over (partition by s.video_id order by s.load_date desc) as rn
  from `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats` s
)
select
  r.video_id,
  r.channel_id,
  r.video_title,
  r.video_published_at,
  r.views,
  r.likes,
  r.comments,
  r.duration_seconds,
  r.load_date as snapshot_date
from ranked r
where rn = 1;


[0m15:01:17.868364 [debug] [Thread-2 (]: Writing runtime sql for node "model.youtube_analytics.dim_channel"
[0m15:01:17.868364 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:01:17.868364 [debug] [Thread-2 (]: On model.youtube_analytics.dim_channel: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.dim_channel"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`dim_channel`
  OPTIONS()
  as 

with ranked as (
  select
    channel_id,
    channel_title,
    channel_country,
    channel_published_at,
    channel_view_count,
    channel_subscribers,
    channel_video_count,
    load_date,
    row_number() over (partition by channel_id order by load_date desc) as rn
  from `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_channels`
)
select
  channel_id,
  channel_title,
  channel_country,
  channel_published_at,
  channel_view_count,
  channel_subscribers,
  channel_video_count,
  load_date as snapshot_date
from ranked
where rn = 1;


[0m15:01:17.952870 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:01:18.690015 [debug] [Thread-4 (]: Writing runtime sql for node "model.youtube_analytics.fct_video_daily_metrics"
[0m15:01:18.691954 [debug] [Thread-4 (]: On model.youtube_analytics.fct_video_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.fct_video_daily_metrics"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics` as DBT_INTERNAL_DEST
        using (

-- Pull from the staging model's flattened columns
with src as (
  select
    video_id,
    channel_id,
    load_date,
    views,
    likes,
    comments
  from `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
  
    -- Reprocess yesterday + today so lag() boundaries stay correct
    where load_date >= (
      select date_sub(coalesce(max(load_date), date '1900-01-01'), interval 1 day)
      from `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
    )
  
),

with_lag as (
  select
    *,
    lag(views)    over (partition by video_id order by load_date) as prev_views,
    lag(likes)    over (partition by video_id order by load_date) as prev_likes,
    lag(comments) over (partition by video_id order by load_date) as prev_comments
  from src
)

select
  video_id,
  channel_id,
  load_date,
  views,
  likes,
  comments,
  views    - coalesce(prev_views, 0)    as daily_views,
  likes    - coalesce(prev_likes, 0)    as daily_likes,
  comments - coalesce(prev_comments, 0) as daily_comments
from with_lag
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.video_id = DBT_INTERNAL_DEST.video_id
                ) and (
                    DBT_INTERNAL_SOURCE.load_date = DBT_INTERNAL_DEST.load_date
                )

    
    when matched then update set
        `video_id` = DBT_INTERNAL_SOURCE.`video_id`,`channel_id` = DBT_INTERNAL_SOURCE.`channel_id`,`load_date` = DBT_INTERNAL_SOURCE.`load_date`,`views` = DBT_INTERNAL_SOURCE.`views`,`likes` = DBT_INTERNAL_SOURCE.`likes`,`comments` = DBT_INTERNAL_SOURCE.`comments`,`daily_views` = DBT_INTERNAL_SOURCE.`daily_views`,`daily_likes` = DBT_INTERNAL_SOURCE.`daily_likes`,`daily_comments` = DBT_INTERNAL_SOURCE.`daily_comments`
    

    when not matched then insert
        (`video_id`, `channel_id`, `load_date`, `views`, `likes`, `comments`, `daily_views`, `daily_likes`, `daily_comments`)
    values
        (`video_id`, `channel_id`, `load_date`, `views`, `likes`, `comments`, `daily_views`, `daily_likes`, `daily_comments`)


    
[0m15:01:18.959993 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:f7aeea33-4764-499c-800a-7ccf77742cd1&page=queryresults
[0m15:01:18.959993 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:5e27043c-143c-45d0-b839-32ec0d871d66&page=queryresults
[0m15:01:19.420005 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:2a0bb369-46a3-4bfa-b4b1-d1a6c8977c02&page=queryresults
[0m15:01:19.567672 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73dac9a0-da04-44fc-bff2-898b6f3d4da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002141FF22810>]}
[0m15:01:19.567672 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73dac9a0-da04-44fc-bff2-898b6f3d4da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021421666F10>]}
[0m15:01:19.567672 [info ] [Thread-3 (]: 5 of 7 OK created sql view model youtube_stg_youtube_analytics.video_latest_snapshot  [[32mCREATE VIEW (0 processed)[0m in 1.91s]
[0m15:01:19.567672 [debug] [Thread-3 (]: Finished running node model.youtube_analytics.video_latest_snapshot
[0m15:01:19.567672 [info ] [Thread-2 (]: 6 of 7 OK created sql view model youtube_stg_youtube_analytics.dim_channel ..... [[32mCREATE VIEW (0 processed)[0m in 1.91s]
[0m15:01:19.567672 [debug] [Thread-2 (]: Finished running node model.youtube_analytics.dim_channel
[0m15:01:22.427071 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73dac9a0-da04-44fc-bff2-898b6f3d4da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002141FF5D610>]}
[0m15:01:22.427071 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model youtube_stg_youtube_analytics.fct_video_daily_metrics  [[32mMERGE (20.0 rows, 1.4 KiB processed)[0m in 4.77s]
[0m15:01:22.427071 [debug] [Thread-4 (]: Finished running node model.youtube_analytics.fct_video_daily_metrics
[0m15:01:22.427071 [debug] [Thread-1 (]: Began running node model.youtube_analytics.agg_channel_trends_7d
[0m15:01:22.427071 [info ] [Thread-1 (]: 7 of 7 START sql view model youtube_stg_youtube_analytics.agg_channel_trends_7d  [RUN]
[0m15:01:22.427071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.youtube_analytics.stg_youtube_channels, now model.youtube_analytics.agg_channel_trends_7d)
[0m15:01:22.434074 [debug] [Thread-1 (]: Began compiling node model.youtube_analytics.agg_channel_trends_7d
[0m15:01:22.442844 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_analytics.agg_channel_trends_7d"
[0m15:01:22.444253 [debug] [Thread-1 (]: Began executing node model.youtube_analytics.agg_channel_trends_7d
[0m15:01:22.444253 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_analytics.agg_channel_trends_7d"
[0m15:01:22.450973 [debug] [Thread-1 (]: On model.youtube_analytics.agg_channel_trends_7d: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.agg_channel_trends_7d"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`agg_channel_trends_7d`
  OPTIONS()
  as 

with daily as (
  select
    channel_id,
    video_id,
    load_date,
    daily_views,
    daily_likes,
    daily_comments
  from `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
),
rollup_cte as (
  select
    channel_id,
    load_date,
    sum(daily_views)    over (
      partition by channel_id
      order by load_date
      rows between 6 preceding and current row
    ) as views_7d,
    sum(daily_likes)    over (
      partition by channel_id
      order by load_date
      rows between 6 preceding and current row
    ) as likes_7d,
    sum(daily_comments) over (
      partition by channel_id
      order by load_date
      rows between 6 preceding and current row
    ) as comments_7d
  from daily
)
select distinct channel_id, load_date, views_7d, likes_7d, comments_7d
from rollup_cte;


[0m15:01:22.450973 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:01:23.116671 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:54eb51d1-d771-4054-9424-b350e8489ef0&page=queryresults
[0m15:01:23.497333 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73dac9a0-da04-44fc-bff2-898b6f3d4da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002142178E990>]}
[0m15:01:23.497333 [info ] [Thread-1 (]: 7 of 7 OK created sql view model youtube_stg_youtube_analytics.agg_channel_trends_7d  [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m15:01:23.499575 [debug] [Thread-1 (]: Finished running node model.youtube_analytics.agg_channel_trends_7d
[0m15:01:23.501818 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:01:23.504948 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:01:23.504948 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0' was properly closed.
[0m15:01:23.504948 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0' was properly closed.
[0m15:01:23.504948 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics' was properly closed.
[0m15:01:23.504948 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg' was properly closed.
[0m15:01:23.504948 [debug] [MainThread]: Connection 'model.youtube_analytics.agg_channel_trends_7d' was properly closed.
[0m15:01:23.504948 [debug] [MainThread]: Connection 'model.youtube_analytics.dim_channel' was properly closed.
[0m15:01:23.504948 [debug] [MainThread]: Connection 'model.youtube_analytics.video_latest_snapshot' was properly closed.
[0m15:01:23.504948 [debug] [MainThread]: Connection 'model.youtube_analytics.fct_video_daily_metrics' was properly closed.
[0m15:01:23.504948 [info ] [MainThread]: 
[0m15:01:23.504948 [info ] [MainThread]: Finished running 1 incremental model, 6 view models in 0 hours 0 minutes and 13.73 seconds (13.73s).
[0m15:01:23.520661 [debug] [MainThread]: Command end result
[0m15:01:23.569028 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m15:01:23.585204 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m15:01:23.603635 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\run_results.json
[0m15:01:23.604633 [info ] [MainThread]: 
[0m15:01:23.606629 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:01:23.608535 [info ] [MainThread]: 
[0m15:01:23.609529 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m15:01:23.611980 [debug] [MainThread]: Command `dbt run` succeeded at 15:01:23.611980 after 25.43 seconds
[0m15:01:23.614048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214720E5CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214720E63D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021471D28490>]}
[0m15:01:23.614048 [debug] [MainThread]: Flushing usage events
[0m15:01:24.266415 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:01:27.172511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F255E9810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F25653FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F25653B90>]}


============================== 15:01:27.177285 | 05f44fa6-3b74-4179-a240-1930caff1a67 ==============================
[0m15:01:27.177285 [info ] [MainThread]: Running with dbt=1.10.11
[0m15:01:27.177285 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'log_path': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m15:01:32.055749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05f44fa6-3b74-4179-a240-1930caff1a67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F52489550>]}
[0m15:01:32.208915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05f44fa6-3b74-4179-a240-1930caff1a67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F21FB7890>]}
[0m15:01:32.208915 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m15:01:33.781145 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m15:01:34.255014 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:01:34.255014 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:01:34.365031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05f44fa6-3b74-4179-a240-1930caff1a67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F5298C950>]}
[0m15:01:34.541880 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m15:01:34.550895 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m15:01:34.629386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05f44fa6-3b74-4179-a240-1930caff1a67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F52C82350>]}
[0m15:01:34.629386 [info ] [MainThread]: Found 7 models, 5 data tests, 495 macros
[0m15:01:34.629386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05f44fa6-3b74-4179-a240-1930caff1a67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F52908650>]}
[0m15:01:34.640922 [info ] [MainThread]: 
[0m15:01:34.640922 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m15:01:34.640922 [info ] [MainThread]: 
[0m15:01:34.645416 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:01:34.661433 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg'
[0m15:01:34.661433 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics'
[0m15:01:34.661433 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:34.661433 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:35.326089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05f44fa6-3b74-4179-a240-1930caff1a67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F25604C50>]}
[0m15:01:35.328107 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:01:35.342922 [debug] [Thread-1 (]: Began running node test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267
[0m15:01:35.342922 [debug] [Thread-2 (]: Began running node test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1
[0m15:01:35.342922 [debug] [Thread-3 (]: Began running node test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7
[0m15:01:35.346038 [debug] [Thread-4 (]: Began running node test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602
[0m15:01:35.346038 [info ] [Thread-1 (]: 1 of 5 START test not_null_fct_video_daily_metrics_load_date ................... [RUN]
[0m15:01:35.349083 [info ] [Thread-2 (]: 2 of 5 START test not_null_fct_video_daily_metrics_video_id .................... [RUN]
[0m15:01:35.349083 [info ] [Thread-3 (]: 3 of 5 START test not_null_stg_youtube_video_stats_load_date ................... [RUN]
[0m15:01:35.349083 [info ] [Thread-4 (]: 4 of 5 START test not_null_stg_youtube_video_stats_video_id .................... [RUN]
[0m15:01:35.349083 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267'
[0m15:01:35.353742 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1'
[0m15:01:35.353742 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7'
[0m15:01:35.353742 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602'
[0m15:01:35.353742 [debug] [Thread-1 (]: Began compiling node test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267
[0m15:01:35.353742 [debug] [Thread-2 (]: Began compiling node test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1
[0m15:01:35.364320 [debug] [Thread-3 (]: Began compiling node test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7
[0m15:01:35.366329 [debug] [Thread-4 (]: Began compiling node test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602
[0m15:01:35.424401 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267"
[0m15:01:35.442408 [debug] [Thread-2 (]: Writing injected SQL for node "test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1"
[0m15:01:35.450675 [debug] [Thread-3 (]: Writing injected SQL for node "test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7"
[0m15:01:35.458531 [debug] [Thread-4 (]: Writing injected SQL for node "test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602"
[0m15:01:35.458531 [debug] [Thread-1 (]: Began executing node test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267
[0m15:01:35.458531 [debug] [Thread-2 (]: Began executing node test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1
[0m15:01:35.490422 [debug] [Thread-3 (]: Began executing node test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7
[0m15:01:35.506265 [debug] [Thread-4 (]: Began executing node test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602
[0m15:01:35.534817 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267"
[0m15:01:35.535814 [debug] [Thread-2 (]: Writing runtime sql for node "test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1"
[0m15:01:35.542213 [debug] [Thread-3 (]: Writing runtime sql for node "test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7"
[0m15:01:35.548210 [debug] [Thread-4 (]: Writing runtime sql for node "test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602"
[0m15:01:35.551110 [debug] [Thread-1 (]: On test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select load_date
from `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
where load_date is null



  
  
      
    ) dbt_internal_test
[0m15:01:35.552913 [debug] [Thread-2 (]: On test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select video_id
from `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
where video_id is null



  
  
      
    ) dbt_internal_test
[0m15:01:35.554312 [debug] [Thread-4 (]: On test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select video_id
from `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
where video_id is null



  
  
      
    ) dbt_internal_test
[0m15:01:35.559463 [debug] [Thread-3 (]: On test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select load_date
from `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
where load_date is null



  
  
      
    ) dbt_internal_test
[0m15:01:35.563585 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:01:35.566721 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:01:35.567721 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:01:35.571024 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:01:36.576304 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:e24db552-67a8-421c-b0ee-e53fcdd4ee35&page=queryresults
[0m15:01:36.667428 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:e8188bcd-c041-4af0-9804-fdf894bc81f1&page=queryresults
[0m15:01:36.696351 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:f7436f20-4d88-4346-8491-d4948517aa92&page=queryresults
[0m15:01:36.777772 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:780321b0-f692-4509-9530-eea5133bfc19&page=queryresults
[0m15:01:37.242006 [info ] [Thread-4 (]: 4 of 5 PASS not_null_stg_youtube_video_stats_video_id .......................... [[32mPASS[0m in 1.89s]
[0m15:01:37.242006 [debug] [Thread-4 (]: Finished running node test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602
[0m15:01:37.242006 [debug] [Thread-4 (]: Began running node test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e
[0m15:01:37.242006 [info ] [Thread-4 (]: 5 of 5 START test unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_  [RUN]
[0m15:01:37.242006 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602, now test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e)
[0m15:01:37.242006 [info ] [Thread-1 (]: 1 of 5 PASS not_null_fct_video_daily_metrics_load_date ......................... [[32mPASS[0m in 1.89s]
[0m15:01:37.257659 [debug] [Thread-4 (]: Began compiling node test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e
[0m15:01:37.257659 [debug] [Thread-1 (]: Finished running node test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267
[0m15:01:37.257659 [debug] [Thread-4 (]: Writing injected SQL for node "test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e"
[0m15:01:37.257659 [debug] [Thread-4 (]: Began executing node test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e
[0m15:01:37.257659 [debug] [Thread-4 (]: Writing runtime sql for node "test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e"
[0m15:01:37.257659 [info ] [Thread-2 (]: 2 of 5 PASS not_null_fct_video_daily_metrics_video_id .......................... [[32mPASS[0m in 1.90s]
[0m15:01:37.273743 [debug] [Thread-2 (]: Finished running node test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1
[0m15:01:37.275026 [debug] [Thread-4 (]: On test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select video_id || '-' || cast(load_date as string) as unique_field
  from `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
  where video_id || '-' || cast(load_date as string) is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:01:37.276030 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:01:37.395873 [info ] [Thread-3 (]: 3 of 5 PASS not_null_stg_youtube_video_stats_load_date ......................... [[32mPASS[0m in 2.04s]
[0m15:01:37.395873 [debug] [Thread-3 (]: Finished running node test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7
[0m15:01:38.151682 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:3d685b6a-f34d-428d-b2d3-d300b9278c26&page=queryresults
[0m15:01:38.722858 [info ] [Thread-4 (]: 5 of 5 PASS unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_ .. [[32mPASS[0m in 1.48s]
[0m15:01:38.722858 [debug] [Thread-4 (]: Finished running node test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e
[0m15:01:38.735084 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:01:38.738858 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:01:38.738858 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg' was properly closed.
[0m15:01:38.738858 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics' was properly closed.
[0m15:01:38.738858 [debug] [MainThread]: Connection 'test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267' was properly closed.
[0m15:01:38.738858 [debug] [MainThread]: Connection 'test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1' was properly closed.
[0m15:01:38.744832 [debug] [MainThread]: Connection 'test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7' was properly closed.
[0m15:01:38.744832 [debug] [MainThread]: Connection 'test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e' was properly closed.
[0m15:01:38.744832 [info ] [MainThread]: 
[0m15:01:38.744832 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 4.10 seconds (4.10s).
[0m15:01:38.754871 [debug] [MainThread]: Command end result
[0m15:01:38.817442 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m15:01:38.817442 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m15:01:38.843379 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\run_results.json
[0m15:01:38.843379 [info ] [MainThread]: 
[0m15:01:38.843379 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:01:38.843379 [info ] [MainThread]: 
[0m15:01:38.849309 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m15:01:38.849309 [debug] [MainThread]: Command `dbt test` succeeded at 15:01:38.849309 after 11.74 seconds
[0m15:01:38.849309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F25653ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F1E9DBC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F1E9DBBD0>]}
[0m15:01:38.849309 [debug] [MainThread]: Flushing usage events
[0m15:01:39.226182 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:18:02.601506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E2361E9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E2361E6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E2361E390>]}


============================== 15:18:02.601506 | 35cb1f20-92ec-404f-9159-206c943f64ba ==============================
[0m15:18:02.601506 [info ] [MainThread]: Running with dbt=1.10.11
[0m15:18:02.601506 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'log_cache_events': 'False', 'log_path': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt'}
[0m15:18:08.161403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35cb1f20-92ec-404f-9159-206c943f64ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E504D9A90>]}
[0m15:18:08.313360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35cb1f20-92ec-404f-9159-206c943f64ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E1FFE8750>]}
[0m15:18:08.313360 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m15:18:09.740068 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m15:18:10.093949 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:18:10.095958 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:18:10.160896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35cb1f20-92ec-404f-9159-206c943f64ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E50A2EBD0>]}
[0m15:18:10.317342 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m15:18:10.333503 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m15:18:10.405500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35cb1f20-92ec-404f-9159-206c943f64ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E504D8750>]}
[0m15:18:10.407516 [info ] [MainThread]: Found 7 models, 5 data tests, 495 macros
[0m15:18:10.407516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35cb1f20-92ec-404f-9159-206c943f64ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E50B70750>]}
[0m15:18:10.412473 [info ] [MainThread]: 
[0m15:18:10.412473 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m15:18:10.412473 [info ] [MainThread]: 
[0m15:18:10.412473 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:18:10.428582 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0'
[0m15:18:10.428582 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:10.428582 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0'
[0m15:18:10.490353 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:11.367020 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics'
[0m15:18:11.367020 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg'
[0m15:18:11.367020 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:11.367020 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:11.944110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35cb1f20-92ec-404f-9159-206c943f64ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E5049CCD0>]}
[0m15:18:11.944110 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:18:11.959952 [debug] [Thread-1 (]: Began running node model.youtube_analytics.stg_youtube_channels
[0m15:18:11.959952 [debug] [Thread-2 (]: Began running node model.youtube_analytics.stg_youtube_video_ids
[0m15:18:11.959952 [debug] [Thread-3 (]: Began running node model.youtube_analytics.stg_youtube_video_stats
[0m15:18:11.965975 [info ] [Thread-1 (]: 1 of 7 START sql view model youtube_stg_youtube_stg.stg_youtube_channels ....... [RUN]
[0m15:18:11.965975 [info ] [Thread-2 (]: 2 of 7 START sql view model youtube_stg_youtube_stg.stg_youtube_video_ids ...... [RUN]
[0m15:18:11.965975 [info ] [Thread-3 (]: 3 of 7 START sql view model youtube_stg_youtube_stg.stg_youtube_video_stats .... [RUN]
[0m15:18:11.965975 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_channels'
[0m15:18:11.971254 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_video_ids'
[0m15:18:11.971254 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_video_stats'
[0m15:18:11.971254 [debug] [Thread-1 (]: Began compiling node model.youtube_analytics.stg_youtube_channels
[0m15:18:11.975708 [debug] [Thread-2 (]: Began compiling node model.youtube_analytics.stg_youtube_video_ids
[0m15:18:11.975708 [debug] [Thread-3 (]: Began compiling node model.youtube_analytics.stg_youtube_video_stats
[0m15:18:11.991685 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_channels"
[0m15:18:11.996033 [debug] [Thread-2 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_video_ids"
[0m15:18:12.000928 [debug] [Thread-3 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_video_stats"
[0m15:18:12.003686 [debug] [Thread-1 (]: Began executing node model.youtube_analytics.stg_youtube_channels
[0m15:18:12.004697 [debug] [Thread-2 (]: Began executing node model.youtube_analytics.stg_youtube_video_ids
[0m15:18:12.096716 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_channels"
[0m15:18:12.099711 [debug] [Thread-2 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_video_ids"
[0m15:18:12.100592 [debug] [Thread-3 (]: Began executing node model.youtube_analytics.stg_youtube_video_stats
[0m15:18:12.113592 [debug] [Thread-3 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_video_stats"
[0m15:18:12.113592 [debug] [Thread-1 (]: On model.youtube_analytics.stg_youtube_channels: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_channels"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_channels`
  OPTIONS()
  as with src as (
  select
    id                                        as channel_id,
    snippet.title                             as channel_title,
    snippet.country                           as channel_country,
    snippet.publishedAt                       as channel_published_at,
    cast(statistics.viewCount       as int64) as channel_view_count,
    cast(statistics.subscriberCount as int64) as channel_subscribers,
    cast(statistics.videoCount      as int64) as channel_video_count,
    date(_partitiontime)                      as load_date
  from `orbital-nuance-471817-n0.youtube_raw.channels_raw`
)
select * from src;


[0m15:18:12.113592 [debug] [Thread-2 (]: On model.youtube_analytics.stg_youtube_video_ids: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_video_ids"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_ids`
  OPTIONS()
  as select
  videoId              as video_id,
  channelId            as channel_id,
  date(_partitiontime) as load_date
from `orbital-nuance-471817-n0.youtube_raw.video_ids_raw`;


[0m15:18:12.113592 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:18:12.113592 [debug] [Thread-3 (]: On model.youtube_analytics.stg_youtube_video_stats: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_video_stats"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
  OPTIONS()
  as with src as (
  select
    id                                     as video_id,
    snippet.channelId                      as channel_id,
    snippet.title                          as video_title,
    snippet.publishedAt                    as video_published_at,
    cast(statistics.viewCount    as int64) as views,
    cast(statistics.likeCount    as int64) as likes,
    cast(statistics.commentCount as int64) as comments,
    contentDetails.duration                as duration_iso,
    current_date()                         as load_date
  from `orbital-nuance-471817-n0.youtube_raw.video_stats_raw`
),
parsed as (
  select
    *,
    (
      coalesce(SAFE_CAST(REGEXP_EXTRACT(duration_iso, r'(\d+)H') AS INT64), 0) * 3600
      + coalesce(SAFE_CAST(REGEXP_EXTRACT(duration_iso, r'(\d+)M') AS INT64), 0) * 60
      + coalesce(SAFE_CAST(REGEXP_EXTRACT(duration_iso, r'(\d+)S') AS INT64), 0)
    ) as duration_seconds
  from src
)
select * from parsed;


[0m15:18:12.113592 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:18:12.126246 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:18:12.895990 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:b47c995f-3149-4449-8702-1fc2d3bc2e4f&page=queryresults
[0m15:18:13.077243 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:4e21b1e1-3a13-4b28-b721-edc97b4d1f01&page=queryresults
[0m15:18:13.081134 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:a79ac2c5-fccd-4f0c-90c9-8f1a525280f6&page=queryresults
[0m15:18:13.414678 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35cb1f20-92ec-404f-9159-206c943f64ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E50385A50>]}
[0m15:18:13.415732 [info ] [Thread-1 (]: 1 of 7 OK created sql view model youtube_stg_youtube_stg.stg_youtube_channels .. [[32mCREATE VIEW (0 processed)[0m in 1.44s]
[0m15:18:13.417913 [debug] [Thread-1 (]: Finished running node model.youtube_analytics.stg_youtube_channels
[0m15:18:13.420145 [debug] [Thread-4 (]: Began running node model.youtube_analytics.dim_channel
[0m15:18:13.422137 [info ] [Thread-4 (]: 4 of 7 START sql view model youtube_stg_youtube_analytics.dim_channel .......... [RUN]
[0m15:18:13.424136 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.youtube_analytics.dim_channel'
[0m15:18:13.425246 [debug] [Thread-4 (]: Began compiling node model.youtube_analytics.dim_channel
[0m15:18:13.432924 [debug] [Thread-4 (]: Writing injected SQL for node "model.youtube_analytics.dim_channel"
[0m15:18:13.435651 [debug] [Thread-4 (]: Began executing node model.youtube_analytics.dim_channel
[0m15:18:13.443439 [debug] [Thread-4 (]: Writing runtime sql for node "model.youtube_analytics.dim_channel"
[0m15:18:13.443439 [debug] [Thread-4 (]: On model.youtube_analytics.dim_channel: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.dim_channel"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`dim_channel`
  OPTIONS()
  as 

with ranked as (
  select
    channel_id,
    channel_title,
    channel_country,
    channel_published_at,
    channel_view_count,
    channel_subscribers,
    channel_video_count,
    load_date,
    row_number() over (partition by channel_id order by load_date desc) as rn
  from `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_channels`
)
select
  channel_id,
  channel_title,
  channel_country,
  channel_published_at,
  channel_view_count,
  channel_subscribers,
  channel_video_count,
  load_date as snapshot_date
from ranked
where rn = 1;


[0m15:18:13.443439 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:18:13.525671 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35cb1f20-92ec-404f-9159-206c943f64ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E50B9AAD0>]}
[0m15:18:13.526580 [info ] [Thread-2 (]: 2 of 7 OK created sql view model youtube_stg_youtube_stg.stg_youtube_video_ids . [[32mCREATE VIEW (0 processed)[0m in 1.55s]
[0m15:18:13.529581 [debug] [Thread-2 (]: Finished running node model.youtube_analytics.stg_youtube_video_ids
[0m15:18:13.694528 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35cb1f20-92ec-404f-9159-206c943f64ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E50C5EE90>]}
[0m15:18:13.694528 [info ] [Thread-3 (]: 3 of 7 OK created sql view model youtube_stg_youtube_stg.stg_youtube_video_stats  [[32mCREATE VIEW (0 processed)[0m in 1.72s]
[0m15:18:13.694528 [debug] [Thread-3 (]: Finished running node model.youtube_analytics.stg_youtube_video_stats
[0m15:18:13.694528 [debug] [Thread-1 (]: Began running node model.youtube_analytics.fct_video_daily_metrics
[0m15:18:13.694528 [debug] [Thread-2 (]: Began running node model.youtube_analytics.video_latest_snapshot
[0m15:18:13.694528 [info ] [Thread-1 (]: 5 of 7 START sql incremental model youtube_stg_youtube_analytics.fct_video_daily_metrics  [RUN]
[0m15:18:13.694528 [info ] [Thread-2 (]: 6 of 7 START sql view model youtube_stg_youtube_analytics.video_latest_snapshot  [RUN]
[0m15:18:13.710338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.youtube_analytics.stg_youtube_channels, now model.youtube_analytics.fct_video_daily_metrics)
[0m15:18:13.710338 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.youtube_analytics.stg_youtube_video_ids, now model.youtube_analytics.video_latest_snapshot)
[0m15:18:13.710338 [debug] [Thread-1 (]: Began compiling node model.youtube_analytics.fct_video_daily_metrics
[0m15:18:13.710338 [debug] [Thread-2 (]: Began compiling node model.youtube_analytics.video_latest_snapshot
[0m15:18:13.726307 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_analytics.fct_video_daily_metrics"
[0m15:18:13.737335 [debug] [Thread-2 (]: Writing injected SQL for node "model.youtube_analytics.video_latest_snapshot"
[0m15:18:13.743851 [debug] [Thread-1 (]: Began executing node model.youtube_analytics.fct_video_daily_metrics
[0m15:18:13.771175 [debug] [Thread-2 (]: Began executing node model.youtube_analytics.video_latest_snapshot
[0m15:18:13.826218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:13.832262 [debug] [Thread-2 (]: Writing runtime sql for node "model.youtube_analytics.video_latest_snapshot"
[0m15:18:13.896245 [debug] [Thread-2 (]: On model.youtube_analytics.video_latest_snapshot: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.video_latest_snapshot"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`video_latest_snapshot`
  OPTIONS()
  as 

with ranked as (
  select
    s.video_id,
    s.channel_id,
    s.video_title,
    s.video_published_at,
    s.views,
    s.likes,
    s.comments,
    s.duration_seconds,
    s.load_date,
    row_number() over (partition by s.video_id order by s.load_date desc) as rn
  from `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats` s
)
select
  r.video_id,
  r.channel_id,
  r.video_title,
  r.video_published_at,
  r.views,
  r.likes,
  r.comments,
  r.duration_seconds,
  r.load_date as snapshot_date
from ranked r
where rn = 1;


[0m15:18:13.901772 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:18:14.240500 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:19873862-d703-4bf6-94b2-7d9a083a3444&page=queryresults
[0m15:18:14.364589 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_analytics.fct_video_daily_metrics"
[0m15:18:14.380307 [debug] [Thread-1 (]: On model.youtube_analytics.fct_video_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.fct_video_daily_metrics"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics` as DBT_INTERNAL_DEST
        using (

-- Pull from the staging model's flattened columns
with src as (
  select
    video_id,
    channel_id,
    load_date,
    views,
    likes,
    comments
  from `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
  
    -- Reprocess yesterday + today so lag() boundaries stay correct
    where load_date >= (
      select date_sub(coalesce(max(load_date), date '1900-01-01'), interval 1 day)
      from `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
    )
  
),

with_lag as (
  select
    *,
    lag(views)    over (partition by video_id order by load_date) as prev_views,
    lag(likes)    over (partition by video_id order by load_date) as prev_likes,
    lag(comments) over (partition by video_id order by load_date) as prev_comments
  from src
)

select
  video_id,
  channel_id,
  load_date,
  views,
  likes,
  comments,
  views    - coalesce(prev_views, 0)    as daily_views,
  likes    - coalesce(prev_likes, 0)    as daily_likes,
  comments - coalesce(prev_comments, 0) as daily_comments
from with_lag
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.video_id = DBT_INTERNAL_DEST.video_id
                ) and (
                    DBT_INTERNAL_SOURCE.load_date = DBT_INTERNAL_DEST.load_date
                )

    
    when matched then update set
        `video_id` = DBT_INTERNAL_SOURCE.`video_id`,`channel_id` = DBT_INTERNAL_SOURCE.`channel_id`,`load_date` = DBT_INTERNAL_SOURCE.`load_date`,`views` = DBT_INTERNAL_SOURCE.`views`,`likes` = DBT_INTERNAL_SOURCE.`likes`,`comments` = DBT_INTERNAL_SOURCE.`comments`,`daily_views` = DBT_INTERNAL_SOURCE.`daily_views`,`daily_likes` = DBT_INTERNAL_SOURCE.`daily_likes`,`daily_comments` = DBT_INTERNAL_SOURCE.`daily_comments`
    

    when not matched then insert
        (`video_id`, `channel_id`, `load_date`, `views`, `likes`, `comments`, `daily_views`, `daily_likes`, `daily_comments`)
    values
        (`video_id`, `channel_id`, `load_date`, `views`, `likes`, `comments`, `daily_views`, `daily_likes`, `daily_comments`)


    
[0m15:18:14.720733 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35cb1f20-92ec-404f-9159-206c943f64ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E50C8CFD0>]}
[0m15:18:14.721735 [info ] [Thread-4 (]: 4 of 7 OK created sql view model youtube_stg_youtube_analytics.dim_channel ..... [[32mCREATE VIEW (0 processed)[0m in 1.30s]
[0m15:18:14.722739 [debug] [Thread-4 (]: Finished running node model.youtube_analytics.dim_channel
[0m15:18:14.754956 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:3f752545-c44e-4209-a480-5e23df607848&page=queryresults
[0m15:18:15.142985 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:499b3431-9623-4f9b-b117-5757dad9753e&page=queryresults
[0m15:18:15.149482 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35cb1f20-92ec-404f-9159-206c943f64ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E5142F150>]}
[0m15:18:15.151877 [info ] [Thread-2 (]: 6 of 7 OK created sql view model youtube_stg_youtube_analytics.video_latest_snapshot  [[32mCREATE VIEW (0 processed)[0m in 1.44s]
[0m15:18:15.151877 [debug] [Thread-2 (]: Finished running node model.youtube_analytics.video_latest_snapshot
[0m15:18:15.990146 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:499b3431-9623-4f9b-b117-5757dad9753e&page=queryresults
[0m15:18:16.099076 [debug] [Thread-1 (]: Database Error in model fct_video_daily_metrics (dbt/models\marts\fct_video_daily_metrics.sql)
  UPDATE/MERGE must match at most one source row for each target row
  compiled code at target\run\youtube_analytics\dbt/models\marts\fct_video_daily_metrics.sql
[0m15:18:16.099076 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35cb1f20-92ec-404f-9159-206c943f64ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E51304E10>]}
[0m15:18:16.099076 [error] [Thread-1 (]: 5 of 7 ERROR creating sql incremental model youtube_stg_youtube_analytics.fct_video_daily_metrics  [[31mERROR[0m in 2.39s]
[0m15:18:16.099076 [debug] [Thread-1 (]: Finished running node model.youtube_analytics.fct_video_daily_metrics
[0m15:18:16.099076 [debug] [Thread-7 (]: Marking all children of 'model.youtube_analytics.fct_video_daily_metrics' to be skipped because of status 'error'.  Reason: Database Error in model fct_video_daily_metrics (dbt/models\marts\fct_video_daily_metrics.sql)
  UPDATE/MERGE must match at most one source row for each target row
  compiled code at target\run\youtube_analytics\dbt/models\marts\fct_video_daily_metrics.sql.
[0m15:18:16.104992 [debug] [Thread-3 (]: Began running node model.youtube_analytics.agg_channel_trends_7d
[0m15:18:16.107243 [info ] [Thread-3 (]: 7 of 7 SKIP relation youtube_stg_youtube_analytics.agg_channel_trends_7d ....... [[33mSKIP[0m]
[0m15:18:16.107748 [debug] [Thread-3 (]: Finished running node model.youtube_analytics.agg_channel_trends_7d
[0m15:18:16.107748 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:18:16.114712 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:18:16.114712 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0' was properly closed.
[0m15:18:16.114712 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0' was properly closed.
[0m15:18:16.114712 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics' was properly closed.
[0m15:18:16.114712 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg' was properly closed.
[0m15:18:16.114712 [debug] [MainThread]: Connection 'model.youtube_analytics.fct_video_daily_metrics' was properly closed.
[0m15:18:16.114712 [debug] [MainThread]: Connection 'model.youtube_analytics.video_latest_snapshot' was properly closed.
[0m15:18:16.114712 [debug] [MainThread]: Connection 'model.youtube_analytics.stg_youtube_video_stats' was properly closed.
[0m15:18:16.114712 [debug] [MainThread]: Connection 'model.youtube_analytics.dim_channel' was properly closed.
[0m15:18:16.126282 [info ] [MainThread]: 
[0m15:18:16.126282 [info ] [MainThread]: Finished running 1 incremental model, 6 view models in 0 hours 0 minutes and 5.71 seconds (5.71s).
[0m15:18:16.130358 [debug] [MainThread]: Command end result
[0m15:18:16.192742 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m15:18:16.192742 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m15:18:16.208620 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\run_results.json
[0m15:18:16.208620 [info ] [MainThread]: 
[0m15:18:16.208620 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:18:16.208620 [info ] [MainThread]: 
[0m15:18:16.224328 [error] [MainThread]: [31mFailure in model fct_video_daily_metrics (dbt/models\marts\fct_video_daily_metrics.sql)[0m
[0m15:18:16.224328 [error] [MainThread]:   Database Error in model fct_video_daily_metrics (dbt/models\marts\fct_video_daily_metrics.sql)
  UPDATE/MERGE must match at most one source row for each target row
  compiled code at target\run\youtube_analytics\dbt/models\marts\fct_video_daily_metrics.sql
[0m15:18:16.224328 [info ] [MainThread]: 
[0m15:18:16.224328 [info ] [MainThread]:   compiled code at target\compiled\youtube_analytics\dbt/models\marts\fct_video_daily_metrics.sql
[0m15:18:16.224328 [info ] [MainThread]: 
[0m15:18:16.224328 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=7
[0m15:18:16.236684 [debug] [MainThread]: Command `dbt run` failed at 15:18:16.236684 after 13.70 seconds
[0m15:18:16.236684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E2361D990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E2368D710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E2368F790>]}
[0m15:18:16.238698 [debug] [MainThread]: Flushing usage events
[0m15:18:16.851510 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:18:19.660020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A556E97750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A55AB8F190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A55AE199D0>]}


============================== 15:18:19.661055 | 701a4726-b450-42fe-b55a-77143a3f8e40 ==============================
[0m15:18:19.661055 [info ] [MainThread]: Running with dbt=1.10.11
[0m15:18:19.661055 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt'}
[0m15:18:24.346202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '701a4726-b450-42fe-b55a-77143a3f8e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A507C85810>]}
[0m15:18:24.473123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '701a4726-b450-42fe-b55a-77143a3f8e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A557799FD0>]}
[0m15:18:24.473123 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m15:18:25.785344 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m15:18:26.177020 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:18:26.177020 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:18:26.254720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '701a4726-b450-42fe-b55a-77143a3f8e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A508208890>]}
[0m15:18:26.430057 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m15:18:26.434825 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m15:18:26.523702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '701a4726-b450-42fe-b55a-77143a3f8e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A50817CE10>]}
[0m15:18:26.525885 [info ] [MainThread]: Found 7 models, 5 data tests, 495 macros
[0m15:18:26.526723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '701a4726-b450-42fe-b55a-77143a3f8e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5084F5E10>]}
[0m15:18:26.530401 [info ] [MainThread]: 
[0m15:18:26.532403 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m15:18:26.533527 [info ] [MainThread]: 
[0m15:18:26.535706 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:18:26.546601 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg'
[0m15:18:26.548606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:26.549601 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics'
[0m15:18:26.615260 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:27.150983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '701a4726-b450-42fe-b55a-77143a3f8e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5081ECCD0>]}
[0m15:18:27.150983 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:18:27.184832 [debug] [Thread-1 (]: Began running node test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267
[0m15:18:27.186813 [debug] [Thread-2 (]: Began running node test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1
[0m15:18:27.187831 [debug] [Thread-3 (]: Began running node test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7
[0m15:18:27.189833 [debug] [Thread-4 (]: Began running node test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602
[0m15:18:27.190830 [info ] [Thread-1 (]: 1 of 5 START test not_null_fct_video_daily_metrics_load_date ................... [RUN]
[0m15:18:27.193814 [info ] [Thread-2 (]: 2 of 5 START test not_null_fct_video_daily_metrics_video_id .................... [RUN]
[0m15:18:27.195832 [info ] [Thread-3 (]: 3 of 5 START test not_null_stg_youtube_video_stats_load_date ................... [RUN]
[0m15:18:27.198836 [info ] [Thread-4 (]: 4 of 5 START test not_null_stg_youtube_video_stats_video_id .................... [RUN]
[0m15:18:27.201829 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267'
[0m15:18:27.203831 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1'
[0m15:18:27.206832 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7'
[0m15:18:27.207831 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602'
[0m15:18:27.207831 [debug] [Thread-1 (]: Began compiling node test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267
[0m15:18:27.207831 [debug] [Thread-2 (]: Began compiling node test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1
[0m15:18:27.207831 [debug] [Thread-3 (]: Began compiling node test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7
[0m15:18:27.207831 [debug] [Thread-4 (]: Began compiling node test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602
[0m15:18:27.291425 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267"
[0m15:18:27.295296 [debug] [Thread-2 (]: Writing injected SQL for node "test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1"
[0m15:18:27.305564 [debug] [Thread-3 (]: Writing injected SQL for node "test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7"
[0m15:18:27.315729 [debug] [Thread-4 (]: Writing injected SQL for node "test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602"
[0m15:18:27.317939 [debug] [Thread-1 (]: Began executing node test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267
[0m15:18:27.317939 [debug] [Thread-2 (]: Began executing node test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1
[0m15:18:27.317939 [debug] [Thread-3 (]: Began executing node test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7
[0m15:18:27.333703 [debug] [Thread-4 (]: Began executing node test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602
[0m15:18:27.416695 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267"
[0m15:18:27.422700 [debug] [Thread-3 (]: Writing runtime sql for node "test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7"
[0m15:18:27.423552 [debug] [Thread-2 (]: Writing runtime sql for node "test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1"
[0m15:18:27.429995 [debug] [Thread-4 (]: Writing runtime sql for node "test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602"
[0m15:18:27.432205 [debug] [Thread-1 (]: On test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select load_date
from `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
where load_date is null



  
  
      
    ) dbt_internal_test
[0m15:18:27.434730 [debug] [Thread-3 (]: On test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select load_date
from `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
where load_date is null



  
  
      
    ) dbt_internal_test
[0m15:18:27.436730 [debug] [Thread-2 (]: On test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select video_id
from `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
where video_id is null



  
  
      
    ) dbt_internal_test
[0m15:18:27.438735 [debug] [Thread-4 (]: On test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select video_id
from `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
where video_id is null



  
  
      
    ) dbt_internal_test
[0m15:18:27.439732 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:18:27.440731 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:18:27.442263 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:18:27.442263 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:18:28.336705 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:bdd5d3d1-2e89-4584-955b-183f74a967f4&page=queryresults
[0m15:18:28.366446 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:7e40926f-be69-4c57-86ab-fd247ec1a145&page=queryresults
[0m15:18:28.415449 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:e9369c4a-ab8b-4d70-973a-815dd699485e&page=queryresults
[0m15:18:28.567336 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:10b5989c-88fa-4479-9066-c4612ed952d2&page=queryresults
[0m15:18:28.938925 [info ] [Thread-2 (]: 2 of 5 PASS not_null_fct_video_daily_metrics_video_id .......................... [[32mPASS[0m in 1.74s]
[0m15:18:28.944360 [debug] [Thread-2 (]: Finished running node test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1
[0m15:18:28.944360 [debug] [Thread-2 (]: Began running node test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e
[0m15:18:28.945746 [info ] [Thread-2 (]: 5 of 5 START test unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_  [RUN]
[0m15:18:28.945746 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1, now test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e)
[0m15:18:28.947044 [debug] [Thread-2 (]: Began compiling node test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e
[0m15:18:28.952258 [debug] [Thread-2 (]: Writing injected SQL for node "test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e"
[0m15:18:28.953157 [debug] [Thread-2 (]: Began executing node test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e
[0m15:18:28.954424 [debug] [Thread-2 (]: Writing runtime sql for node "test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e"
[0m15:18:28.955534 [debug] [Thread-2 (]: On test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select video_id || '-' || cast(load_date as string) as unique_field
  from `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
  where video_id || '-' || cast(load_date as string) is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:18:28.955534 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:18:29.005785 [info ] [Thread-3 (]: 3 of 5 PASS not_null_stg_youtube_video_stats_load_date ......................... [[32mPASS[0m in 1.80s]
[0m15:18:29.005785 [debug] [Thread-3 (]: Finished running node test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7
[0m15:18:29.013099 [info ] [Thread-1 (]: 1 of 5 PASS not_null_fct_video_daily_metrics_load_date ......................... [[32mPASS[0m in 1.81s]
[0m15:18:29.013099 [debug] [Thread-1 (]: Finished running node test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267
[0m15:18:29.209070 [info ] [Thread-4 (]: 4 of 5 PASS not_null_stg_youtube_video_stats_video_id .......................... [[32mPASS[0m in 2.00s]
[0m15:18:29.209070 [debug] [Thread-4 (]: Finished running node test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602
[0m15:18:29.670940 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:91778f29-cda8-40c3-9fc7-0775963fd72c&page=queryresults
[0m15:18:30.275308 [info ] [Thread-2 (]: 5 of 5 PASS unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_ .. [[32mPASS[0m in 1.33s]
[0m15:18:30.277317 [debug] [Thread-2 (]: Finished running node test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e
[0m15:18:30.277317 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:18:30.277317 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:18:30.285982 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg' was properly closed.
[0m15:18:30.285982 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics' was properly closed.
[0m15:18:30.285982 [debug] [MainThread]: Connection 'test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267' was properly closed.
[0m15:18:30.285982 [debug] [MainThread]: Connection 'test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e' was properly closed.
[0m15:18:30.285982 [debug] [MainThread]: Connection 'test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7' was properly closed.
[0m15:18:30.285982 [debug] [MainThread]: Connection 'test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602' was properly closed.
[0m15:18:30.285982 [info ] [MainThread]: 
[0m15:18:30.285982 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 3.75 seconds (3.75s).
[0m15:18:30.285982 [debug] [MainThread]: Command end result
[0m15:18:30.349776 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m15:18:30.349776 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m15:18:30.372468 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\run_results.json
[0m15:18:30.374445 [info ] [MainThread]: 
[0m15:18:30.375665 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:18:30.377799 [info ] [MainThread]: 
[0m15:18:30.379798 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m15:18:30.380242 [debug] [MainThread]: Command `dbt test` succeeded at 15:18:30.380242 after 10.78 seconds
[0m15:18:30.380242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A554341150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A554340D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A554340090>]}
[0m15:18:30.380242 [debug] [MainThread]: Flushing usage events
[0m15:18:30.794140 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:25:29.277707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F44F7D1350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F44F76E110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F44F77A010>]}


============================== 15:25:29.286088 | 1083a798-a7a1-4a90-8a6a-0c48c739e593 ==============================
[0m15:25:29.286088 [info ] [MainThread]: Running with dbt=1.10.11
[0m15:25:29.286088 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select fct_video_daily_metrics --full-refresh', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'log_path': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\logs', 'profiles_dir': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m15:25:34.504863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1083a798-a7a1-4a90-8a6a-0c48c739e593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F47C5D6290>]}
[0m15:25:34.679468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1083a798-a7a1-4a90-8a6a-0c48c739e593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F44C13C390>]}
[0m15:25:34.681360 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m15:25:36.380400 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m15:25:36.803699 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:25:36.803699 [debug] [MainThread]: Partial parsing: updated file: youtube_analytics://dbt/models\marts\fct_video_daily_metrics.sql
[0m15:25:37.786920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1083a798-a7a1-4a90-8a6a-0c48c739e593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F47CDCDFD0>]}
[0m15:25:37.954854 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m15:25:37.960728 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m15:25:38.020577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1083a798-a7a1-4a90-8a6a-0c48c739e593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F47CEFC890>]}
[0m15:25:38.020577 [info ] [MainThread]: Found 7 models, 5 data tests, 495 macros
[0m15:25:38.020577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1083a798-a7a1-4a90-8a6a-0c48c739e593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F47CD44310>]}
[0m15:25:38.033941 [info ] [MainThread]: 
[0m15:25:38.033941 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m15:25:38.036570 [info ] [MainThread]: 
[0m15:25:38.036570 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:25:38.036570 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0'
[0m15:25:38.036570 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:38.661431 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics'
[0m15:25:38.669249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:38.669249 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg'
[0m15:25:38.754519 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:39.272500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1083a798-a7a1-4a90-8a6a-0c48c739e593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F47CD5FB90>]}
[0m15:25:39.274603 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:25:39.285592 [debug] [Thread-1 (]: Began running node model.youtube_analytics.fct_video_daily_metrics
[0m15:25:39.285592 [info ] [Thread-1 (]: 1 of 1 START sql incremental model youtube_stg_youtube_analytics.fct_video_daily_metrics  [RUN]
[0m15:25:39.301381 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.youtube_analytics.fct_video_daily_metrics'
[0m15:25:39.301381 [debug] [Thread-1 (]: Began compiling node model.youtube_analytics.fct_video_daily_metrics
[0m15:25:39.326705 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_analytics.fct_video_daily_metrics"
[0m15:25:39.326705 [debug] [Thread-1 (]: Began executing node model.youtube_analytics.fct_video_daily_metrics
[0m15:25:39.411394 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:25:39.928360 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_analytics.fct_video_daily_metrics"
[0m15:25:39.929676 [debug] [Thread-1 (]: On model.youtube_analytics.fct_video_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.fct_video_daily_metrics"} */

  
    

    create or replace table `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
      
    partition by load_date
    cluster by channel_id, video_id

    
    OPTIONS()
    as (
      

-- 1) Read from staging and LIMIT to needed dates on incremental
with src_raw as (
  select
    video_id,
    channel_id,
    load_date,
    views,
    likes,
    comments
  from `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
  
),

-- 2) Deduplicate: keep one row per (video_id, load_date)
--    If there are multiple, take the MAX of counters (monotonic metrics).
src as (
  select
    video_id,
    any_value(channel_id) as channel_id,
    load_date,
    max(views)    as views,
    max(likes)    as likes,
    max(comments) as comments
  from src_raw
  group by video_id, load_date
),

with_lag as (
  select
    *,
    lag(views)    over (partition by video_id order by load_date) as prev_views,
    lag(likes)    over (partition by video_id order by load_date) as prev_likes,
    lag(comments) over (partition by video_id order by load_date) as prev_comments
  from src
)

select
  video_id,
  channel_id,
  load_date,
  views,
  likes,
  comments,
  views    - coalesce(prev_views, 0)    as daily_views,
  likes    - coalesce(prev_likes, 0)    as daily_likes,
  comments - coalesce(prev_comments, 0) as daily_comments
from with_lag
    );
  
[0m15:25:40.536787 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:6a830aef-ed80-404e-8291-03dd889ca4ee&page=queryresults
[0m15:25:43.537099 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1083a798-a7a1-4a90-8a6a-0c48c739e593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F47D0A1750>]}
[0m15:25:43.537099 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model youtube_stg_youtube_analytics.fct_video_daily_metrics  [[32mCREATE TABLE (20.0 rows, 3.7 KiB processed)[0m in 4.23s]
[0m15:25:43.539166 [debug] [Thread-1 (]: Finished running node model.youtube_analytics.fct_video_daily_metrics
[0m15:25:43.541456 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:25:43.546960 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:25:43.547962 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0' was properly closed.
[0m15:25:43.548918 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics' was properly closed.
[0m15:25:43.549892 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg' was properly closed.
[0m15:25:43.551228 [debug] [MainThread]: Connection 'model.youtube_analytics.fct_video_daily_metrics' was properly closed.
[0m15:25:43.552261 [info ] [MainThread]: 
[0m15:25:43.552261 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.52 seconds (5.52s).
[0m15:25:43.555820 [debug] [MainThread]: Command end result
[0m15:25:43.617236 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m15:25:43.617236 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m15:25:43.632008 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\run_results.json
[0m15:25:43.632008 [info ] [MainThread]: 
[0m15:25:43.649485 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:25:43.650361 [info ] [MainThread]: 
[0m15:25:43.652013 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:25:43.656711 [debug] [MainThread]: Command `dbt run` succeeded at 15:25:43.655704 after 14.44 seconds
[0m15:25:43.657637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F44F7DD590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F44F7DD6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F44F51EED0>]}
[0m15:25:43.658694 [debug] [MainThread]: Flushing usage events
[0m15:25:44.068684 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:25:46.942309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298AA9312D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298AA933810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298AA9326D0>]}


============================== 15:25:46.944282 | a74ba223-d295-407d-99cc-2ce7eceb53df ==============================
[0m15:25:46.944282 [info ] [MainThread]: Running with dbt=1.10.11
[0m15:25:46.944282 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\logs', 'profiles_dir': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m15:25:51.583817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a74ba223-d295-407d-99cc-2ce7eceb53df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298A9989350>]}
[0m15:25:51.724581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a74ba223-d295-407d-99cc-2ce7eceb53df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298A729C310>]}
[0m15:25:51.740707 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m15:25:53.280033 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m15:25:53.629893 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:25:53.629893 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:25:53.709687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a74ba223-d295-407d-99cc-2ce7eceb53df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298D7D15E50>]}
[0m15:25:53.852961 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m15:25:53.862966 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m15:25:53.931847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a74ba223-d295-407d-99cc-2ce7eceb53df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298A7EE9C50>]}
[0m15:25:53.932850 [info ] [MainThread]: Found 7 models, 5 data tests, 495 macros
[0m15:25:53.934846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a74ba223-d295-407d-99cc-2ce7eceb53df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298D7C70890>]}
[0m15:25:53.938849 [info ] [MainThread]: 
[0m15:25:53.939922 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m15:25:53.940941 [info ] [MainThread]: 
[0m15:25:53.941936 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:25:53.941936 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0'
[0m15:25:53.954189 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:53.956195 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0'
[0m15:25:54.023056 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:54.568241 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics'
[0m15:25:54.569368 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg'
[0m15:25:54.569368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:54.569368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:55.138682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a74ba223-d295-407d-99cc-2ce7eceb53df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298D7CE2C50>]}
[0m15:25:55.139801 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:25:55.155239 [debug] [Thread-1 (]: Began running node model.youtube_analytics.stg_youtube_channels
[0m15:25:55.155961 [debug] [Thread-2 (]: Began running node model.youtube_analytics.stg_youtube_video_ids
[0m15:25:55.155961 [debug] [Thread-3 (]: Began running node model.youtube_analytics.stg_youtube_video_stats
[0m15:25:55.155961 [info ] [Thread-1 (]: 1 of 7 START sql view model youtube_stg_youtube_stg.stg_youtube_channels ....... [RUN]
[0m15:25:55.159119 [info ] [Thread-2 (]: 2 of 7 START sql view model youtube_stg_youtube_stg.stg_youtube_video_ids ...... [RUN]
[0m15:25:55.161359 [info ] [Thread-3 (]: 3 of 7 START sql view model youtube_stg_youtube_stg.stg_youtube_video_stats .... [RUN]
[0m15:25:55.161359 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_channels'
[0m15:25:55.161359 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_video_ids'
[0m15:25:55.167554 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_video_stats'
[0m15:25:55.167554 [debug] [Thread-1 (]: Began compiling node model.youtube_analytics.stg_youtube_channels
[0m15:25:55.167554 [debug] [Thread-2 (]: Began compiling node model.youtube_analytics.stg_youtube_video_ids
[0m15:25:55.167554 [debug] [Thread-3 (]: Began compiling node model.youtube_analytics.stg_youtube_video_stats
[0m15:25:55.181873 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_channels"
[0m15:25:55.194999 [debug] [Thread-2 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_video_ids"
[0m15:25:55.198176 [debug] [Thread-3 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_video_stats"
[0m15:25:55.198176 [debug] [Thread-1 (]: Began executing node model.youtube_analytics.stg_youtube_channels
[0m15:25:55.198176 [debug] [Thread-2 (]: Began executing node model.youtube_analytics.stg_youtube_video_ids
[0m15:25:55.224843 [debug] [Thread-3 (]: Began executing node model.youtube_analytics.stg_youtube_video_stats
[0m15:25:55.270807 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_channels"
[0m15:25:55.276149 [debug] [Thread-2 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_video_ids"
[0m15:25:55.285809 [debug] [Thread-3 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_video_stats"
[0m15:25:55.285809 [debug] [Thread-2 (]: On model.youtube_analytics.stg_youtube_video_ids: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_video_ids"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_ids`
  OPTIONS()
  as select
  videoId              as video_id,
  channelId            as channel_id,
  date(_partitiontime) as load_date
from `orbital-nuance-471817-n0.youtube_raw.video_ids_raw`;


[0m15:25:55.295113 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:25:55.295113 [debug] [Thread-3 (]: On model.youtube_analytics.stg_youtube_video_stats: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_video_stats"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
  OPTIONS()
  as with src as (
  select
    id                                     as video_id,
    snippet.channelId                      as channel_id,
    snippet.title                          as video_title,
    snippet.publishedAt                    as video_published_at,
    cast(statistics.viewCount    as int64) as views,
    cast(statistics.likeCount    as int64) as likes,
    cast(statistics.commentCount as int64) as comments,
    contentDetails.duration                as duration_iso,
    current_date()                         as load_date
  from `orbital-nuance-471817-n0.youtube_raw.video_stats_raw`
),
parsed as (
  select
    *,
    (
      coalesce(SAFE_CAST(REGEXP_EXTRACT(duration_iso, r'(\d+)H') AS INT64), 0) * 3600
      + coalesce(SAFE_CAST(REGEXP_EXTRACT(duration_iso, r'(\d+)M') AS INT64), 0) * 60
      + coalesce(SAFE_CAST(REGEXP_EXTRACT(duration_iso, r'(\d+)S') AS INT64), 0)
    ) as duration_seconds
  from src
)
select * from parsed;


[0m15:25:55.293101 [debug] [Thread-1 (]: On model.youtube_analytics.stg_youtube_channels: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_channels"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_channels`
  OPTIONS()
  as with src as (
  select
    id                                        as channel_id,
    snippet.title                             as channel_title,
    snippet.country                           as channel_country,
    snippet.publishedAt                       as channel_published_at,
    cast(statistics.viewCount       as int64) as channel_view_count,
    cast(statistics.subscriberCount as int64) as channel_subscribers,
    cast(statistics.videoCount      as int64) as channel_video_count,
    date(_partitiontime)                      as load_date
  from `orbital-nuance-471817-n0.youtube_raw.channels_raw`
)
select * from src;


[0m15:25:55.375349 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:25:55.378351 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:25:56.107205 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:5807baad-5ba6-4ec1-bdfb-519747c07b26&page=queryresults
[0m15:25:56.111615 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:35202857-5155-40b1-8a6b-b6bd9ec4790a&page=queryresults
[0m15:25:56.418776 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:e3753874-e667-4f3b-bc3c-58efb1ef0412&page=queryresults
[0m15:25:56.630819 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a74ba223-d295-407d-99cc-2ce7eceb53df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298D7E225D0>]}
[0m15:25:56.630819 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a74ba223-d295-407d-99cc-2ce7eceb53df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298D7E9AF90>]}
[0m15:25:56.630819 [info ] [Thread-3 (]: 3 of 7 OK created sql view model youtube_stg_youtube_stg.stg_youtube_video_stats  [[32mCREATE VIEW (0 processed)[0m in 1.45s]
[0m15:25:56.638380 [info ] [Thread-2 (]: 2 of 7 OK created sql view model youtube_stg_youtube_stg.stg_youtube_video_ids . [[32mCREATE VIEW (0 processed)[0m in 1.47s]
[0m15:25:56.638380 [debug] [Thread-3 (]: Finished running node model.youtube_analytics.stg_youtube_video_stats
[0m15:25:56.642483 [debug] [Thread-2 (]: Finished running node model.youtube_analytics.stg_youtube_video_ids
[0m15:25:56.642483 [debug] [Thread-4 (]: Began running node model.youtube_analytics.fct_video_daily_metrics
[0m15:25:56.646888 [debug] [Thread-3 (]: Began running node model.youtube_analytics.video_latest_snapshot
[0m15:25:56.647887 [info ] [Thread-4 (]: 4 of 7 START sql incremental model youtube_stg_youtube_analytics.fct_video_daily_metrics  [RUN]
[0m15:25:56.648930 [info ] [Thread-3 (]: 5 of 7 START sql view model youtube_stg_youtube_analytics.video_latest_snapshot  [RUN]
[0m15:25:56.651761 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.youtube_analytics.fct_video_daily_metrics'
[0m15:25:56.653938 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.youtube_analytics.stg_youtube_video_stats, now model.youtube_analytics.video_latest_snapshot)
[0m15:25:56.654745 [debug] [Thread-4 (]: Began compiling node model.youtube_analytics.fct_video_daily_metrics
[0m15:25:56.656178 [debug] [Thread-3 (]: Began compiling node model.youtube_analytics.video_latest_snapshot
[0m15:25:56.675719 [debug] [Thread-4 (]: Writing injected SQL for node "model.youtube_analytics.fct_video_daily_metrics"
[0m15:25:56.676714 [debug] [Thread-3 (]: Writing injected SQL for node "model.youtube_analytics.video_latest_snapshot"
[0m15:25:56.676714 [debug] [Thread-4 (]: Began executing node model.youtube_analytics.fct_video_daily_metrics
[0m15:25:56.724461 [debug] [Thread-3 (]: Began executing node model.youtube_analytics.video_latest_snapshot
[0m15:25:56.756164 [debug] [Thread-3 (]: Writing runtime sql for node "model.youtube_analytics.video_latest_snapshot"
[0m15:25:56.803026 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:25:56.803026 [debug] [Thread-3 (]: On model.youtube_analytics.video_latest_snapshot: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.video_latest_snapshot"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`video_latest_snapshot`
  OPTIONS()
  as 

with ranked as (
  select
    s.video_id,
    s.channel_id,
    s.video_title,
    s.video_published_at,
    s.views,
    s.likes,
    s.comments,
    s.duration_seconds,
    s.load_date,
    row_number() over (partition by s.video_id order by s.load_date desc) as rn
  from `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats` s
)
select
  r.video_id,
  r.channel_id,
  r.video_title,
  r.video_published_at,
  r.views,
  r.likes,
  r.comments,
  r.duration_seconds,
  r.load_date as snapshot_date
from ranked r
where rn = 1;


[0m15:25:56.885982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a74ba223-d295-407d-99cc-2ce7eceb53df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298D85A90D0>]}
[0m15:25:56.887265 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:25:56.890815 [info ] [Thread-1 (]: 1 of 7 OK created sql view model youtube_stg_youtube_stg.stg_youtube_channels .. [[32mCREATE VIEW (0 processed)[0m in 1.72s]
[0m15:25:56.959306 [debug] [Thread-1 (]: Finished running node model.youtube_analytics.stg_youtube_channels
[0m15:25:56.967426 [debug] [Thread-2 (]: Began running node model.youtube_analytics.dim_channel
[0m15:25:56.967426 [info ] [Thread-2 (]: 6 of 7 START sql view model youtube_stg_youtube_analytics.dim_channel .......... [RUN]
[0m15:25:56.967426 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.youtube_analytics.stg_youtube_video_ids, now model.youtube_analytics.dim_channel)
[0m15:25:56.967426 [debug] [Thread-2 (]: Began compiling node model.youtube_analytics.dim_channel
[0m15:25:56.982005 [debug] [Thread-2 (]: Writing injected SQL for node "model.youtube_analytics.dim_channel"
[0m15:25:56.984023 [debug] [Thread-2 (]: Began executing node model.youtube_analytics.dim_channel
[0m15:25:56.990129 [debug] [Thread-2 (]: Writing runtime sql for node "model.youtube_analytics.dim_channel"
[0m15:25:56.993012 [debug] [Thread-2 (]: On model.youtube_analytics.dim_channel: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.dim_channel"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`dim_channel`
  OPTIONS()
  as 

with ranked as (
  select
    channel_id,
    channel_title,
    channel_country,
    channel_published_at,
    channel_view_count,
    channel_subscribers,
    channel_video_count,
    load_date,
    row_number() over (partition by channel_id order by load_date desc) as rn
  from `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_channels`
)
select
  channel_id,
  channel_title,
  channel_country,
  channel_published_at,
  channel_view_count,
  channel_subscribers,
  channel_video_count,
  load_date as snapshot_date
from ranked
where rn = 1;


[0m15:25:56.994010 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:25:57.442300 [debug] [Thread-4 (]: Writing runtime sql for node "model.youtube_analytics.fct_video_daily_metrics"
[0m15:25:57.442300 [debug] [Thread-4 (]: On model.youtube_analytics.fct_video_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.fct_video_daily_metrics"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics` as DBT_INTERNAL_DEST
        using (

-- 1) Read from staging and LIMIT to needed dates on incremental
with src_raw as (
  select
    video_id,
    channel_id,
    load_date,
    views,
    likes,
    comments
  from `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
  
    where load_date >= (
      select date_sub(coalesce(max(load_date), date '1900-01-01'), interval 1 day)
      from `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
    )
  
),

-- 2) Deduplicate: keep one row per (video_id, load_date)
--    If there are multiple, take the MAX of counters (monotonic metrics).
src as (
  select
    video_id,
    any_value(channel_id) as channel_id,
    load_date,
    max(views)    as views,
    max(likes)    as likes,
    max(comments) as comments
  from src_raw
  group by video_id, load_date
),

with_lag as (
  select
    *,
    lag(views)    over (partition by video_id order by load_date) as prev_views,
    lag(likes)    over (partition by video_id order by load_date) as prev_likes,
    lag(comments) over (partition by video_id order by load_date) as prev_comments
  from src
)

select
  video_id,
  channel_id,
  load_date,
  views,
  likes,
  comments,
  views    - coalesce(prev_views, 0)    as daily_views,
  likes    - coalesce(prev_likes, 0)    as daily_likes,
  comments - coalesce(prev_comments, 0) as daily_comments
from with_lag
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.video_id = DBT_INTERNAL_DEST.video_id
                ) and (
                    DBT_INTERNAL_SOURCE.load_date = DBT_INTERNAL_DEST.load_date
                )

    
    when matched then update set
        `video_id` = DBT_INTERNAL_SOURCE.`video_id`,`channel_id` = DBT_INTERNAL_SOURCE.`channel_id`,`load_date` = DBT_INTERNAL_SOURCE.`load_date`,`views` = DBT_INTERNAL_SOURCE.`views`,`likes` = DBT_INTERNAL_SOURCE.`likes`,`comments` = DBT_INTERNAL_SOURCE.`comments`,`daily_views` = DBT_INTERNAL_SOURCE.`daily_views`,`daily_likes` = DBT_INTERNAL_SOURCE.`daily_likes`,`daily_comments` = DBT_INTERNAL_SOURCE.`daily_comments`
    

    when not matched then insert
        (`video_id`, `channel_id`, `load_date`, `views`, `likes`, `comments`, `daily_views`, `daily_likes`, `daily_comments`)
    values
        (`video_id`, `channel_id`, `load_date`, `views`, `likes`, `comments`, `daily_views`, `daily_likes`, `daily_comments`)


    
[0m15:25:57.710344 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:20afd2c1-b604-45b7-9e6c-c21fa74e2cd2&page=queryresults
[0m15:25:57.849767 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:daf690e3-d4c2-4b0b-8f69-a8e3daa291a0&page=queryresults
[0m15:25:57.899173 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:007f515c-8306-4e24-a3a4-7de8ac5dee40&page=queryresults
[0m15:25:58.207711 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a74ba223-d295-407d-99cc-2ce7eceb53df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298D867F010>]}
[0m15:25:58.211260 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a74ba223-d295-407d-99cc-2ce7eceb53df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298D775D010>]}
[0m15:25:58.211809 [info ] [Thread-2 (]: 6 of 7 OK created sql view model youtube_stg_youtube_analytics.dim_channel ..... [[32mCREATE VIEW (0 processed)[0m in 1.24s]
[0m15:25:58.211809 [info ] [Thread-3 (]: 5 of 7 OK created sql view model youtube_stg_youtube_analytics.video_latest_snapshot  [[32mCREATE VIEW (0 processed)[0m in 1.56s]
[0m15:25:58.211809 [debug] [Thread-2 (]: Finished running node model.youtube_analytics.dim_channel
[0m15:25:58.211809 [debug] [Thread-3 (]: Finished running node model.youtube_analytics.video_latest_snapshot
[0m15:26:00.555187 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a74ba223-d295-407d-99cc-2ce7eceb53df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298D7EEC610>]}
[0m15:26:00.565938 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model youtube_stg_youtube_analytics.fct_video_daily_metrics  [[32mMERGE (20.0 rows, 5.5 KiB processed)[0m in 3.90s]
[0m15:26:00.565938 [debug] [Thread-4 (]: Finished running node model.youtube_analytics.fct_video_daily_metrics
[0m15:26:00.567950 [debug] [Thread-1 (]: Began running node model.youtube_analytics.agg_channel_trends_7d
[0m15:26:00.568742 [info ] [Thread-1 (]: 7 of 7 START sql view model youtube_stg_youtube_analytics.agg_channel_trends_7d  [RUN]
[0m15:26:00.571033 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.youtube_analytics.stg_youtube_channels, now model.youtube_analytics.agg_channel_trends_7d)
[0m15:26:00.571033 [debug] [Thread-1 (]: Began compiling node model.youtube_analytics.agg_channel_trends_7d
[0m15:26:00.583659 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_analytics.agg_channel_trends_7d"
[0m15:26:00.583659 [debug] [Thread-1 (]: Began executing node model.youtube_analytics.agg_channel_trends_7d
[0m15:26:00.586772 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_analytics.agg_channel_trends_7d"
[0m15:26:00.586772 [debug] [Thread-1 (]: On model.youtube_analytics.agg_channel_trends_7d: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.agg_channel_trends_7d"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`agg_channel_trends_7d`
  OPTIONS()
  as 

with daily as (
  select
    channel_id,
    video_id,
    load_date,
    daily_views,
    daily_likes,
    daily_comments
  from `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
),
rollup_cte as (
  select
    channel_id,
    load_date,
    sum(daily_views)    over (
      partition by channel_id
      order by load_date
      rows between 6 preceding and current row
    ) as views_7d,
    sum(daily_likes)    over (
      partition by channel_id
      order by load_date
      rows between 6 preceding and current row
    ) as likes_7d,
    sum(daily_comments) over (
      partition by channel_id
      order by load_date
      rows between 6 preceding and current row
    ) as comments_7d
  from daily
)
select distinct channel_id, load_date, views_7d, likes_7d, comments_7d
from rollup_cte;


[0m15:26:00.586772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:01.303127 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:3e2bfe4c-ad7a-40d8-945d-4a8f311671dd&page=queryresults
[0m15:26:01.643822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a74ba223-d295-407d-99cc-2ce7eceb53df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298D7C51C90>]}
[0m15:26:01.643822 [info ] [Thread-1 (]: 7 of 7 OK created sql view model youtube_stg_youtube_analytics.agg_channel_trends_7d  [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m15:26:01.646836 [debug] [Thread-1 (]: Finished running node model.youtube_analytics.agg_channel_trends_7d
[0m15:26:01.646836 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:26:01.646836 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:26:01.646836 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0' was properly closed.
[0m15:26:01.646836 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0' was properly closed.
[0m15:26:01.646836 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics' was properly closed.
[0m15:26:01.646836 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg' was properly closed.
[0m15:26:01.646836 [debug] [MainThread]: Connection 'model.youtube_analytics.agg_channel_trends_7d' was properly closed.
[0m15:26:01.646836 [debug] [MainThread]: Connection 'model.youtube_analytics.dim_channel' was properly closed.
[0m15:26:01.662693 [debug] [MainThread]: Connection 'model.youtube_analytics.video_latest_snapshot' was properly closed.
[0m15:26:01.662693 [debug] [MainThread]: Connection 'model.youtube_analytics.fct_video_daily_metrics' was properly closed.
[0m15:26:01.662693 [info ] [MainThread]: 
[0m15:26:01.662693 [info ] [MainThread]: Finished running 1 incremental model, 6 view models in 0 hours 0 minutes and 7.72 seconds (7.72s).
[0m15:26:01.662693 [debug] [MainThread]: Command end result
[0m15:26:01.723105 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m15:26:01.723105 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m15:26:01.741702 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\run_results.json
[0m15:26:01.741702 [info ] [MainThread]: 
[0m15:26:01.741702 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:26:01.741702 [info ] [MainThread]: 
[0m15:26:01.741702 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m15:26:01.754863 [debug] [MainThread]: Command `dbt run` succeeded at 15:26:01.741702 after 14.87 seconds
[0m15:26:01.754863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298AA94CB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298A3EE2110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298A3E60C50>]}
[0m15:26:01.754863 [debug] [MainThread]: Flushing usage events
[0m15:26:02.226147 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:26:05.132590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C1534BD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C1534AAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C1534AA10>]}


============================== 15:26:05.132590 | 031d1faa-0b43-4322-ae50-99fddedfbf02 ==============================
[0m15:26:05.132590 [info ] [MainThread]: Running with dbt=1.10.11
[0m15:26:05.132590 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt'}
[0m15:26:10.145578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '031d1faa-0b43-4322-ae50-99fddedfbf02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C421D9050>]}
[0m15:26:10.310414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '031d1faa-0b43-4322-ae50-99fddedfbf02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C11D073D0>]}
[0m15:26:10.310414 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m15:26:11.741805 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m15:26:12.082129 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:26:12.083322 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:26:12.164657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '031d1faa-0b43-4322-ae50-99fddedfbf02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C426D4A10>]}
[0m15:26:12.365337 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m15:26:12.381574 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m15:26:12.465005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '031d1faa-0b43-4322-ae50-99fddedfbf02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C429D2490>]}
[0m15:26:12.465005 [info ] [MainThread]: Found 7 models, 5 data tests, 495 macros
[0m15:26:12.467023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '031d1faa-0b43-4322-ae50-99fddedfbf02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C4288EC90>]}
[0m15:26:12.471948 [info ] [MainThread]: 
[0m15:26:12.471948 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m15:26:12.471948 [info ] [MainThread]: 
[0m15:26:12.474708 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:26:12.484105 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics'
[0m15:26:12.484105 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg'
[0m15:26:12.484105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:26:12.491753 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:26:13.093584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '031d1faa-0b43-4322-ae50-99fddedfbf02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C420BD990>]}
[0m15:26:13.094716 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:26:13.113446 [debug] [Thread-1 (]: Began running node test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267
[0m15:26:13.114861 [debug] [Thread-2 (]: Began running node test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1
[0m15:26:13.114861 [debug] [Thread-3 (]: Began running node test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7
[0m15:26:13.114861 [debug] [Thread-4 (]: Began running node test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602
[0m15:26:13.114861 [info ] [Thread-1 (]: 1 of 5 START test not_null_fct_video_daily_metrics_load_date ................... [RUN]
[0m15:26:13.114861 [info ] [Thread-2 (]: 2 of 5 START test not_null_fct_video_daily_metrics_video_id .................... [RUN]
[0m15:26:13.120714 [info ] [Thread-3 (]: 3 of 5 START test not_null_stg_youtube_video_stats_load_date ................... [RUN]
[0m15:26:13.120714 [info ] [Thread-4 (]: 4 of 5 START test not_null_stg_youtube_video_stats_video_id .................... [RUN]
[0m15:26:13.120714 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267'
[0m15:26:13.120714 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1'
[0m15:26:13.127000 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7'
[0m15:26:13.127000 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602'
[0m15:26:13.130379 [debug] [Thread-1 (]: Began compiling node test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267
[0m15:26:13.130379 [debug] [Thread-2 (]: Began compiling node test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1
[0m15:26:13.130379 [debug] [Thread-3 (]: Began compiling node test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7
[0m15:26:13.130379 [debug] [Thread-4 (]: Began compiling node test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602
[0m15:26:13.163404 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267"
[0m15:26:13.185987 [debug] [Thread-2 (]: Writing injected SQL for node "test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1"
[0m15:26:13.194923 [debug] [Thread-3 (]: Writing injected SQL for node "test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7"
[0m15:26:13.196485 [debug] [Thread-4 (]: Writing injected SQL for node "test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602"
[0m15:26:13.196485 [debug] [Thread-1 (]: Began executing node test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267
[0m15:26:13.207528 [debug] [Thread-2 (]: Began executing node test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1
[0m15:26:13.207528 [debug] [Thread-3 (]: Began executing node test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7
[0m15:26:13.207528 [debug] [Thread-4 (]: Began executing node test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602
[0m15:26:13.255428 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267"
[0m15:26:13.260339 [debug] [Thread-2 (]: Writing runtime sql for node "test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1"
[0m15:26:13.260339 [debug] [Thread-3 (]: Writing runtime sql for node "test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7"
[0m15:26:13.273523 [debug] [Thread-4 (]: Writing runtime sql for node "test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602"
[0m15:26:13.273523 [debug] [Thread-1 (]: On test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select load_date
from `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
where load_date is null



  
  
      
    ) dbt_internal_test
[0m15:26:13.273523 [debug] [Thread-2 (]: On test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select video_id
from `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
where video_id is null



  
  
      
    ) dbt_internal_test
[0m15:26:13.273523 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:26:13.273523 [debug] [Thread-3 (]: On test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select load_date
from `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
where load_date is null



  
  
      
    ) dbt_internal_test
[0m15:26:13.273523 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:26:13.273523 [debug] [Thread-4 (]: On test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select video_id
from `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
where video_id is null



  
  
      
    ) dbt_internal_test
[0m15:26:13.349674 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:26:13.426550 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:26:14.218554 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:8a4534d9-709a-4a9e-8dd1-28ae46c5d8ab&page=queryresults
[0m15:26:14.274070 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:88f060ca-4ce5-4eca-a754-c8b361a9976e&page=queryresults
[0m15:26:14.395026 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:a7386955-b915-4766-8ec4-e2b6205cff1c&page=queryresults
[0m15:26:14.846311 [info ] [Thread-1 (]: 1 of 5 PASS not_null_fct_video_daily_metrics_load_date ......................... [[32mPASS[0m in 1.73s]
[0m15:26:14.846311 [debug] [Thread-1 (]: Finished running node test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267
[0m15:26:14.846311 [debug] [Thread-1 (]: Began running node test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e
[0m15:26:14.849185 [info ] [Thread-1 (]: 5 of 5 START test unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_  [RUN]
[0m15:26:14.849185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267, now test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e)
[0m15:26:14.849185 [debug] [Thread-1 (]: Began compiling node test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e
[0m15:26:14.856407 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e"
[0m15:26:14.856407 [debug] [Thread-1 (]: Began executing node test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e
[0m15:26:14.856407 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e"
[0m15:26:14.856407 [debug] [Thread-1 (]: On test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select video_id || '-' || cast(load_date as string) as unique_field
  from `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
  where video_id || '-' || cast(load_date as string) is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:26:14.863529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:14.930969 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:5b3aa9a7-2b2a-466c-b900-8044f9168741&page=queryresults
[0m15:26:14.934988 [info ] [Thread-3 (]: 3 of 5 PASS not_null_stg_youtube_video_stats_load_date ......................... [[32mPASS[0m in 1.81s]
[0m15:26:14.940875 [debug] [Thread-3 (]: Finished running node test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7
[0m15:26:14.998028 [info ] [Thread-4 (]: 4 of 5 PASS not_null_stg_youtube_video_stats_video_id .......................... [[32mPASS[0m in 1.87s]
[0m15:26:14.998028 [debug] [Thread-4 (]: Finished running node test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602
[0m15:26:15.504154 [info ] [Thread-2 (]: 2 of 5 PASS not_null_fct_video_daily_metrics_video_id .......................... [[32mPASS[0m in 2.38s]
[0m15:26:15.504154 [debug] [Thread-2 (]: Finished running node test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1
[0m15:26:15.817643 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:817da084-9242-4bf2-b1d1-725989a77996&page=queryresults
[0m15:26:16.396067 [info ] [Thread-1 (]: 5 of 5 PASS unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_ .. [[32mPASS[0m in 1.55s]
[0m15:26:16.396067 [debug] [Thread-1 (]: Finished running node test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e
[0m15:26:16.400421 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:26:16.404456 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:26:16.406477 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics' was properly closed.
[0m15:26:16.406477 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg' was properly closed.
[0m15:26:16.406477 [debug] [MainThread]: Connection 'test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e' was properly closed.
[0m15:26:16.406477 [debug] [MainThread]: Connection 'test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1' was properly closed.
[0m15:26:16.411933 [debug] [MainThread]: Connection 'test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7' was properly closed.
[0m15:26:16.411933 [debug] [MainThread]: Connection 'test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602' was properly closed.
[0m15:26:16.411933 [info ] [MainThread]: 
[0m15:26:16.411933 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 3.94 seconds (3.94s).
[0m15:26:16.419814 [debug] [MainThread]: Command end result
[0m15:26:16.473588 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m15:26:16.473588 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m15:26:16.495455 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\run_results.json
[0m15:26:16.497470 [info ] [MainThread]: 
[0m15:26:16.497470 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:26:16.497470 [info ] [MainThread]: 
[0m15:26:16.497470 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m15:26:16.505482 [debug] [MainThread]: Command `dbt test` succeeded at 15:26:16.505482 after 11.43 seconds
[0m15:26:16.505482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C153B5210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C0E972110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C42227B90>]}
[0m15:26:16.505482 [debug] [MainThread]: Flushing usage events
[0m15:26:16.886027 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:49:53.803033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E8BDC9810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E8BA72050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E8BE04950>]}


============================== 15:49:53.803033 | 700cead5-1821-4af4-a043-f59bee83db84 ==============================
[0m15:49:53.803033 [info ] [MainThread]: Running with dbt=1.10.11
[0m15:49:53.803033 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --full-refresh', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'log_path': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m15:49:58.988142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '700cead5-1821-4af4-a043-f59bee83db84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EB8C23F50>]}
[0m15:49:59.134799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '700cead5-1821-4af4-a043-f59bee83db84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E88787710>]}
[0m15:49:59.136813 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m15:50:00.552929 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m15:50:00.962002 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:50:00.962002 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:50:01.052160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '700cead5-1821-4af4-a043-f59bee83db84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EB8B983D0>]}
[0m15:50:01.197234 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m15:50:01.214707 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m15:50:01.276913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '700cead5-1821-4af4-a043-f59bee83db84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EB8C99050>]}
[0m15:50:01.276913 [info ] [MainThread]: Found 7 models, 5 data tests, 495 macros
[0m15:50:01.283778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '700cead5-1821-4af4-a043-f59bee83db84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EB93314D0>]}
[0m15:50:01.286287 [info ] [MainThread]: 
[0m15:50:01.286287 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m15:50:01.286287 [info ] [MainThread]: 
[0m15:50:01.293878 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:50:01.308915 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0'
[0m15:50:01.308915 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0'
[0m15:50:01.308915 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:01.308915 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:01.998041 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg'
[0m15:50:01.998041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:01.998041 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics'
[0m15:50:02.075053 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:02.607125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '700cead5-1821-4af4-a043-f59bee83db84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E8BD08590>]}
[0m15:50:02.607125 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:50:02.623252 [debug] [Thread-1 (]: Began running node model.youtube_analytics.stg_youtube_channels
[0m15:50:02.623252 [debug] [Thread-2 (]: Began running node model.youtube_analytics.stg_youtube_video_ids
[0m15:50:02.623252 [debug] [Thread-3 (]: Began running node model.youtube_analytics.stg_youtube_video_stats
[0m15:50:02.623252 [info ] [Thread-1 (]: 1 of 7 START sql view model youtube_stg_youtube_stg.stg_youtube_channels ....... [RUN]
[0m15:50:02.623252 [info ] [Thread-2 (]: 2 of 7 START sql view model youtube_stg_youtube_stg.stg_youtube_video_ids ...... [RUN]
[0m15:50:02.623252 [info ] [Thread-3 (]: 3 of 7 START sql view model youtube_stg_youtube_stg.stg_youtube_video_stats .... [RUN]
[0m15:50:02.623252 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_channels'
[0m15:50:02.639167 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_video_ids'
[0m15:50:02.639167 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_video_stats'
[0m15:50:02.639167 [debug] [Thread-1 (]: Began compiling node model.youtube_analytics.stg_youtube_channels
[0m15:50:02.639167 [debug] [Thread-2 (]: Began compiling node model.youtube_analytics.stg_youtube_video_ids
[0m15:50:02.639167 [debug] [Thread-3 (]: Began compiling node model.youtube_analytics.stg_youtube_video_stats
[0m15:50:02.655760 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_channels"
[0m15:50:02.655760 [debug] [Thread-2 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_video_ids"
[0m15:50:02.655760 [debug] [Thread-3 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_video_stats"
[0m15:50:02.671159 [debug] [Thread-2 (]: Began executing node model.youtube_analytics.stg_youtube_video_ids
[0m15:50:02.671159 [debug] [Thread-1 (]: Began executing node model.youtube_analytics.stg_youtube_channels
[0m15:50:02.734799 [debug] [Thread-2 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_video_ids"
[0m15:50:02.734799 [debug] [Thread-3 (]: Began executing node model.youtube_analytics.stg_youtube_video_stats
[0m15:50:02.734799 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_channels"
[0m15:50:02.750808 [debug] [Thread-3 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_video_stats"
[0m15:50:02.750808 [debug] [Thread-2 (]: On model.youtube_analytics.stg_youtube_video_ids: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_video_ids"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_ids`
  OPTIONS()
  as select
  videoId              as video_id,
  channelId            as channel_id,
  date(_partitiontime) as load_date
from `orbital-nuance-471817-n0.youtube_raw.video_ids_raw`;


[0m15:50:02.761872 [debug] [Thread-1 (]: On model.youtube_analytics.stg_youtube_channels: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_channels"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_channels`
  OPTIONS()
  as with src as (
  select
    id                                        as channel_id,
    snippet.title                             as channel_title,
    snippet.country                           as channel_country,
    snippet.publishedAt                       as channel_published_at,
    cast(statistics.viewCount       as int64) as channel_view_count,
    cast(statistics.subscriberCount as int64) as channel_subscribers,
    cast(statistics.videoCount      as int64) as channel_video_count,
    date(_partitiontime)                      as load_date
  from `orbital-nuance-471817-n0.youtube_raw.channels_raw`
)
select * from src;


[0m15:50:02.763884 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:50:02.763884 [debug] [Thread-3 (]: On model.youtube_analytics.stg_youtube_video_stats: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_video_stats"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
  OPTIONS()
  as with src as (
  select
    id                                     as video_id,
    snippet.channelId                      as channel_id,
    snippet.title                          as video_title,
    snippet.publishedAt                    as video_published_at,
    cast(statistics.viewCount    as int64) as views,
    cast(statistics.likeCount    as int64) as likes,
    cast(statistics.commentCount as int64) as comments,
    contentDetails.duration                as duration_iso,
    current_date()                         as load_date
  from `orbital-nuance-471817-n0.youtube_raw.video_stats_raw`
),
parsed as (
  select
    *,
    (
      coalesce(SAFE_CAST(REGEXP_EXTRACT(duration_iso, r'(\d+)H') AS INT64), 0) * 3600
      + coalesce(SAFE_CAST(REGEXP_EXTRACT(duration_iso, r'(\d+)M') AS INT64), 0) * 60
      + coalesce(SAFE_CAST(REGEXP_EXTRACT(duration_iso, r'(\d+)S') AS INT64), 0)
    ) as duration_seconds
  from src
)
select * from parsed;


[0m15:50:02.767817 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:50:02.833763 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:50:03.620052 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:c96e47ad-04af-4f3d-8b32-ebd17a7ceaec&page=queryresults
[0m15:50:03.634156 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:2c09bda3-4731-4fdb-a9d8-2211f757160b&page=queryresults
[0m15:50:03.676758 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:c40f81f6-370c-4c80-b75a-f74c4ec3abd3&page=queryresults
[0m15:50:04.125928 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '700cead5-1821-4af4-a043-f59bee83db84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EB9A1CA90>]}
[0m15:50:04.125928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '700cead5-1821-4af4-a043-f59bee83db84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EB9464250>]}
[0m15:50:04.125928 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '700cead5-1821-4af4-a043-f59bee83db84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EB940F910>]}
[0m15:50:04.125928 [info ] [Thread-2 (]: 2 of 7 OK created sql view model youtube_stg_youtube_stg.stg_youtube_video_ids . [[32mCREATE VIEW (0 processed)[0m in 1.48s]
[0m15:50:04.130244 [info ] [Thread-1 (]: 1 of 7 OK created sql view model youtube_stg_youtube_stg.stg_youtube_channels .. [[32mCREATE VIEW (0 processed)[0m in 1.49s]
[0m15:50:04.130244 [info ] [Thread-3 (]: 3 of 7 OK created sql view model youtube_stg_youtube_stg.stg_youtube_video_stats  [[32mCREATE VIEW (0 processed)[0m in 1.49s]
[0m15:50:04.130244 [debug] [Thread-2 (]: Finished running node model.youtube_analytics.stg_youtube_video_ids
[0m15:50:04.130244 [debug] [Thread-1 (]: Finished running node model.youtube_analytics.stg_youtube_channels
[0m15:50:04.130244 [debug] [Thread-3 (]: Finished running node model.youtube_analytics.stg_youtube_video_stats
[0m15:50:04.130244 [debug] [Thread-4 (]: Began running node model.youtube_analytics.dim_channel
[0m15:50:04.130244 [debug] [Thread-1 (]: Began running node model.youtube_analytics.fct_video_daily_metrics
[0m15:50:04.139764 [debug] [Thread-3 (]: Began running node model.youtube_analytics.video_latest_snapshot
[0m15:50:04.139764 [info ] [Thread-4 (]: 4 of 7 START sql view model youtube_stg_youtube_analytics.dim_channel .......... [RUN]
[0m15:50:04.140704 [info ] [Thread-1 (]: 5 of 7 START sql incremental model youtube_stg_youtube_analytics.fct_video_daily_metrics  [RUN]
[0m15:50:04.140704 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.youtube_analytics.dim_channel'
[0m15:50:04.140704 [info ] [Thread-3 (]: 6 of 7 START sql view model youtube_stg_youtube_analytics.video_latest_snapshot  [RUN]
[0m15:50:04.140704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.youtube_analytics.stg_youtube_channels, now model.youtube_analytics.fct_video_daily_metrics)
[0m15:50:04.146011 [debug] [Thread-4 (]: Began compiling node model.youtube_analytics.dim_channel
[0m15:50:04.146011 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.youtube_analytics.stg_youtube_video_stats, now model.youtube_analytics.video_latest_snapshot)
[0m15:50:04.146011 [debug] [Thread-1 (]: Began compiling node model.youtube_analytics.fct_video_daily_metrics
[0m15:50:04.150086 [debug] [Thread-4 (]: Writing injected SQL for node "model.youtube_analytics.dim_channel"
[0m15:50:04.162004 [debug] [Thread-3 (]: Began compiling node model.youtube_analytics.video_latest_snapshot
[0m15:50:04.180100 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_analytics.fct_video_daily_metrics"
[0m15:50:04.182972 [debug] [Thread-3 (]: Writing injected SQL for node "model.youtube_analytics.video_latest_snapshot"
[0m15:50:04.185125 [debug] [Thread-4 (]: Began executing node model.youtube_analytics.dim_channel
[0m15:50:04.187131 [debug] [Thread-1 (]: Began executing node model.youtube_analytics.fct_video_daily_metrics
[0m15:50:04.192544 [debug] [Thread-4 (]: Writing runtime sql for node "model.youtube_analytics.dim_channel"
[0m15:50:04.192544 [debug] [Thread-3 (]: Began executing node model.youtube_analytics.video_latest_snapshot
[0m15:50:04.272038 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:04.292666 [debug] [Thread-3 (]: Writing runtime sql for node "model.youtube_analytics.video_latest_snapshot"
[0m15:50:04.293566 [debug] [Thread-4 (]: On model.youtube_analytics.dim_channel: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.dim_channel"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`dim_channel`
  OPTIONS()
  as 

with ranked as (
  select
    channel_id,
    channel_title,
    channel_country,
    channel_published_at,
    channel_view_count,
    channel_subscribers,
    channel_video_count,
    load_date,
    row_number() over (partition by channel_id order by load_date desc) as rn
  from `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_channels`
)
select
  channel_id,
  channel_title,
  channel_country,
  channel_published_at,
  channel_view_count,
  channel_subscribers,
  channel_video_count,
  load_date as snapshot_date
from ranked
where rn = 1;


[0m15:50:04.365613 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:50:04.365613 [debug] [Thread-3 (]: On model.youtube_analytics.video_latest_snapshot: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.video_latest_snapshot"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`video_latest_snapshot`
  OPTIONS()
  as 

with ranked as (
  select
    s.video_id,
    s.channel_id,
    s.video_title,
    s.video_published_at,
    s.views,
    s.likes,
    s.comments,
    s.duration_seconds,
    s.load_date,
    row_number() over (partition by s.video_id order by s.load_date desc) as rn
  from `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats` s
)
select
  r.video_id,
  r.channel_id,
  r.video_title,
  r.video_published_at,
  r.views,
  r.likes,
  r.comments,
  r.duration_seconds,
  r.load_date as snapshot_date
from ranked r
where rn = 1;


[0m15:50:04.442268 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:50:04.911996 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_analytics.fct_video_daily_metrics"
[0m15:50:04.911996 [debug] [Thread-1 (]: On model.youtube_analytics.fct_video_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.fct_video_daily_metrics"} */

  
    

    create or replace table `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
      
    partition by load_date
    cluster by channel_id, video_id

    
    OPTIONS()
    as (
      

-- 1) Read from staging and LIMIT to needed dates on incremental
with src_raw as (
  select
    video_id,
    channel_id,
    load_date,
    views,
    likes,
    comments
  from `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
  
),

-- 2) Deduplicate: keep one row per (video_id, load_date)
--    If there are multiple, take the MAX of counters (monotonic metrics).
src as (
  select
    video_id,
    any_value(channel_id) as channel_id,
    load_date,
    max(views)    as views,
    max(likes)    as likes,
    max(comments) as comments
  from src_raw
  group by video_id, load_date
),

with_lag as (
  select
    *,
    lag(views)    over (partition by video_id order by load_date) as prev_views,
    lag(likes)    over (partition by video_id order by load_date) as prev_likes,
    lag(comments) over (partition by video_id order by load_date) as prev_comments
  from src
)

select
  video_id,
  channel_id,
  load_date,
  views,
  likes,
  comments,
  views    - coalesce(prev_views, 0)    as daily_views,
  likes    - coalesce(prev_likes, 0)    as daily_likes,
  comments - coalesce(prev_comments, 0) as daily_comments
from with_lag
    );
  
[0m15:50:05.247823 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:07b51df5-c36e-41a7-a4d6-f3986410d36e&page=queryresults
[0m15:50:05.274673 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:4add249f-b4cd-4b26-abbf-deb362dfd282&page=queryresults
[0m15:50:05.395421 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:28e031ce-117d-439b-91b1-dddc7a09edf9&page=queryresults
[0m15:50:05.592730 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '700cead5-1821-4af4-a043-f59bee83db84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EB9140650>]}
[0m15:50:05.594656 [info ] [Thread-3 (]: 6 of 7 OK created sql view model youtube_stg_youtube_analytics.video_latest_snapshot  [[32mCREATE VIEW (0 processed)[0m in 1.45s]
[0m15:50:05.595207 [debug] [Thread-3 (]: Finished running node model.youtube_analytics.video_latest_snapshot
[0m15:50:05.631361 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '700cead5-1821-4af4-a043-f59bee83db84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EB938B150>]}
[0m15:50:05.631361 [info ] [Thread-4 (]: 4 of 7 OK created sql view model youtube_stg_youtube_analytics.dim_channel ..... [[32mCREATE VIEW (0 processed)[0m in 1.49s]
[0m15:50:05.631361 [debug] [Thread-4 (]: Finished running node model.youtube_analytics.dim_channel
[0m15:50:08.052686 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '700cead5-1821-4af4-a043-f59bee83db84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EB91D7010>]}
[0m15:50:08.052686 [info ] [Thread-1 (]: 5 of 7 OK created sql incremental model youtube_stg_youtube_analytics.fct_video_daily_metrics  [[32mCREATE TABLE (20.0 rows, 3.7 KiB processed)[0m in 3.91s]
[0m15:50:08.052686 [debug] [Thread-1 (]: Finished running node model.youtube_analytics.fct_video_daily_metrics
[0m15:50:08.052686 [debug] [Thread-2 (]: Began running node model.youtube_analytics.agg_channel_trends_7d
[0m15:50:08.052686 [info ] [Thread-2 (]: 7 of 7 START sql view model youtube_stg_youtube_analytics.agg_channel_trends_7d  [RUN]
[0m15:50:08.068821 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.youtube_analytics.stg_youtube_video_ids, now model.youtube_analytics.agg_channel_trends_7d)
[0m15:50:08.071603 [debug] [Thread-2 (]: Began compiling node model.youtube_analytics.agg_channel_trends_7d
[0m15:50:08.071603 [debug] [Thread-2 (]: Writing injected SQL for node "model.youtube_analytics.agg_channel_trends_7d"
[0m15:50:08.071603 [debug] [Thread-2 (]: Began executing node model.youtube_analytics.agg_channel_trends_7d
[0m15:50:08.092155 [debug] [Thread-2 (]: Writing runtime sql for node "model.youtube_analytics.agg_channel_trends_7d"
[0m15:50:08.093126 [debug] [Thread-2 (]: On model.youtube_analytics.agg_channel_trends_7d: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.agg_channel_trends_7d"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`agg_channel_trends_7d`
  OPTIONS()
  as 

with daily as (
  select
    channel_id,
    video_id,
    load_date,
    daily_views,
    daily_likes,
    daily_comments
  from `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
),
rollup_cte as (
  select
    channel_id,
    load_date,
    sum(daily_views)    over (
      partition by channel_id
      order by load_date
      rows between 6 preceding and current row
    ) as views_7d,
    sum(daily_likes)    over (
      partition by channel_id
      order by load_date
      rows between 6 preceding and current row
    ) as likes_7d,
    sum(daily_comments) over (
      partition by channel_id
      order by load_date
      rows between 6 preceding and current row
    ) as comments_7d
  from daily
)
select distinct channel_id, load_date, views_7d, likes_7d, comments_7d
from rollup_cte;


[0m15:50:08.095137 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:50:08.660199 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:8c23dd11-b32c-4a23-8ee8-86ca6cf9ea32&page=queryresults
[0m15:50:09.114721 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '700cead5-1821-4af4-a043-f59bee83db84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EB9BFA790>]}
[0m15:50:09.114721 [info ] [Thread-2 (]: 7 of 7 OK created sql view model youtube_stg_youtube_analytics.agg_channel_trends_7d  [[32mCREATE VIEW (0 processed)[0m in 1.05s]
[0m15:50:09.130705 [debug] [Thread-2 (]: Finished running node model.youtube_analytics.agg_channel_trends_7d
[0m15:50:09.130705 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:50:09.130705 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:50:09.130705 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0' was properly closed.
[0m15:50:09.130705 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0' was properly closed.
[0m15:50:09.130705 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg' was properly closed.
[0m15:50:09.130705 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics' was properly closed.
[0m15:50:09.130705 [debug] [MainThread]: Connection 'model.youtube_analytics.fct_video_daily_metrics' was properly closed.
[0m15:50:09.146787 [debug] [MainThread]: Connection 'model.youtube_analytics.agg_channel_trends_7d' was properly closed.
[0m15:50:09.147909 [debug] [MainThread]: Connection 'model.youtube_analytics.video_latest_snapshot' was properly closed.
[0m15:50:09.148902 [debug] [MainThread]: Connection 'model.youtube_analytics.dim_channel' was properly closed.
[0m15:50:09.150789 [info ] [MainThread]: 
[0m15:50:09.151788 [info ] [MainThread]: Finished running 1 incremental model, 6 view models in 0 hours 0 minutes and 7.86 seconds (7.86s).
[0m15:50:09.156917 [debug] [MainThread]: Command end result
[0m15:50:09.208732 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m15:50:09.208732 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m15:50:09.224917 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\run_results.json
[0m15:50:09.224917 [info ] [MainThread]: 
[0m15:50:09.224917 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:50:09.240949 [info ] [MainThread]: 
[0m15:50:09.240949 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m15:50:09.240949 [debug] [MainThread]: Command `dbt run` succeeded at 15:50:09.240949 after 15.50 seconds
[0m15:50:09.240949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E8BE2FB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E8BE2FCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E85371110>]}
[0m15:50:09.240949 [debug] [MainThread]: Flushing usage events
[0m15:50:09.795314 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:07:01.462433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C12A758F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C12A758BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C12A75A390>]}


============================== 16:07:01.462433 | 20d23342-8f01-438c-9d40-20413f97141e ==============================
[0m16:07:01.462433 [info ] [MainThread]: Running with dbt=1.10.11
[0m16:07:01.462433 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'empty': 'False', 'indirect_selection': 'eager', 'log_path': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m16:07:06.703499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20d23342-8f01-438c-9d40-20413f97141e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1575B6810>]}
[0m16:07:06.859324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20d23342-8f01-438c-9d40-20413f97141e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C12711B750>]}
[0m16:07:06.861327 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m16:07:08.381289 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m16:07:08.755390 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:07:08.755390 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:07:08.832805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20d23342-8f01-438c-9d40-20413f97141e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1576DF2D0>]}
[0m16:07:09.022572 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m16:07:09.027711 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m16:07:09.083957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20d23342-8f01-438c-9d40-20413f97141e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C157CC6650>]}
[0m16:07:09.099961 [info ] [MainThread]: Found 7 models, 5 data tests, 495 macros
[0m16:07:09.099961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20d23342-8f01-438c-9d40-20413f97141e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C157AB84D0>]}
[0m16:07:09.102882 [info ] [MainThread]: 
[0m16:07:09.102882 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m16:07:09.102882 [info ] [MainThread]: 
[0m16:07:09.102882 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:07:09.115771 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0'
[0m16:07:09.115771 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:07:09.120779 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0'
[0m16:07:09.176719 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:07:09.787461 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_orbital-nuance-471817-n0, now create_orbital-nuance-471817-n0_youtube_stg_youtube_analytics)
[0m16:07:09.787461 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_orbital-nuance-471817-n0, now create_orbital-nuance-471817-n0_youtube_stg_youtube_stg)
[0m16:07:09.787461 [debug] [ThreadPool]: Creating schema "database: "orbital-nuance-471817-n0"
schema: "youtube_stg_youtube_analytics"
"
[0m16:07:09.787461 [debug] [ThreadPool]: Creating schema "database: "orbital-nuance-471817-n0"
schema: "youtube_stg_youtube_stg"
"
[0m16:07:09.794789 [debug] [ThreadPool]: On create_orbital-nuance-471817-n0_youtube_stg_youtube_analytics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "connection_name": "create_orbital-nuance-471817-n0_youtube_stg_youtube_analytics"} */
create schema if not exists `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`
  
[0m16:07:09.801792 [debug] [ThreadPool]: On create_orbital-nuance-471817-n0_youtube_stg_youtube_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "connection_name": "create_orbital-nuance-471817-n0_youtube_stg_youtube_stg"} */
create schema if not exists `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`
  
[0m16:07:09.802418 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:07:09.802946 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:07:10.334899 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:bddacc5e-e0de-49ba-8452-eb8b864b1b41&page=queryresults
[0m16:07:10.364289 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:5c00b2d3-5b04-46d9-b24d-04d71d66a2aa&page=queryresults
[0m16:07:11.122342 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics'
[0m16:07:11.124435 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg'
[0m16:07:11.125479 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:07:11.126676 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:07:11.779658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20d23342-8f01-438c-9d40-20413f97141e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C129764D90>]}
[0m16:07:11.781747 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:07:11.798749 [debug] [Thread-1 (]: Began running node model.youtube_analytics.stg_youtube_channels
[0m16:07:11.800801 [debug] [Thread-2 (]: Began running node model.youtube_analytics.stg_youtube_video_ids
[0m16:07:11.802767 [debug] [Thread-3 (]: Began running node model.youtube_analytics.stg_youtube_video_stats
[0m16:07:11.804670 [info ] [Thread-1 (]: 1 of 7 START sql view model youtube_stg_youtube_stg.stg_youtube_channels ....... [RUN]
[0m16:07:11.806659 [info ] [Thread-2 (]: 2 of 7 START sql view model youtube_stg_youtube_stg.stg_youtube_video_ids ...... [RUN]
[0m16:07:11.808665 [info ] [Thread-3 (]: 3 of 7 START sql view model youtube_stg_youtube_stg.stg_youtube_video_stats .... [RUN]
[0m16:07:11.811972 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_channels'
[0m16:07:11.814237 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_video_ids'
[0m16:07:11.816404 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_video_stats'
[0m16:07:11.817414 [debug] [Thread-1 (]: Began compiling node model.youtube_analytics.stg_youtube_channels
[0m16:07:11.819655 [debug] [Thread-2 (]: Began compiling node model.youtube_analytics.stg_youtube_video_ids
[0m16:07:11.821647 [debug] [Thread-3 (]: Began compiling node model.youtube_analytics.stg_youtube_video_stats
[0m16:07:11.833285 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_channels"
[0m16:07:11.843564 [debug] [Thread-2 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_video_ids"
[0m16:07:11.854352 [debug] [Thread-3 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_video_stats"
[0m16:07:11.854352 [debug] [Thread-1 (]: Began executing node model.youtube_analytics.stg_youtube_channels
[0m16:07:11.912374 [debug] [Thread-3 (]: Began executing node model.youtube_analytics.stg_youtube_video_stats
[0m16:07:11.913705 [debug] [Thread-2 (]: Began executing node model.youtube_analytics.stg_youtube_video_ids
[0m16:07:11.928277 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_channels"
[0m16:07:11.928277 [debug] [Thread-3 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_video_stats"
[0m16:07:11.943986 [debug] [Thread-2 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_video_ids"
[0m16:07:11.943986 [debug] [Thread-1 (]: On model.youtube_analytics.stg_youtube_channels: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_channels"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_channels`
  OPTIONS()
  as with src as (
  select
    id                                        as channel_id,
    snippet.title                             as channel_title,
    snippet.country                           as channel_country,
    snippet.publishedAt                       as channel_published_at,
    cast(statistics.viewCount       as int64) as channel_view_count,
    cast(statistics.subscriberCount as int64) as channel_subscribers,
    cast(statistics.videoCount      as int64) as channel_video_count,
    date(_partitiontime)                      as load_date
  from `orbital-nuance-471817-n0.youtube_raw.channels_raw`
)
select * from src;


[0m16:07:11.943986 [debug] [Thread-3 (]: On model.youtube_analytics.stg_youtube_video_stats: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_video_stats"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
  OPTIONS()
  as with src as (
  select
    id                                     as video_id,
    snippet.channelId                      as channel_id,
    snippet.title                          as video_title,
    snippet.publishedAt                    as video_published_at,
    cast(statistics.viewCount    as int64) as views,
    cast(statistics.likeCount    as int64) as likes,
    cast(statistics.commentCount as int64) as comments,
    contentDetails.duration                as duration_iso,
    current_date()                         as load_date
  from `orbital-nuance-471817-n0.youtube_raw.video_stats_raw`
),
parsed as (
  select
    *,
    (
      coalesce(SAFE_CAST(REGEXP_EXTRACT(duration_iso, r'(\d+)H') AS INT64), 0) * 3600
      + coalesce(SAFE_CAST(REGEXP_EXTRACT(duration_iso, r'(\d+)M') AS INT64), 0) * 60
      + coalesce(SAFE_CAST(REGEXP_EXTRACT(duration_iso, r'(\d+)S') AS INT64), 0)
    ) as duration_seconds
  from src
)
select * from parsed;


[0m16:07:11.943986 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:07:11.943986 [debug] [Thread-2 (]: On model.youtube_analytics.stg_youtube_video_ids: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_video_ids"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_ids`
  OPTIONS()
  as select
  videoId              as video_id,
  channelId            as channel_id,
  date(_partitiontime) as load_date
from `orbital-nuance-471817-n0.youtube_raw.video_ids_raw`;


[0m16:07:11.943986 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:07:12.036934 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:07:12.823940 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:c34d20fd-a770-4f7c-a0ef-8b6685fd6ee4&page=queryresults
[0m16:07:12.826936 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:e72fa59a-e8af-4a65-9722-5703fe28aa78&page=queryresults
[0m16:07:12.849083 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:16cc401c-61e6-4187-9a7a-d03c79e4be52&page=queryresults
[0m16:07:13.207681 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20d23342-8f01-438c-9d40-20413f97141e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1574B5A90>]}
[0m16:07:13.207681 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20d23342-8f01-438c-9d40-20413f97141e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1584314D0>]}
[0m16:07:13.207681 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20d23342-8f01-438c-9d40-20413f97141e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1584CFE10>]}
[0m16:07:13.207681 [info ] [Thread-2 (]: 2 of 7 OK created sql view model youtube_stg_youtube_stg.stg_youtube_video_ids . [[32mCREATE VIEW (0 processed)[0m in 1.39s]
[0m16:07:13.207681 [info ] [Thread-1 (]: 1 of 7 OK created sql view model youtube_stg_youtube_stg.stg_youtube_channels .. [[32mCREATE VIEW (0 processed)[0m in 1.40s]
[0m16:07:13.207681 [info ] [Thread-3 (]: 3 of 7 OK created sql view model youtube_stg_youtube_stg.stg_youtube_video_stats  [[32mCREATE VIEW (0 processed)[0m in 1.39s]
[0m16:07:13.207681 [debug] [Thread-2 (]: Finished running node model.youtube_analytics.stg_youtube_video_ids
[0m16:07:13.207681 [debug] [Thread-1 (]: Finished running node model.youtube_analytics.stg_youtube_channels
[0m16:07:13.207681 [debug] [Thread-3 (]: Finished running node model.youtube_analytics.stg_youtube_video_stats
[0m16:07:13.207681 [debug] [Thread-4 (]: Began running node model.youtube_analytics.dim_channel
[0m16:07:13.223414 [debug] [Thread-1 (]: Began running node model.youtube_analytics.fct_video_daily_metrics
[0m16:07:13.223414 [info ] [Thread-4 (]: 4 of 7 START sql view model youtube_stg_youtube_analytics.dim_channel .......... [RUN]
[0m16:07:13.223414 [debug] [Thread-2 (]: Began running node model.youtube_analytics.video_latest_snapshot
[0m16:07:13.223414 [info ] [Thread-1 (]: 5 of 7 START sql incremental model youtube_stg_youtube_analytics.fct_video_daily_metrics  [RUN]
[0m16:07:13.223414 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.youtube_analytics.dim_channel'
[0m16:07:13.229028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.youtube_analytics.stg_youtube_channels, now model.youtube_analytics.fct_video_daily_metrics)
[0m16:07:13.229028 [info ] [Thread-2 (]: 6 of 7 START sql view model youtube_stg_youtube_analytics.video_latest_snapshot  [RUN]
[0m16:07:13.229028 [debug] [Thread-4 (]: Began compiling node model.youtube_analytics.dim_channel
[0m16:07:13.229028 [debug] [Thread-1 (]: Began compiling node model.youtube_analytics.fct_video_daily_metrics
[0m16:07:13.229028 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.youtube_analytics.stg_youtube_video_ids, now model.youtube_analytics.video_latest_snapshot)
[0m16:07:13.240578 [debug] [Thread-4 (]: Writing injected SQL for node "model.youtube_analytics.dim_channel"
[0m16:07:13.242593 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_analytics.fct_video_daily_metrics"
[0m16:07:13.242593 [debug] [Thread-2 (]: Began compiling node model.youtube_analytics.video_latest_snapshot
[0m16:07:13.251857 [debug] [Thread-2 (]: Writing injected SQL for node "model.youtube_analytics.video_latest_snapshot"
[0m16:07:13.251857 [debug] [Thread-1 (]: Began executing node model.youtube_analytics.fct_video_daily_metrics
[0m16:07:13.279050 [debug] [Thread-4 (]: Began executing node model.youtube_analytics.dim_channel
[0m16:07:13.286606 [debug] [Thread-2 (]: Began executing node model.youtube_analytics.video_latest_snapshot
[0m16:07:13.291399 [debug] [Thread-4 (]: Writing runtime sql for node "model.youtube_analytics.dim_channel"
[0m16:07:13.380356 [debug] [Thread-2 (]: Writing runtime sql for node "model.youtube_analytics.video_latest_snapshot"
[0m16:07:13.426015 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_analytics.fct_video_daily_metrics"
[0m16:07:13.426015 [debug] [Thread-4 (]: On model.youtube_analytics.dim_channel: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.dim_channel"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`dim_channel`
  OPTIONS()
  as 

with ranked as (
  select
    channel_id,
    channel_title,
    channel_country,
    channel_published_at,
    channel_view_count,
    channel_subscribers,
    channel_video_count,
    load_date,
    row_number() over (partition by channel_id order by load_date desc) as rn
  from `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_channels`
)
select
  channel_id,
  channel_title,
  channel_country,
  channel_published_at,
  channel_view_count,
  channel_subscribers,
  channel_video_count,
  load_date as snapshot_date
from ranked
where rn = 1;


[0m16:07:13.426015 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:07:13.426015 [debug] [Thread-2 (]: On model.youtube_analytics.video_latest_snapshot: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.video_latest_snapshot"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`video_latest_snapshot`
  OPTIONS()
  as 

with ranked as (
  select
    s.video_id,
    s.channel_id,
    s.video_title,
    s.video_published_at,
    s.views,
    s.likes,
    s.comments,
    s.duration_seconds,
    s.load_date,
    row_number() over (partition by s.video_id order by s.load_date desc) as rn
  from `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats` s
)
select
  r.video_id,
  r.channel_id,
  r.video_title,
  r.video_published_at,
  r.views,
  r.likes,
  r.comments,
  r.duration_seconds,
  r.load_date as snapshot_date
from ranked r
where rn = 1;


[0m16:07:13.441663 [debug] [Thread-1 (]: On model.youtube_analytics.fct_video_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.fct_video_daily_metrics"} */

  
    

    create or replace table `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
      
    partition by load_date
    cluster by channel_id, video_id

    
    OPTIONS()
    as (
      

-- 1) Read from staging and LIMIT to needed dates on incremental
with src_raw as (
  select
    video_id,
    channel_id,
    load_date,
    views,
    likes,
    comments
  from `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
  
),

-- 2) Deduplicate: keep one row per (video_id, load_date)
--    If there are multiple, take the MAX of counters (monotonic metrics).
src as (
  select
    video_id,
    any_value(channel_id) as channel_id,
    load_date,
    max(views)    as views,
    max(likes)    as likes,
    max(comments) as comments
  from src_raw
  group by video_id, load_date
),

with_lag as (
  select
    *,
    lag(views)    over (partition by video_id order by load_date) as prev_views,
    lag(likes)    over (partition by video_id order by load_date) as prev_likes,
    lag(comments) over (partition by video_id order by load_date) as prev_comments
  from src
)

select
  video_id,
  channel_id,
  load_date,
  views,
  likes,
  comments,
  views    - coalesce(prev_views, 0)    as daily_views,
  likes    - coalesce(prev_likes, 0)    as daily_likes,
  comments - coalesce(prev_comments, 0) as daily_comments
from with_lag
    );
  
[0m16:07:13.441663 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:07:13.527384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:07:14.310772 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:e599a3cd-10e2-4b5c-9743-0115dad64b5a&page=queryresults
[0m16:07:14.347977 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:ee84a7a9-7c27-414a-a7d5-3f3ce5cf26ab&page=queryresults
[0m16:07:14.470514 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:454e9a64-2097-4570-91af-15fa0bf45ada&page=queryresults
[0m16:07:14.657291 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20d23342-8f01-438c-9d40-20413f97141e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C158385790>]}
[0m16:07:14.657291 [info ] [Thread-2 (]: 6 of 7 OK created sql view model youtube_stg_youtube_analytics.video_latest_snapshot  [[32mCREATE VIEW (0 processed)[0m in 1.43s]
[0m16:07:14.662547 [debug] [Thread-2 (]: Finished running node model.youtube_analytics.video_latest_snapshot
[0m16:07:14.710746 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20d23342-8f01-438c-9d40-20413f97141e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C157D18C10>]}
[0m16:07:14.710746 [info ] [Thread-4 (]: 4 of 7 OK created sql view model youtube_stg_youtube_analytics.dim_channel ..... [[32mCREATE VIEW (0 processed)[0m in 1.49s]
[0m16:07:14.710746 [debug] [Thread-4 (]: Finished running node model.youtube_analytics.dim_channel
[0m16:07:16.807380 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20d23342-8f01-438c-9d40-20413f97141e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C158503B90>]}
[0m16:07:16.808381 [info ] [Thread-1 (]: 5 of 7 OK created sql incremental model youtube_stg_youtube_analytics.fct_video_daily_metrics  [[32mCREATE TABLE (40.0 rows, 4.9 KiB processed)[0m in 3.58s]
[0m16:07:16.809380 [debug] [Thread-1 (]: Finished running node model.youtube_analytics.fct_video_daily_metrics
[0m16:07:16.810460 [debug] [Thread-3 (]: Began running node model.youtube_analytics.agg_channel_trends_7d
[0m16:07:16.812378 [info ] [Thread-3 (]: 7 of 7 START sql view model youtube_stg_youtube_analytics.agg_channel_trends_7d  [RUN]
[0m16:07:16.814589 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.youtube_analytics.stg_youtube_video_stats, now model.youtube_analytics.agg_channel_trends_7d)
[0m16:07:16.815588 [debug] [Thread-3 (]: Began compiling node model.youtube_analytics.agg_channel_trends_7d
[0m16:07:16.824848 [debug] [Thread-3 (]: Writing injected SQL for node "model.youtube_analytics.agg_channel_trends_7d"
[0m16:07:16.826907 [debug] [Thread-3 (]: Began executing node model.youtube_analytics.agg_channel_trends_7d
[0m16:07:16.834444 [debug] [Thread-3 (]: Writing runtime sql for node "model.youtube_analytics.agg_channel_trends_7d"
[0m16:07:16.837341 [debug] [Thread-3 (]: On model.youtube_analytics.agg_channel_trends_7d: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.agg_channel_trends_7d"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`agg_channel_trends_7d`
  OPTIONS()
  as 

with daily as (
  select
    channel_id,
    video_id,
    load_date,
    daily_views,
    daily_likes,
    daily_comments
  from `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
),
rollup_cte as (
  select
    channel_id,
    load_date,
    sum(daily_views)    over (
      partition by channel_id
      order by load_date
      rows between 6 preceding and current row
    ) as views_7d,
    sum(daily_likes)    over (
      partition by channel_id
      order by load_date
      rows between 6 preceding and current row
    ) as likes_7d,
    sum(daily_comments) over (
      partition by channel_id
      order by load_date
      rows between 6 preceding and current row
    ) as comments_7d
  from daily
)
select distinct channel_id, load_date, views_7d, likes_7d, comments_7d
from rollup_cte;


[0m16:07:16.838340 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:07:17.516406 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:35b3e935-9837-447f-a50c-5948e60cc854&page=queryresults
[0m16:07:17.889093 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20d23342-8f01-438c-9d40-20413f97141e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1585490D0>]}
[0m16:07:17.890069 [info ] [Thread-3 (]: 7 of 7 OK created sql view model youtube_stg_youtube_analytics.agg_channel_trends_7d  [[32mCREATE VIEW (0 processed)[0m in 1.08s]
[0m16:07:17.890754 [debug] [Thread-3 (]: Finished running node model.youtube_analytics.agg_channel_trends_7d
[0m16:07:17.893426 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:07:17.898350 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:07:17.899491 [debug] [MainThread]: Connection 'create_orbital-nuance-471817-n0_youtube_stg_youtube_analytics' was properly closed.
[0m16:07:17.900482 [debug] [MainThread]: Connection 'create_orbital-nuance-471817-n0_youtube_stg_youtube_stg' was properly closed.
[0m16:07:17.901381 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics' was properly closed.
[0m16:07:17.902379 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg' was properly closed.
[0m16:07:17.903475 [debug] [MainThread]: Connection 'model.youtube_analytics.fct_video_daily_metrics' was properly closed.
[0m16:07:17.904811 [debug] [MainThread]: Connection 'model.youtube_analytics.video_latest_snapshot' was properly closed.
[0m16:07:17.905893 [debug] [MainThread]: Connection 'model.youtube_analytics.agg_channel_trends_7d' was properly closed.
[0m16:07:17.906904 [debug] [MainThread]: Connection 'model.youtube_analytics.dim_channel' was properly closed.
[0m16:07:17.907905 [info ] [MainThread]: 
[0m16:07:17.907905 [info ] [MainThread]: Finished running 1 incremental model, 6 view models in 0 hours 0 minutes and 8.81 seconds (8.81s).
[0m16:07:17.911623 [debug] [MainThread]: Command end result
[0m16:07:17.974352 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m16:07:17.980962 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m16:07:17.991027 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\run_results.json
[0m16:07:17.991027 [info ] [MainThread]: 
[0m16:07:17.991027 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:07:17.991027 [info ] [MainThread]: 
[0m16:07:17.991027 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m16:07:18.007668 [debug] [MainThread]: Command `dbt run` succeeded at 16:07:18.006765 after 16.60 seconds
[0m16:07:18.008809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C12A7BD710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C12A7BF950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C123CA1150>]}
[0m16:07:18.009689 [debug] [MainThread]: Flushing usage events
[0m16:07:18.552697 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:07:21.459983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6A2ED9A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6A321A650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6A321A490>]}


============================== 16:07:21.459983 | 8352f0ad-a0b3-4cf2-9345-fbd3f5fcc865 ==============================
[0m16:07:21.459983 [info ] [MainThread]: Running with dbt=1.10.11
[0m16:07:21.459983 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\logs', 'profiles_dir': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m16:07:26.459675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8352f0ad-a0b3-4cf2-9345-fbd3f5fcc865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6D00B7990>]}
[0m16:07:26.599067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8352f0ad-a0b3-4cf2-9345-fbd3f5fcc865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D69FBDB610>]}
[0m16:07:26.601091 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m16:07:28.371808 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m16:07:28.794047 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:07:28.794047 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:07:28.904029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8352f0ad-a0b3-4cf2-9345-fbd3f5fcc865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6D064FE90>]}
[0m16:07:29.127225 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m16:07:29.127225 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m16:07:29.223099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8352f0ad-a0b3-4cf2-9345-fbd3f5fcc865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6D08A2C90>]}
[0m16:07:29.223099 [info ] [MainThread]: Found 7 models, 5 data tests, 495 macros
[0m16:07:29.231214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8352f0ad-a0b3-4cf2-9345-fbd3f5fcc865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6D052B610>]}
[0m16:07:29.231214 [info ] [MainThread]: 
[0m16:07:29.231214 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m16:07:29.231214 [info ] [MainThread]: 
[0m16:07:29.239288 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:07:29.239288 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics'
[0m16:07:29.239288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:07:29.239288 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg'
[0m16:07:29.319201 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:07:29.869082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8352f0ad-a0b3-4cf2-9345-fbd3f5fcc865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6CFF8D990>]}
[0m16:07:29.869082 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:07:29.884828 [debug] [Thread-1 (]: Began running node test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267
[0m16:07:29.884828 [debug] [Thread-2 (]: Began running node test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1
[0m16:07:29.884828 [debug] [Thread-3 (]: Began running node test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7
[0m16:07:29.884828 [debug] [Thread-4 (]: Began running node test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602
[0m16:07:29.884828 [info ] [Thread-1 (]: 1 of 5 START test not_null_fct_video_daily_metrics_load_date ................... [RUN]
[0m16:07:29.884828 [info ] [Thread-2 (]: 2 of 5 START test not_null_fct_video_daily_metrics_video_id .................... [RUN]
[0m16:07:29.884828 [info ] [Thread-3 (]: 3 of 5 START test not_null_stg_youtube_video_stats_load_date ................... [RUN]
[0m16:07:29.900975 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267'
[0m16:07:29.884828 [info ] [Thread-4 (]: 4 of 5 START test not_null_stg_youtube_video_stats_video_id .................... [RUN]
[0m16:07:29.903410 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1'
[0m16:07:29.903410 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7'
[0m16:07:29.903410 [debug] [Thread-1 (]: Began compiling node test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267
[0m16:07:29.903410 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602'
[0m16:07:29.903410 [debug] [Thread-2 (]: Began compiling node test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1
[0m16:07:29.903410 [debug] [Thread-3 (]: Began compiling node test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7
[0m16:07:29.951920 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267"
[0m16:07:29.951920 [debug] [Thread-4 (]: Began compiling node test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602
[0m16:07:29.964555 [debug] [Thread-2 (]: Writing injected SQL for node "test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1"
[0m16:07:29.964555 [debug] [Thread-3 (]: Writing injected SQL for node "test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7"
[0m16:07:29.980517 [debug] [Thread-4 (]: Writing injected SQL for node "test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602"
[0m16:07:29.980517 [debug] [Thread-1 (]: Began executing node test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267
[0m16:07:29.988289 [debug] [Thread-2 (]: Began executing node test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1
[0m16:07:29.988289 [debug] [Thread-3 (]: Began executing node test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7
[0m16:07:30.028353 [debug] [Thread-4 (]: Began executing node test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602
[0m16:07:30.036936 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267"
[0m16:07:30.042752 [debug] [Thread-2 (]: Writing runtime sql for node "test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1"
[0m16:07:30.044264 [debug] [Thread-3 (]: Writing runtime sql for node "test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7"
[0m16:07:30.054559 [debug] [Thread-4 (]: Writing runtime sql for node "test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602"
[0m16:07:30.054559 [debug] [Thread-1 (]: On test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select load_date
from `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
where load_date is null



  
  
      
    ) dbt_internal_test
[0m16:07:30.060055 [debug] [Thread-2 (]: On test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select video_id
from `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
where video_id is null



  
  
      
    ) dbt_internal_test
[0m16:07:30.060055 [debug] [Thread-3 (]: On test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select load_date
from `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
where load_date is null



  
  
      
    ) dbt_internal_test
[0m16:07:30.060055 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:07:30.060055 [debug] [Thread-4 (]: On test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select video_id
from `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
where video_id is null



  
  
      
    ) dbt_internal_test
[0m16:07:30.060055 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:07:30.060055 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:07:30.140364 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:07:30.992408 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:0b6f06d3-89db-4e7c-87b7-f2e405fc7544&page=queryresults
[0m16:07:31.088243 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:9269120c-d312-49ce-9daa-6be73f93c9a8&page=queryresults
[0m16:07:31.195430 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:a0ea3657-6ce5-4993-b2a5-94380a837c67&page=queryresults
[0m16:07:31.242020 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:7cde22ec-f025-4b91-ac70-126414c060c4&page=queryresults
[0m16:07:31.620411 [info ] [Thread-1 (]: 1 of 5 PASS not_null_fct_video_daily_metrics_load_date ......................... [[32mPASS[0m in 1.72s]
[0m16:07:31.620411 [debug] [Thread-1 (]: Finished running node test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267
[0m16:07:31.627672 [debug] [Thread-1 (]: Began running node test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e
[0m16:07:31.627672 [info ] [Thread-1 (]: 5 of 5 START test unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_  [RUN]
[0m16:07:31.627672 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267, now test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e)
[0m16:07:31.627672 [debug] [Thread-1 (]: Began compiling node test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e
[0m16:07:31.635900 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e"
[0m16:07:31.635900 [debug] [Thread-1 (]: Began executing node test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e
[0m16:07:31.635900 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e"
[0m16:07:31.635900 [debug] [Thread-1 (]: On test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select video_id || '-' || cast(load_date as string) as unique_field
  from `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
  where video_id || '-' || cast(load_date as string) is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:07:31.635900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:07:31.644245 [info ] [Thread-2 (]: 2 of 5 PASS not_null_fct_video_daily_metrics_video_id .......................... [[32mPASS[0m in 1.74s]
[0m16:07:31.686165 [debug] [Thread-2 (]: Finished running node test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1
[0m16:07:31.775524 [info ] [Thread-3 (]: 3 of 5 PASS not_null_stg_youtube_video_stats_load_date ......................... [[32mPASS[0m in 1.87s]
[0m16:07:31.776529 [debug] [Thread-3 (]: Finished running node test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7
[0m16:07:31.815359 [info ] [Thread-4 (]: 4 of 5 PASS not_null_stg_youtube_video_stats_video_id .......................... [[32mPASS[0m in 1.91s]
[0m16:07:31.815359 [debug] [Thread-4 (]: Finished running node test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602
[0m16:07:32.505100 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:1eabbc63-c4ff-4cdc-b226-9719b1936d94&page=queryresults
[0m16:07:33.039548 [info ] [Thread-1 (]: 5 of 5 PASS unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_ .. [[32mPASS[0m in 1.41s]
[0m16:07:33.039548 [debug] [Thread-1 (]: Finished running node test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e
[0m16:07:33.039548 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:07:33.047280 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:07:33.049293 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics' was properly closed.
[0m16:07:33.051452 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg' was properly closed.
[0m16:07:33.053170 [debug] [MainThread]: Connection 'test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e' was properly closed.
[0m16:07:33.053170 [debug] [MainThread]: Connection 'test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1' was properly closed.
[0m16:07:33.053170 [debug] [MainThread]: Connection 'test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7' was properly closed.
[0m16:07:33.053170 [debug] [MainThread]: Connection 'test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602' was properly closed.
[0m16:07:33.053170 [info ] [MainThread]: 
[0m16:07:33.053170 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 3.81 seconds (3.81s).
[0m16:07:33.053170 [debug] [MainThread]: Command end result
[0m16:07:33.117731 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m16:07:33.117731 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m16:07:33.134565 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\run_results.json
[0m16:07:33.134565 [info ] [MainThread]: 
[0m16:07:33.134565 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:07:33.134565 [info ] [MainThread]: 
[0m16:07:33.134565 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m16:07:33.149880 [debug] [MainThread]: Command `dbt test` succeeded at 16:07:33.149880 after 11.75 seconds
[0m16:07:33.151523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6A3284310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6A2ED8B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D69C7B0C50>]}
[0m16:07:33.151523 [debug] [MainThread]: Flushing usage events
[0m16:07:33.521212 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:28:44.780159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F3463C0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F348CA710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F348C9B90>]}


============================== 16:28:44.786397 | 22217665-9a61-41e8-9b50-a97d5de3da8f ==============================
[0m16:28:44.786397 [info ] [MainThread]: Running with dbt=1.10.11
[0m16:28:44.786397 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --full-refresh', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'printer_width': '80', 'log_path': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m16:28:50.458842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22217665-9a61-41e8-9b50-a97d5de3da8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F339593D0>]}
[0m16:28:50.616046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22217665-9a61-41e8-9b50-a97d5de3da8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F31257990>]}
[0m16:28:50.618949 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m16:28:52.005631 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m16:28:52.208108 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:28:52.208108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '22217665-9a61-41e8-9b50-a97d5de3da8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F34030950>]}
[0m16:28:55.161296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22217665-9a61-41e8-9b50-a97d5de3da8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F620C1910>]}
[0m16:28:55.309811 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m16:28:55.315239 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m16:28:55.385152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22217665-9a61-41e8-9b50-a97d5de3da8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F621DE910>]}
[0m16:28:55.385152 [info ] [MainThread]: Found 7 models, 5 data tests, 496 macros
[0m16:28:55.388174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22217665-9a61-41e8-9b50-a97d5de3da8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F620796D0>]}
[0m16:28:55.388174 [info ] [MainThread]: 
[0m16:28:55.388174 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m16:28:55.396159 [info ] [MainThread]: 
[0m16:28:55.396848 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:28:55.405399 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0'
[0m16:28:55.409664 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:28:55.409664 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0'
[0m16:28:55.412305 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:28:56.053535 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_analytics'
[0m16:28:56.058420 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg'
[0m16:28:56.058420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:28:56.058420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:28:56.637074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22217665-9a61-41e8-9b50-a97d5de3da8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F61EF3D90>]}
[0m16:28:56.639191 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:28:56.645261 [debug] [Thread-1 (]: Began running node model.youtube_analytics.stg_youtube_channels
[0m16:28:56.645261 [debug] [Thread-2 (]: Began running node model.youtube_analytics.stg_youtube_video_ids
[0m16:28:56.645261 [debug] [Thread-3 (]: Began running node model.youtube_analytics.stg_youtube_video_stats
[0m16:28:56.645261 [info ] [Thread-1 (]: 1 of 7 START sql view model youtube_stg.stg_youtube_channels ................... [RUN]
[0m16:28:56.645261 [info ] [Thread-2 (]: 2 of 7 START sql view model youtube_stg.stg_youtube_video_ids .................. [RUN]
[0m16:28:56.660928 [info ] [Thread-3 (]: 3 of 7 START sql view model youtube_stg.stg_youtube_video_stats ................ [RUN]
[0m16:28:56.660928 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_channels'
[0m16:28:56.660928 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_video_ids'
[0m16:28:56.660928 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_video_stats'
[0m16:28:56.660928 [debug] [Thread-1 (]: Began compiling node model.youtube_analytics.stg_youtube_channels
[0m16:28:56.660928 [debug] [Thread-2 (]: Began compiling node model.youtube_analytics.stg_youtube_video_ids
[0m16:28:56.660928 [debug] [Thread-3 (]: Began compiling node model.youtube_analytics.stg_youtube_video_stats
[0m16:28:56.678322 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_channels"
[0m16:28:56.678322 [debug] [Thread-2 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_video_ids"
[0m16:28:56.692986 [debug] [Thread-3 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_video_stats"
[0m16:28:56.692986 [debug] [Thread-1 (]: Began executing node model.youtube_analytics.stg_youtube_channels
[0m16:28:56.692986 [debug] [Thread-2 (]: Began executing node model.youtube_analytics.stg_youtube_video_ids
[0m16:28:56.781679 [debug] [Thread-2 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_video_ids"
[0m16:28:56.781679 [debug] [Thread-3 (]: Began executing node model.youtube_analytics.stg_youtube_video_stats
[0m16:28:56.785840 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_channels"
[0m16:28:56.785840 [debug] [Thread-2 (]: On model.youtube_analytics.stg_youtube_video_ids: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_video_ids"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg`.`stg_youtube_video_ids`
  OPTIONS()
  as select
  videoId              as video_id,
  channelId            as channel_id,
  date(_partitiontime) as load_date
from `orbital-nuance-471817-n0.youtube_raw.video_ids_raw`;


[0m16:28:56.798900 [debug] [Thread-3 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_video_stats"
[0m16:28:56.801921 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:28:56.801921 [debug] [Thread-1 (]: On model.youtube_analytics.stg_youtube_channels: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_channels"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg`.`stg_youtube_channels`
  OPTIONS()
  as with src as (
  select
    id                                        as channel_id,
    snippet.title                             as channel_title,
    snippet.country                           as channel_country,
    snippet.publishedAt                       as channel_published_at,
    cast(statistics.viewCount       as int64) as channel_view_count,
    cast(statistics.subscriberCount as int64) as channel_subscribers,
    cast(statistics.videoCount      as int64) as channel_video_count,
    date(_partitiontime)                      as load_date
  from `orbital-nuance-471817-n0.youtube_raw.channels_raw`
)
select * from src;


[0m16:28:56.864035 [debug] [Thread-3 (]: On model.youtube_analytics.stg_youtube_video_stats: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_video_stats"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg`.`stg_youtube_video_stats`
  OPTIONS()
  as with src as (
  select
    id                                     as video_id,
    snippet.channelId                      as channel_id,
    snippet.title                          as video_title,
    snippet.publishedAt                    as video_published_at,
    cast(statistics.viewCount    as int64) as views,
    cast(statistics.likeCount    as int64) as likes,
    cast(statistics.commentCount as int64) as comments,
    contentDetails.duration                as duration_iso,
    current_date()                         as load_date
  from `orbital-nuance-471817-n0.youtube_raw.video_stats_raw`
),
parsed as (
  select
    *,
    (
      coalesce(SAFE_CAST(REGEXP_EXTRACT(duration_iso, r'(\d+)H') AS INT64), 0) * 3600
      + coalesce(SAFE_CAST(REGEXP_EXTRACT(duration_iso, r'(\d+)M') AS INT64), 0) * 60
      + coalesce(SAFE_CAST(REGEXP_EXTRACT(duration_iso, r'(\d+)S') AS INT64), 0)
    ) as duration_seconds
  from src
)
select * from parsed;


[0m16:28:56.879850 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:28:56.879850 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:28:57.604018 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:d835a032-126d-489b-84c4-c08ca9e05113&page=queryresults
[0m16:28:57.606909 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:561e0050-c767-496b-9ea3-5a7d70dcdcd4&page=queryresults
[0m16:28:57.618013 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:84e90e1d-9f52-47b1-b3e5-29610b3ae41f&page=queryresults
[0m16:28:57.788225 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:84e90e1d-9f52-47b1-b3e5-29610b3ae41f&page=queryresults
[0m16:28:57.795818 [debug] [Thread-1 (]: Database Error in model stg_youtube_channels (dbt/models\staging\stg_youtube_channels.sql)
  Unrecognized name: _partitiontime at [15:10]
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_channels.sql
[0m16:28:57.795818 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22217665-9a61-41e8-9b50-a97d5de3da8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F635F2190>]}
[0m16:28:57.802529 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model youtube_stg.stg_youtube_channels .......... [[31mERROR[0m in 1.13s]
[0m16:28:57.802529 [debug] [Thread-1 (]: Finished running node model.youtube_analytics.stg_youtube_channels
[0m16:28:57.802529 [debug] [Thread-7 (]: Marking all children of 'model.youtube_analytics.stg_youtube_channels' to be skipped because of status 'error'.  Reason: Database Error in model stg_youtube_channels (dbt/models\staging\stg_youtube_channels.sql)
  Unrecognized name: _partitiontime at [15:10]
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_channels.sql.
[0m16:28:57.802529 [debug] [Thread-4 (]: Began running node model.youtube_analytics.dim_channel
[0m16:28:57.802529 [info ] [Thread-4 (]: 4 of 7 SKIP relation youtube_analytics.dim_channel ............................. [[33mSKIP[0m]
[0m16:28:57.802529 [debug] [Thread-4 (]: Finished running node model.youtube_analytics.dim_channel
[0m16:28:57.818268 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:d835a032-126d-489b-84c4-c08ca9e05113&page=queryresults
[0m16:28:57.818268 [debug] [Thread-2 (]: Database Error in model stg_youtube_video_ids (dbt/models\staging\stg_youtube_video_ids.sql)
  Unrecognized name: _partitiontime at [9:8]
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_video_ids.sql
[0m16:28:57.834209 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22217665-9a61-41e8-9b50-a97d5de3da8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F62226310>]}
[0m16:28:57.834562 [error] [Thread-2 (]: 2 of 7 ERROR creating sql view model youtube_stg.stg_youtube_video_ids ......... [[31mERROR[0m in 1.17s]
[0m16:28:57.835585 [debug] [Thread-2 (]: Finished running node model.youtube_analytics.stg_youtube_video_ids
[0m16:28:57.836766 [debug] [Thread-7 (]: Marking all children of 'model.youtube_analytics.stg_youtube_video_ids' to be skipped because of status 'error'.  Reason: Database Error in model stg_youtube_video_ids (dbt/models\staging\stg_youtube_video_ids.sql)
  Unrecognized name: _partitiontime at [9:8]
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_video_ids.sql.
[0m16:28:58.133038 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22217665-9a61-41e8-9b50-a97d5de3da8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F62226590>]}
[0m16:28:58.135052 [info ] [Thread-3 (]: 3 of 7 OK created sql view model youtube_stg.stg_youtube_video_stats ........... [[32mCREATE VIEW (0 processed)[0m in 1.47s]
[0m16:28:58.137069 [debug] [Thread-3 (]: Finished running node model.youtube_analytics.stg_youtube_video_stats
[0m16:28:58.139267 [debug] [Thread-1 (]: Began running node model.youtube_analytics.fct_video_daily_metrics
[0m16:28:58.140478 [debug] [Thread-4 (]: Began running node model.youtube_analytics.video_latest_snapshot
[0m16:28:58.140478 [info ] [Thread-1 (]: 5 of 7 START sql incremental model youtube_analytics.fct_video_daily_metrics ... [RUN]
[0m16:28:58.140478 [info ] [Thread-4 (]: 6 of 7 START sql view model youtube_analytics.video_latest_snapshot ............ [RUN]
[0m16:28:58.140478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.youtube_analytics.stg_youtube_channels, now model.youtube_analytics.fct_video_daily_metrics)
[0m16:28:58.146816 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.youtube_analytics.video_latest_snapshot'
[0m16:28:58.146816 [debug] [Thread-1 (]: Began compiling node model.youtube_analytics.fct_video_daily_metrics
[0m16:28:58.146816 [debug] [Thread-4 (]: Began compiling node model.youtube_analytics.video_latest_snapshot
[0m16:28:58.160428 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_analytics.fct_video_daily_metrics"
[0m16:28:58.169854 [debug] [Thread-4 (]: Writing injected SQL for node "model.youtube_analytics.video_latest_snapshot"
[0m16:28:58.172198 [debug] [Thread-1 (]: Began executing node model.youtube_analytics.fct_video_daily_metrics
[0m16:28:58.240715 [debug] [Thread-4 (]: Began executing node model.youtube_analytics.video_latest_snapshot
[0m16:28:58.307549 [debug] [Thread-4 (]: Writing runtime sql for node "model.youtube_analytics.video_latest_snapshot"
[0m16:28:58.325889 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_analytics.fct_video_daily_metrics"
[0m16:28:58.327902 [debug] [Thread-4 (]: On model.youtube_analytics.video_latest_snapshot: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.video_latest_snapshot"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_analytics`.`video_latest_snapshot`
  OPTIONS()
  as 

with ranked as (
  select
    s.video_id,
    s.channel_id,
    s.video_title,
    s.video_published_at,
    s.views,
    s.likes,
    s.comments,
    s.duration_seconds,
    s.load_date,
    row_number() over (partition by s.video_id order by s.load_date desc) as rn
  from `orbital-nuance-471817-n0`.`youtube_stg`.`stg_youtube_video_stats` s
)
select
  r.video_id,
  r.channel_id,
  r.video_title,
  r.video_published_at,
  r.views,
  r.likes,
  r.comments,
  r.duration_seconds,
  r.load_date as snapshot_date
from ranked r
where rn = 1;


[0m16:28:58.327902 [debug] [Thread-1 (]: On model.youtube_analytics.fct_video_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.fct_video_daily_metrics"} */

  
    

    create or replace table `orbital-nuance-471817-n0`.`youtube_analytics`.`fct_video_daily_metrics`
      
    partition by load_date
    cluster by channel_id, video_id

    
    OPTIONS()
    as (
      

-- 1) Read from staging and LIMIT to needed dates on incremental
with src_raw as (
  select
    video_id,
    channel_id,
    load_date,
    views,
    likes,
    comments
  from `orbital-nuance-471817-n0`.`youtube_stg`.`stg_youtube_video_stats`
  
),

-- 2) Deduplicate: keep one row per (video_id, load_date)
--    If there are multiple, take the MAX of counters (monotonic metrics).
src as (
  select
    video_id,
    any_value(channel_id) as channel_id,
    load_date,
    max(views)    as views,
    max(likes)    as likes,
    max(comments) as comments
  from src_raw
  group by video_id, load_date
),

with_lag as (
  select
    *,
    lag(views)    over (partition by video_id order by load_date) as prev_views,
    lag(likes)    over (partition by video_id order by load_date) as prev_likes,
    lag(comments) over (partition by video_id order by load_date) as prev_comments
  from src
)

select
  video_id,
  channel_id,
  load_date,
  views,
  likes,
  comments,
  views    - coalesce(prev_views, 0)    as daily_views,
  likes    - coalesce(prev_likes, 0)    as daily_likes,
  comments - coalesce(prev_comments, 0) as daily_comments
from with_lag
    );
  
[0m16:28:58.333482 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:28:58.342192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:28:59.209627 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:77d4d287-752e-403b-9735-63a24021fecb&page=queryresults
[0m16:28:59.266517 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:69501ca2-d859-4b19-9d3f-25055a852972&page=queryresults
[0m16:28:59.568837 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22217665-9a61-41e8-9b50-a97d5de3da8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F639AE9D0>]}
[0m16:28:59.569842 [info ] [Thread-4 (]: 6 of 7 OK created sql view model youtube_analytics.video_latest_snapshot ....... [[32mCREATE VIEW (0 processed)[0m in 1.42s]
[0m16:28:59.569842 [debug] [Thread-4 (]: Finished running node model.youtube_analytics.video_latest_snapshot
[0m16:29:01.569619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22217665-9a61-41e8-9b50-a97d5de3da8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F639DA850>]}
[0m16:29:01.569619 [info ] [Thread-1 (]: 5 of 7 OK created sql incremental model youtube_analytics.fct_video_daily_metrics  [[32mCREATE TABLE (20.0 rows, 1.2 KiB processed)[0m in 3.43s]
[0m16:29:01.569619 [debug] [Thread-1 (]: Finished running node model.youtube_analytics.fct_video_daily_metrics
[0m16:29:01.569619 [debug] [Thread-3 (]: Began running node model.youtube_analytics.agg_channel_trends_7d
[0m16:29:01.569619 [info ] [Thread-3 (]: 7 of 7 START sql view model youtube_analytics.agg_channel_trends_7d ............ [RUN]
[0m16:29:01.582752 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.youtube_analytics.stg_youtube_video_stats, now model.youtube_analytics.agg_channel_trends_7d)
[0m16:29:01.582752 [debug] [Thread-3 (]: Began compiling node model.youtube_analytics.agg_channel_trends_7d
[0m16:29:01.591005 [debug] [Thread-3 (]: Writing injected SQL for node "model.youtube_analytics.agg_channel_trends_7d"
[0m16:29:01.593024 [debug] [Thread-3 (]: Began executing node model.youtube_analytics.agg_channel_trends_7d
[0m16:29:01.600981 [debug] [Thread-3 (]: Writing runtime sql for node "model.youtube_analytics.agg_channel_trends_7d"
[0m16:29:01.605429 [debug] [Thread-3 (]: On model.youtube_analytics.agg_channel_trends_7d: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.agg_channel_trends_7d"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_analytics`.`agg_channel_trends_7d`
  OPTIONS()
  as 

with daily as (
  select
    channel_id,
    video_id,
    load_date,
    daily_views,
    daily_likes,
    daily_comments
  from `orbital-nuance-471817-n0`.`youtube_analytics`.`fct_video_daily_metrics`
),
rollup_cte as (
  select
    channel_id,
    load_date,
    sum(daily_views)    over (
      partition by channel_id
      order by load_date
      rows between 6 preceding and current row
    ) as views_7d,
    sum(daily_likes)    over (
      partition by channel_id
      order by load_date
      rows between 6 preceding and current row
    ) as likes_7d,
    sum(daily_comments) over (
      partition by channel_id
      order by load_date
      rows between 6 preceding and current row
    ) as comments_7d
  from daily
)
select distinct channel_id, load_date, views_7d, likes_7d, comments_7d
from rollup_cte;


[0m16:29:01.606639 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:29:02.237455 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:092e55f4-90aa-40e5-be1e-dae827b0dbe4&page=queryresults
[0m16:29:02.577192 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22217665-9a61-41e8-9b50-a97d5de3da8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F6223F890>]}
[0m16:29:02.577192 [info ] [Thread-3 (]: 7 of 7 OK created sql view model youtube_analytics.agg_channel_trends_7d ....... [[32mCREATE VIEW (0 processed)[0m in 1.00s]
[0m16:29:02.577192 [debug] [Thread-3 (]: Finished running node model.youtube_analytics.agg_channel_trends_7d
[0m16:29:02.577192 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:02.583432 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:29:02.583432 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0' was properly closed.
[0m16:29:02.583432 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0' was properly closed.
[0m16:29:02.583432 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_analytics' was properly closed.
[0m16:29:02.583432 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg' was properly closed.
[0m16:29:02.583432 [debug] [MainThread]: Connection 'model.youtube_analytics.fct_video_daily_metrics' was properly closed.
[0m16:29:02.583432 [debug] [MainThread]: Connection 'model.youtube_analytics.stg_youtube_video_ids' was properly closed.
[0m16:29:02.583432 [debug] [MainThread]: Connection 'model.youtube_analytics.agg_channel_trends_7d' was properly closed.
[0m16:29:02.583432 [debug] [MainThread]: Connection 'model.youtube_analytics.video_latest_snapshot' was properly closed.
[0m16:29:02.599228 [info ] [MainThread]: 
[0m16:29:02.600635 [info ] [MainThread]: Finished running 1 incremental model, 6 view models in 0 hours 0 minutes and 7.19 seconds (7.19s).
[0m16:29:02.600635 [debug] [MainThread]: Command end result
[0m16:29:02.661034 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m16:29:02.676951 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m16:29:02.692993 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\run_results.json
[0m16:29:02.692993 [info ] [MainThread]: 
[0m16:29:02.709129 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m16:29:02.709129 [info ] [MainThread]: 
[0m16:29:02.709129 [error] [MainThread]: [31mFailure in model stg_youtube_channels (dbt/models\staging\stg_youtube_channels.sql)[0m
[0m16:29:02.709129 [error] [MainThread]:   Database Error in model stg_youtube_channels (dbt/models\staging\stg_youtube_channels.sql)
  Unrecognized name: _partitiontime at [15:10]
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_channels.sql
[0m16:29:02.709129 [info ] [MainThread]: 
[0m16:29:02.709129 [info ] [MainThread]:   compiled code at target\compiled\youtube_analytics\dbt/models\staging\stg_youtube_channels.sql
[0m16:29:02.709129 [info ] [MainThread]: 
[0m16:29:02.709129 [error] [MainThread]: [31mFailure in model stg_youtube_video_ids (dbt/models\staging\stg_youtube_video_ids.sql)[0m
[0m16:29:02.709129 [error] [MainThread]:   Database Error in model stg_youtube_video_ids (dbt/models\staging\stg_youtube_video_ids.sql)
  Unrecognized name: _partitiontime at [9:8]
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_video_ids.sql
[0m16:29:02.709129 [info ] [MainThread]: 
[0m16:29:02.709129 [info ] [MainThread]:   compiled code at target\compiled\youtube_analytics\dbt/models\staging\stg_youtube_video_ids.sql
[0m16:29:02.709129 [info ] [MainThread]: 
[0m16:29:02.709129 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=1 NO-OP=0 TOTAL=7
[0m16:29:02.725164 [debug] [MainThread]: Command `dbt run` failed at 16:29:02.725164 after 18.02 seconds
[0m16:29:02.725164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F3488DA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F348FD4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F348FFAD0>]}
[0m16:29:02.725164 [debug] [MainThread]: Flushing usage events
[0m16:29:03.315626 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:35:45.770253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD7C869A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD7CB9DD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD7CC02990>]}


============================== 16:35:45.770253 | 6930522d-4b0a-4e85-b8ea-309bd3dbab21 ==============================
[0m16:35:45.770253 [info ] [MainThread]: Running with dbt=1.10.11
[0m16:35:45.770253 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --full-refresh', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\logs', 'profiles_dir': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m16:35:50.926312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6930522d-4b0a-4e85-b8ea-309bd3dbab21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD29A752D0>]}
[0m16:35:51.110564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6930522d-4b0a-4e85-b8ea-309bd3dbab21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD795674D0>]}
[0m16:35:51.112576 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m16:35:52.803279 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m16:35:53.207923 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:35:53.223845 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:35:53.330866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6930522d-4b0a-4e85-b8ea-309bd3dbab21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD29FA8C90>]}
[0m16:35:53.485662 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m16:35:53.491213 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m16:35:53.559271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6930522d-4b0a-4e85-b8ea-309bd3dbab21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD29FE6090>]}
[0m16:35:53.563949 [info ] [MainThread]: Found 7 models, 5 data tests, 496 macros
[0m16:35:53.565963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6930522d-4b0a-4e85-b8ea-309bd3dbab21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD2A1811D0>]}
[0m16:35:53.567718 [info ] [MainThread]: 
[0m16:35:53.567718 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m16:35:53.573244 [info ] [MainThread]: 
[0m16:35:53.575250 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:35:53.583495 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0'
[0m16:35:53.583495 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0'
[0m16:35:53.583495 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:53.583495 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:54.239732 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg'
[0m16:35:54.239732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:54.239732 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_analytics'
[0m16:35:54.321265 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:54.870329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6930522d-4b0a-4e85-b8ea-309bd3dbab21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD78AFEE90>]}
[0m16:35:54.870329 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:35:54.879993 [debug] [Thread-1 (]: Began running node model.youtube_analytics.stg_youtube_channels
[0m16:35:54.879993 [debug] [Thread-2 (]: Began running node model.youtube_analytics.stg_youtube_video_ids
[0m16:35:54.888757 [debug] [Thread-3 (]: Began running node model.youtube_analytics.stg_youtube_video_stats
[0m16:35:54.888757 [info ] [Thread-1 (]: 1 of 7 START sql view model youtube_stg.stg_youtube_channels ................... [RUN]
[0m16:35:54.888757 [info ] [Thread-2 (]: 2 of 7 START sql view model youtube_stg.stg_youtube_video_ids .................. [RUN]
[0m16:35:54.888757 [info ] [Thread-3 (]: 3 of 7 START sql view model youtube_stg.stg_youtube_video_stats ................ [RUN]
[0m16:35:54.894198 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_channels'
[0m16:35:54.895689 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_video_ids'
[0m16:35:54.895689 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_video_stats'
[0m16:35:54.895689 [debug] [Thread-1 (]: Began compiling node model.youtube_analytics.stg_youtube_channels
[0m16:35:54.900930 [debug] [Thread-2 (]: Began compiling node model.youtube_analytics.stg_youtube_video_ids
[0m16:35:54.902572 [debug] [Thread-3 (]: Began compiling node model.youtube_analytics.stg_youtube_video_stats
[0m16:35:54.918791 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_channels"
[0m16:35:54.923816 [debug] [Thread-2 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_video_ids"
[0m16:35:54.929353 [debug] [Thread-3 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_video_stats"
[0m16:35:54.932262 [debug] [Thread-1 (]: Began executing node model.youtube_analytics.stg_youtube_channels
[0m16:35:54.933473 [debug] [Thread-2 (]: Began executing node model.youtube_analytics.stg_youtube_video_ids
[0m16:35:54.973655 [debug] [Thread-3 (]: Began executing node model.youtube_analytics.stg_youtube_video_stats
[0m16:35:55.005608 [debug] [Thread-2 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_video_ids"
[0m16:35:55.021481 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_channels"
[0m16:35:55.033339 [debug] [Thread-3 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_video_stats"
[0m16:35:55.033339 [debug] [Thread-2 (]: On model.youtube_analytics.stg_youtube_video_ids: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_video_ids"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg`.`stg_youtube_video_ids`
  OPTIONS()
  as select
  videoId              as video_id,
  channelId            as channel_id,
  date(_partitiontime) as load_date
from `orbital-nuance-471817-n0.youtube_raw.video_ids_raw`;


[0m16:35:55.037572 [debug] [Thread-1 (]: On model.youtube_analytics.stg_youtube_channels: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_channels"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg`.`stg_youtube_channels`
  OPTIONS()
  as with src as (
  select
    id                                        as channel_id,
    snippet.title                             as channel_title,
    snippet.country                           as channel_country,
    snippet.publishedAt                       as channel_published_at,
    cast(statistics.viewCount       as int64) as channel_view_count,
    cast(statistics.subscriberCount as int64) as channel_subscribers,
    cast(statistics.videoCount      as int64) as channel_video_count,
    date(_partitiontime)                      as load_date
  from `orbital-nuance-471817-n0.youtube_raw.channels_raw`
)
select * from src;


[0m16:35:55.037572 [debug] [Thread-3 (]: On model.youtube_analytics.stg_youtube_video_stats: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_video_stats"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg`.`stg_youtube_video_stats`
  OPTIONS()
  as with src as (
  select
    id                                     as video_id,
    snippet.channelId                      as channel_id,
    snippet.title                          as video_title,
    snippet.publishedAt                    as video_published_at,
    cast(statistics.viewCount    as int64) as views,
    cast(statistics.likeCount    as int64) as likes,
    cast(statistics.commentCount as int64) as comments,
    contentDetails.duration                as duration_iso,
    current_date()                         as load_date
  from `orbital-nuance-471817-n0.youtube_raw.video_stats_raw`
),
parsed as (
  select
    *,
    (
      coalesce(SAFE_CAST(REGEXP_EXTRACT(duration_iso, r'(\d+)H') AS INT64), 0) * 3600
      + coalesce(SAFE_CAST(REGEXP_EXTRACT(duration_iso, r'(\d+)M') AS INT64), 0) * 60
      + coalesce(SAFE_CAST(REGEXP_EXTRACT(duration_iso, r'(\d+)S') AS INT64), 0)
    ) as duration_seconds
  from src
)
select * from parsed;


[0m16:35:55.037572 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:35:55.037572 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:35:55.037572 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:35:55.825882 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:37a3ba36-d299-4e41-9be2-4ee51c346ae6&page=queryresults
[0m16:35:55.833066 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:1b3278a0-7a4c-4ba0-960c-dad5ce4e0b8b&page=queryresults
[0m16:35:55.848956 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:ee2e6414-d981-4f3f-bed7-529ce94a7eb4&page=queryresults
[0m16:35:56.395961 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6930522d-4b0a-4e85-b8ea-309bd3dbab21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD29F2E290>]}
[0m16:35:56.395961 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6930522d-4b0a-4e85-b8ea-309bd3dbab21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD29A7BF10>]}
[0m16:35:56.400502 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6930522d-4b0a-4e85-b8ea-309bd3dbab21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD29F2FC50>]}
[0m16:35:56.395961 [info ] [Thread-2 (]: 2 of 7 OK created sql view model youtube_stg.stg_youtube_video_ids ............. [[32mCREATE VIEW (0 processed)[0m in 1.49s]
[0m16:35:56.400502 [info ] [Thread-3 (]: 3 of 7 OK created sql view model youtube_stg.stg_youtube_video_stats ........... [[32mCREATE VIEW (0 processed)[0m in 1.49s]
[0m16:35:56.403586 [info ] [Thread-1 (]: 1 of 7 OK created sql view model youtube_stg.stg_youtube_channels .............. [[32mCREATE VIEW (0 processed)[0m in 1.50s]
[0m16:35:56.403586 [debug] [Thread-2 (]: Finished running node model.youtube_analytics.stg_youtube_video_ids
[0m16:35:56.407479 [debug] [Thread-3 (]: Finished running node model.youtube_analytics.stg_youtube_video_stats
[0m16:35:56.407479 [debug] [Thread-1 (]: Finished running node model.youtube_analytics.stg_youtube_channels
[0m16:35:56.411889 [debug] [Thread-4 (]: Began running node model.youtube_analytics.fct_video_daily_metrics
[0m16:35:56.411889 [debug] [Thread-1 (]: Began running node model.youtube_analytics.video_latest_snapshot
[0m16:35:56.411889 [debug] [Thread-3 (]: Began running node model.youtube_analytics.dim_channel
[0m16:35:56.411889 [info ] [Thread-4 (]: 4 of 7 START sql incremental model youtube_analytics.fct_video_daily_metrics ... [RUN]
[0m16:35:56.411889 [info ] [Thread-1 (]: 5 of 7 START sql view model youtube_analytics.video_latest_snapshot ............ [RUN]
[0m16:35:56.411889 [info ] [Thread-3 (]: 6 of 7 START sql view model youtube_analytics.dim_channel ...................... [RUN]
[0m16:35:56.411889 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.youtube_analytics.fct_video_daily_metrics'
[0m16:35:56.411889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.youtube_analytics.stg_youtube_channels, now model.youtube_analytics.video_latest_snapshot)
[0m16:35:56.427644 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.youtube_analytics.stg_youtube_video_stats, now model.youtube_analytics.dim_channel)
[0m16:35:56.429564 [debug] [Thread-4 (]: Began compiling node model.youtube_analytics.fct_video_daily_metrics
[0m16:35:56.430560 [debug] [Thread-1 (]: Began compiling node model.youtube_analytics.video_latest_snapshot
[0m16:35:56.432676 [debug] [Thread-3 (]: Began compiling node model.youtube_analytics.dim_channel
[0m16:35:56.457067 [debug] [Thread-4 (]: Writing injected SQL for node "model.youtube_analytics.fct_video_daily_metrics"
[0m16:35:56.465453 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_analytics.video_latest_snapshot"
[0m16:35:56.473447 [debug] [Thread-3 (]: Writing injected SQL for node "model.youtube_analytics.dim_channel"
[0m16:35:56.477347 [debug] [Thread-4 (]: Began executing node model.youtube_analytics.fct_video_daily_metrics
[0m16:35:56.520213 [debug] [Thread-3 (]: Began executing node model.youtube_analytics.dim_channel
[0m16:35:56.567563 [debug] [Thread-1 (]: Began executing node model.youtube_analytics.video_latest_snapshot
[0m16:35:56.571980 [debug] [Thread-3 (]: Writing runtime sql for node "model.youtube_analytics.dim_channel"
[0m16:35:56.578492 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:35:56.591839 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_analytics.video_latest_snapshot"
[0m16:35:56.596832 [debug] [Thread-3 (]: On model.youtube_analytics.dim_channel: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.dim_channel"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_analytics`.`dim_channel`
  OPTIONS()
  as 

with ranked as (
  select
    channel_id,
    channel_title,
    channel_country,
    channel_published_at,
    channel_view_count,
    channel_subscribers,
    channel_video_count,
    load_date,
    row_number() over (partition by channel_id order by load_date desc) as rn
  from `orbital-nuance-471817-n0`.`youtube_stg`.`stg_youtube_channels`
)
select
  channel_id,
  channel_title,
  channel_country,
  channel_published_at,
  channel_view_count,
  channel_subscribers,
  channel_video_count,
  load_date as snapshot_date
from ranked
where rn = 1;


[0m16:35:56.663169 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:35:56.663169 [debug] [Thread-1 (]: On model.youtube_analytics.video_latest_snapshot: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.video_latest_snapshot"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_analytics`.`video_latest_snapshot`
  OPTIONS()
  as 

with ranked as (
  select
    s.video_id,
    s.channel_id,
    s.video_title,
    s.video_published_at,
    s.views,
    s.likes,
    s.comments,
    s.duration_seconds,
    s.load_date,
    row_number() over (partition by s.video_id order by s.load_date desc) as rn
  from `orbital-nuance-471817-n0`.`youtube_stg`.`stg_youtube_video_stats` s
)
select
  r.video_id,
  r.channel_id,
  r.video_title,
  r.video_published_at,
  r.views,
  r.likes,
  r.comments,
  r.duration_seconds,
  r.load_date as snapshot_date
from ranked r
where rn = 1;


[0m16:35:56.740136 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:35:57.199104 [debug] [Thread-4 (]: Writing runtime sql for node "model.youtube_analytics.fct_video_daily_metrics"
[0m16:35:57.201108 [debug] [Thread-4 (]: On model.youtube_analytics.fct_video_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.fct_video_daily_metrics"} */

  
    

    create or replace table `orbital-nuance-471817-n0`.`youtube_analytics`.`fct_video_daily_metrics`
      
    partition by load_date
    cluster by channel_id, video_id

    
    OPTIONS()
    as (
      

-- 1) Read from staging and LIMIT to needed dates on incremental
with src_raw as (
  select
    video_id,
    channel_id,
    load_date,
    views,
    likes,
    comments
  from `orbital-nuance-471817-n0`.`youtube_stg`.`stg_youtube_video_stats`
  
),

-- 2) Deduplicate: keep one row per (video_id, load_date)
--    If there are multiple, take the MAX of counters (monotonic metrics).
src as (
  select
    video_id,
    any_value(channel_id) as channel_id,
    load_date,
    max(views)    as views,
    max(likes)    as likes,
    max(comments) as comments
  from src_raw
  group by video_id, load_date
),

with_lag as (
  select
    *,
    lag(views)    over (partition by video_id order by load_date) as prev_views,
    lag(likes)    over (partition by video_id order by load_date) as prev_likes,
    lag(comments) over (partition by video_id order by load_date) as prev_comments
  from src
)

select
  video_id,
  channel_id,
  load_date,
  views,
  likes,
  comments,
  views    - coalesce(prev_views, 0)    as daily_views,
  likes    - coalesce(prev_likes, 0)    as daily_likes,
  comments - coalesce(prev_comments, 0) as daily_comments
from with_lag
    );
  
[0m16:35:57.490198 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:9503f278-6e27-40ed-9af7-cee88d4bb860&page=queryresults
[0m16:35:57.611353 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:8f86cb14-f124-4255-b750-a46a1d8cb26c&page=queryresults
[0m16:35:57.797589 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:f045845a-ddf3-4ad8-a7c8-5e0533d20982&page=queryresults
[0m16:35:57.889205 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6930522d-4b0a-4e85-b8ea-309bd3dbab21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD2AA06150>]}
[0m16:35:57.890207 [info ] [Thread-1 (]: 5 of 7 OK created sql view model youtube_analytics.video_latest_snapshot ....... [[32mCREATE VIEW (0 processed)[0m in 1.48s]
[0m16:35:57.890207 [debug] [Thread-1 (]: Finished running node model.youtube_analytics.video_latest_snapshot
[0m16:35:57.958674 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6930522d-4b0a-4e85-b8ea-309bd3dbab21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD29F98ED0>]}
[0m16:35:57.958674 [info ] [Thread-3 (]: 6 of 7 OK created sql view model youtube_analytics.dim_channel ................. [[32mCREATE VIEW (0 processed)[0m in 1.53s]
[0m16:35:57.958674 [debug] [Thread-3 (]: Finished running node model.youtube_analytics.dim_channel
[0m16:36:00.435271 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6930522d-4b0a-4e85-b8ea-309bd3dbab21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD2A8A48D0>]}
[0m16:36:00.437278 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model youtube_analytics.fct_video_daily_metrics  [[32mCREATE TABLE (20.0 rows, 1.2 KiB processed)[0m in 4.02s]
[0m16:36:00.437278 [debug] [Thread-4 (]: Finished running node model.youtube_analytics.fct_video_daily_metrics
[0m16:36:00.437278 [debug] [Thread-2 (]: Began running node model.youtube_analytics.agg_channel_trends_7d
[0m16:36:00.441697 [info ] [Thread-2 (]: 7 of 7 START sql view model youtube_analytics.agg_channel_trends_7d ............ [RUN]
[0m16:36:00.441697 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.youtube_analytics.stg_youtube_video_ids, now model.youtube_analytics.agg_channel_trends_7d)
[0m16:36:00.444861 [debug] [Thread-2 (]: Began compiling node model.youtube_analytics.agg_channel_trends_7d
[0m16:36:00.447973 [debug] [Thread-2 (]: Writing injected SQL for node "model.youtube_analytics.agg_channel_trends_7d"
[0m16:36:00.447973 [debug] [Thread-2 (]: Began executing node model.youtube_analytics.agg_channel_trends_7d
[0m16:36:00.458847 [debug] [Thread-2 (]: Writing runtime sql for node "model.youtube_analytics.agg_channel_trends_7d"
[0m16:36:00.460861 [debug] [Thread-2 (]: On model.youtube_analytics.agg_channel_trends_7d: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.agg_channel_trends_7d"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_analytics`.`agg_channel_trends_7d`
  OPTIONS()
  as 

with daily as (
  select
    channel_id,
    video_id,
    load_date,
    daily_views,
    daily_likes,
    daily_comments
  from `orbital-nuance-471817-n0`.`youtube_analytics`.`fct_video_daily_metrics`
),
rollup_cte as (
  select
    channel_id,
    load_date,
    sum(daily_views)    over (
      partition by channel_id
      order by load_date
      rows between 6 preceding and current row
    ) as views_7d,
    sum(daily_likes)    over (
      partition by channel_id
      order by load_date
      rows between 6 preceding and current row
    ) as likes_7d,
    sum(daily_comments) over (
      partition by channel_id
      order by load_date
      rows between 6 preceding and current row
    ) as comments_7d
  from daily
)
select distinct channel_id, load_date, views_7d, likes_7d, comments_7d
from rollup_cte;


[0m16:36:00.462874 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:36:01.168546 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:7438afb6-e76f-48c5-95f7-625954f3823b&page=queryresults
[0m16:36:01.557917 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6930522d-4b0a-4e85-b8ea-309bd3dbab21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD2A197710>]}
[0m16:36:01.559922 [info ] [Thread-2 (]: 7 of 7 OK created sql view model youtube_analytics.agg_channel_trends_7d ....... [[32mCREATE VIEW (0 processed)[0m in 1.12s]
[0m16:36:01.559922 [debug] [Thread-2 (]: Finished running node model.youtube_analytics.agg_channel_trends_7d
[0m16:36:01.564949 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:36:01.568723 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:36:01.570738 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0' was properly closed.
[0m16:36:01.570738 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0' was properly closed.
[0m16:36:01.572756 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg' was properly closed.
[0m16:36:01.574769 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_analytics' was properly closed.
[0m16:36:01.574769 [debug] [MainThread]: Connection 'model.youtube_analytics.video_latest_snapshot' was properly closed.
[0m16:36:01.576782 [debug] [MainThread]: Connection 'model.youtube_analytics.agg_channel_trends_7d' was properly closed.
[0m16:36:01.576782 [debug] [MainThread]: Connection 'model.youtube_analytics.dim_channel' was properly closed.
[0m16:36:01.576782 [debug] [MainThread]: Connection 'model.youtube_analytics.fct_video_daily_metrics' was properly closed.
[0m16:36:01.576782 [info ] [MainThread]: 
[0m16:36:01.582748 [info ] [MainThread]: Finished running 1 incremental model, 6 view models in 0 hours 0 minutes and 8.00 seconds (8.00s).
[0m16:36:01.584484 [debug] [MainThread]: Command end result
[0m16:36:01.661370 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m16:36:01.661370 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m16:36:01.693204 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\run_results.json
[0m16:36:01.695223 [info ] [MainThread]: 
[0m16:36:01.695223 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:36:01.700379 [info ] [MainThread]: 
[0m16:36:01.700379 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m16:36:01.703815 [debug] [MainThread]: Command `dbt run` succeeded at 16:36:01.703815 after 16.00 seconds
[0m16:36:01.703815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD7CC0F050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD7C94F090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD76100050>]}
[0m16:36:01.705832 [debug] [MainThread]: Flushing usage events
[0m16:36:02.208769 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:36:11.740006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FBC5CCB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FBC626610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FBC624810>]}


============================== 16:36:11.746751 | 6ef91647-36fa-4099-a840-bf2a4fe23403 ==============================
[0m16:36:11.746751 [info ] [MainThread]: Running with dbt=1.10.11
[0m16:36:11.746751 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'empty': 'None', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m16:36:16.927263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ef91647-36fa-4099-a840-bf2a4fe23403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FE9494390>]}
[0m16:36:17.090865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ef91647-36fa-4099-a840-bf2a4fe23403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FB8F9C110>]}
[0m16:36:17.092671 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m16:36:18.615193 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m16:36:18.976153 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:36:18.978237 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:36:19.053176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ef91647-36fa-4099-a840-bf2a4fe23403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FE99CBE50>]}
[0m16:36:19.222750 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m16:36:19.222750 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m16:36:19.316831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ef91647-36fa-4099-a840-bf2a4fe23403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FE9C53C90>]}
[0m16:36:19.316831 [info ] [MainThread]: Found 7 models, 5 data tests, 496 macros
[0m16:36:19.322071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ef91647-36fa-4099-a840-bf2a4fe23403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FE99488D0>]}
[0m16:36:19.327381 [info ] [MainThread]: 
[0m16:36:19.327381 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m16:36:19.327381 [info ] [MainThread]: 
[0m16:36:19.332856 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:36:19.343412 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_analytics'
[0m16:36:19.343412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:19.348753 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg'
[0m16:36:19.422781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:20.032561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ef91647-36fa-4099-a840-bf2a4fe23403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FE933DA10>]}
[0m16:36:20.032561 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:36:20.048358 [debug] [Thread-1 (]: Began running node test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267
[0m16:36:20.049359 [debug] [Thread-2 (]: Began running node test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1
[0m16:36:20.049359 [debug] [Thread-3 (]: Began running node test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7
[0m16:36:20.049359 [debug] [Thread-4 (]: Began running node test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602
[0m16:36:20.049359 [info ] [Thread-1 (]: 1 of 5 START test not_null_fct_video_daily_metrics_load_date ................... [RUN]
[0m16:36:20.049359 [info ] [Thread-2 (]: 2 of 5 START test not_null_fct_video_daily_metrics_video_id .................... [RUN]
[0m16:36:20.049359 [info ] [Thread-3 (]: 3 of 5 START test not_null_stg_youtube_video_stats_load_date ................... [RUN]
[0m16:36:20.049359 [info ] [Thread-4 (]: 4 of 5 START test not_null_stg_youtube_video_stats_video_id .................... [RUN]
[0m16:36:20.049359 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267'
[0m16:36:20.059122 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1'
[0m16:36:20.062500 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7'
[0m16:36:20.063388 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602'
[0m16:36:20.065374 [debug] [Thread-1 (]: Began compiling node test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267
[0m16:36:20.065791 [debug] [Thread-2 (]: Began compiling node test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1
[0m16:36:20.065791 [debug] [Thread-3 (]: Began compiling node test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7
[0m16:36:20.065791 [debug] [Thread-4 (]: Began compiling node test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602
[0m16:36:20.099807 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267"
[0m16:36:20.116124 [debug] [Thread-2 (]: Writing injected SQL for node "test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1"
[0m16:36:20.126950 [debug] [Thread-3 (]: Writing injected SQL for node "test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7"
[0m16:36:20.134806 [debug] [Thread-4 (]: Writing injected SQL for node "test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602"
[0m16:36:20.137394 [debug] [Thread-1 (]: Began executing node test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267
[0m16:36:20.139395 [debug] [Thread-2 (]: Began executing node test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1
[0m16:36:20.141393 [debug] [Thread-3 (]: Began executing node test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7
[0m16:36:20.159230 [debug] [Thread-4 (]: Began executing node test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602
[0m16:36:20.187702 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267"
[0m16:36:20.192651 [debug] [Thread-2 (]: Writing runtime sql for node "test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1"
[0m16:36:20.198694 [debug] [Thread-3 (]: Writing runtime sql for node "test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7"
[0m16:36:20.204362 [debug] [Thread-4 (]: Writing runtime sql for node "test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602"
[0m16:36:20.207180 [debug] [Thread-1 (]: On test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select load_date
from `orbital-nuance-471817-n0`.`youtube_analytics`.`fct_video_daily_metrics`
where load_date is null



  
  
      
    ) dbt_internal_test
[0m16:36:20.209052 [debug] [Thread-2 (]: On test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select video_id
from `orbital-nuance-471817-n0`.`youtube_analytics`.`fct_video_daily_metrics`
where video_id is null



  
  
      
    ) dbt_internal_test
[0m16:36:20.211200 [debug] [Thread-3 (]: On test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select load_date
from `orbital-nuance-471817-n0`.`youtube_stg`.`stg_youtube_video_stats`
where load_date is null



  
  
      
    ) dbt_internal_test
[0m16:36:20.213319 [debug] [Thread-4 (]: On test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select video_id
from `orbital-nuance-471817-n0`.`youtube_stg`.`stg_youtube_video_stats`
where video_id is null



  
  
      
    ) dbt_internal_test
[0m16:36:20.214330 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:36:20.215954 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:36:20.215954 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:36:20.215954 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:36:21.157402 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:2f0d2091-e4b1-45cd-a978-9dca7f72b8d8&page=queryresults
[0m16:36:21.160992 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:17c61cdc-6d25-4a7d-8ef4-7f01782608e4&page=queryresults
[0m16:36:21.255187 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:b0f1fa18-fd82-419b-b9bf-7f6a4f8fef34&page=queryresults
[0m16:36:21.345477 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:13f990f8-b409-42b3-8fba-167c283d73ee&page=queryresults
[0m16:36:21.803332 [info ] [Thread-3 (]: 3 of 5 PASS not_null_stg_youtube_video_stats_load_date ......................... [[32mPASS[0m in 1.74s]
[0m16:36:21.804927 [debug] [Thread-3 (]: Finished running node test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7
[0m16:36:21.805448 [debug] [Thread-3 (]: Began running node test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e
[0m16:36:21.806516 [info ] [Thread-3 (]: 5 of 5 START test unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_  [RUN]
[0m16:36:21.806848 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7, now test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e)
[0m16:36:21.806848 [debug] [Thread-3 (]: Began compiling node test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e
[0m16:36:21.813566 [debug] [Thread-3 (]: Writing injected SQL for node "test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e"
[0m16:36:21.814568 [debug] [Thread-3 (]: Began executing node test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e
[0m16:36:21.816566 [debug] [Thread-3 (]: Writing runtime sql for node "test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e"
[0m16:36:21.817567 [debug] [Thread-3 (]: On test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select video_id || '-' || cast(load_date as string) as unique_field
  from `orbital-nuance-471817-n0`.`youtube_analytics`.`fct_video_daily_metrics`
  where video_id || '-' || cast(load_date as string) is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:36:21.817567 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:36:21.859552 [info ] [Thread-1 (]: 1 of 5 PASS not_null_fct_video_daily_metrics_load_date ......................... [[32mPASS[0m in 1.81s]
[0m16:36:21.863452 [debug] [Thread-1 (]: Finished running node test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267
[0m16:36:21.861451 [info ] [Thread-2 (]: 2 of 5 PASS not_null_fct_video_daily_metrics_video_id .......................... [[32mPASS[0m in 1.80s]
[0m16:36:21.864414 [debug] [Thread-2 (]: Finished running node test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1
[0m16:36:21.949024 [info ] [Thread-4 (]: 4 of 5 PASS not_null_stg_youtube_video_stats_video_id .......................... [[32mPASS[0m in 1.89s]
[0m16:36:21.950131 [debug] [Thread-4 (]: Finished running node test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602
[0m16:36:22.747281 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:28481e40-53e6-4c13-96cf-7e6b40dd9d43&page=queryresults
[0m16:36:23.316271 [info ] [Thread-3 (]: 5 of 5 PASS unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_ .. [[32mPASS[0m in 1.51s]
[0m16:36:23.316271 [debug] [Thread-3 (]: Finished running node test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e
[0m16:36:23.319875 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:36:23.323977 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:36:23.324984 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_analytics' was properly closed.
[0m16:36:23.326008 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg' was properly closed.
[0m16:36:23.326872 [debug] [MainThread]: Connection 'test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267' was properly closed.
[0m16:36:23.328164 [debug] [MainThread]: Connection 'test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1' was properly closed.
[0m16:36:23.329281 [debug] [MainThread]: Connection 'test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e' was properly closed.
[0m16:36:23.330186 [debug] [MainThread]: Connection 'test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602' was properly closed.
[0m16:36:23.331186 [info ] [MainThread]: 
[0m16:36:23.333186 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 4.00 seconds (4.00s).
[0m16:36:23.333186 [debug] [MainThread]: Command end result
[0m16:36:23.389719 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m16:36:23.396885 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m16:36:23.398214 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\run_results.json
[0m16:36:23.413061 [info ] [MainThread]: 
[0m16:36:23.413061 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:36:23.413061 [info ] [MainThread]: 
[0m16:36:23.419606 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m16:36:23.419606 [debug] [MainThread]: Command `dbt test` succeeded at 16:36:23.419606 after 11.74 seconds
[0m16:36:23.419606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FBC624090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FBC36F2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FB5B40090>]}
[0m16:36:23.419606 [debug] [MainThread]: Flushing usage events
[0m16:36:23.818591 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:57:02.408635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB5924EF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB5924F090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB58D5FB90>]}


============================== 12:57:02.423847 | 082a26e4-baba-4d5d-ae7a-e13c8c312724 ==============================
[0m12:57:02.423847 [info ] [MainThread]: Running with dbt=1.10.11
[0m12:57:02.423847 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'empty': 'False', 'quiet': 'False', 'log_path': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m12:57:12.352940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '082a26e4-baba-4d5d-ae7a-e13c8c312724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB063F4290>]}
[0m12:57:12.553778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '082a26e4-baba-4d5d-ae7a-e13c8c312724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB55E55B50>]}
[0m12:57:12.556759 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m12:57:14.473882 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m12:57:17.092812 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:57:17.092812 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:57:17.178201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '082a26e4-baba-4d5d-ae7a-e13c8c312724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB0690CA10>]}
[0m12:57:17.372898 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m12:57:17.421145 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m12:57:17.510730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '082a26e4-baba-4d5d-ae7a-e13c8c312724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB064EE910>]}
[0m12:57:17.513793 [info ] [MainThread]: Found 7 models, 5 data tests, 496 macros
[0m12:57:17.513793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '082a26e4-baba-4d5d-ae7a-e13c8c312724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB06456F90>]}
[0m12:57:17.513793 [info ] [MainThread]: 
[0m12:57:17.513793 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m12:57:17.513793 [info ] [MainThread]: 
[0m12:57:17.513793 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:57:17.529779 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0'
[0m12:57:17.529779 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:17.545849 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0'
[0m12:57:17.610708 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:18.097963 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg'
[0m12:57:18.103284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:18.103284 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_analytics'
[0m12:57:18.103284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:18.678940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '082a26e4-baba-4d5d-ae7a-e13c8c312724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB59584F50>]}
[0m12:57:18.678940 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:57:18.692488 [debug] [Thread-1 (]: Began running node model.youtube_analytics.stg_youtube_channels
[0m12:57:18.692488 [debug] [Thread-2 (]: Began running node model.youtube_analytics.stg_youtube_video_ids
[0m12:57:18.692488 [debug] [Thread-3 (]: Began running node model.youtube_analytics.stg_youtube_video_stats
[0m12:57:18.692488 [info ] [Thread-1 (]: 1 of 7 START sql view model youtube_stg.stg_youtube_channels ................... [RUN]
[0m12:57:18.692488 [info ] [Thread-2 (]: 2 of 7 START sql view model youtube_stg.stg_youtube_video_ids .................. [RUN]
[0m12:57:18.700369 [info ] [Thread-3 (]: 3 of 7 START sql view model youtube_stg.stg_youtube_video_stats ................ [RUN]
[0m12:57:18.701503 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_channels'
[0m12:57:18.704058 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_video_ids'
[0m12:57:18.704058 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_video_stats'
[0m12:57:18.706071 [debug] [Thread-1 (]: Began compiling node model.youtube_analytics.stg_youtube_channels
[0m12:57:18.706071 [debug] [Thread-2 (]: Began compiling node model.youtube_analytics.stg_youtube_video_ids
[0m12:57:18.706071 [debug] [Thread-3 (]: Began compiling node model.youtube_analytics.stg_youtube_video_stats
[0m12:57:18.733615 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_channels"
[0m12:57:18.733615 [debug] [Thread-2 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_video_ids"
[0m12:57:18.749537 [debug] [Thread-3 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_video_stats"
[0m12:57:18.749537 [debug] [Thread-1 (]: Began executing node model.youtube_analytics.stg_youtube_channels
[0m12:57:18.749537 [debug] [Thread-2 (]: Began executing node model.youtube_analytics.stg_youtube_video_ids
[0m12:57:18.826422 [debug] [Thread-3 (]: Began executing node model.youtube_analytics.stg_youtube_video_stats
[0m12:57:18.836025 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_channels"
[0m12:57:18.842370 [debug] [Thread-2 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_video_ids"
[0m12:57:18.851786 [debug] [Thread-3 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_video_stats"
[0m12:57:18.851786 [debug] [Thread-1 (]: On model.youtube_analytics.stg_youtube_channels: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_channels"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg`.`stg_youtube_channels`
  OPTIONS()
  as with src as (
  select
    id                                        as channel_id,
    snippet.title                             as channel_title,
    snippet.country                           as channel_country,
    snippet.publishedAt                       as channel_published_at,
    cast(statistics.viewCount       as int64) as channel_view_count,
    cast(statistics.subscriberCount as int64) as channel_subscribers,
    cast(statistics.videoCount      as int64) as channel_video_count,
    date(_partitiontime)                      as load_date
  from `orbital-nuance-471817-n0.youtube_raw.channels_raw`
)
select * from src;


[0m12:57:18.858087 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:57:18.860099 [debug] [Thread-2 (]: On model.youtube_analytics.stg_youtube_video_ids: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_video_ids"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg`.`stg_youtube_video_ids`
  OPTIONS()
  as select
  videoId              as video_id,
  channelId            as channel_id,
  date(_partitiontime) as load_date
from `orbital-nuance-471817-n0.youtube_raw.video_ids_raw`;


[0m12:57:18.920052 [debug] [Thread-3 (]: On model.youtube_analytics.stg_youtube_video_stats: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_video_stats"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg`.`stg_youtube_video_stats`
  OPTIONS()
  as with src as (
  select
    id                                     as video_id,
    snippet.channelId                      as channel_id,
    snippet.title                          as video_title,
    snippet.publishedAt                    as video_published_at,
    cast(statistics.viewCount    as int64) as views,
    cast(statistics.likeCount    as int64) as likes,
    cast(statistics.commentCount as int64) as comments,
    contentDetails.duration                as duration_iso,
    current_date()                         as load_date
  from `orbital-nuance-471817-n0.youtube_raw.video_stats_raw`
),
parsed as (
  select
    *,
    (
      coalesce(SAFE_CAST(REGEXP_EXTRACT(duration_iso, r'(\d+)H') AS INT64), 0) * 3600
      + coalesce(SAFE_CAST(REGEXP_EXTRACT(duration_iso, r'(\d+)M') AS INT64), 0) * 60
      + coalesce(SAFE_CAST(REGEXP_EXTRACT(duration_iso, r'(\d+)S') AS INT64), 0)
    ) as duration_seconds
  from src
)
select * from parsed;


[0m12:57:18.920052 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:57:18.920052 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:57:19.626243 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:b4f4fc21-1c03-45a4-aec1-84070559cbd8&page=queryresults
[0m12:57:19.672329 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:5e96d7fd-7d3d-49d4-84a8-1173375f6443&page=queryresults
[0m12:57:19.718121 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:42ba2c05-0ba7-4dd8-9282-7eefcbc3debd&page=queryresults
[0m12:57:24.764587 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '082a26e4-baba-4d5d-ae7a-e13c8c312724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB06C09850>]}
[0m12:57:24.764587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '082a26e4-baba-4d5d-ae7a-e13c8c312724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB06B3BED0>]}
[0m12:57:24.764587 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '082a26e4-baba-4d5d-ae7a-e13c8c312724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB07171C50>]}
[0m12:57:24.764587 [info ] [Thread-3 (]: 3 of 7 OK created sql view model youtube_stg.stg_youtube_video_stats ........... [[32mCREATE VIEW (0 processed)[0m in 6.05s]
[0m12:57:24.773215 [info ] [Thread-1 (]: 1 of 7 OK created sql view model youtube_stg.stg_youtube_channels .............. [[32mCREATE VIEW (0 processed)[0m in 6.06s]
[0m12:57:24.773215 [info ] [Thread-2 (]: 2 of 7 OK created sql view model youtube_stg.stg_youtube_video_ids ............. [[32mCREATE VIEW (0 processed)[0m in 6.06s]
[0m12:57:24.777166 [debug] [Thread-3 (]: Finished running node model.youtube_analytics.stg_youtube_video_stats
[0m12:57:24.777166 [debug] [Thread-1 (]: Finished running node model.youtube_analytics.stg_youtube_channels
[0m12:57:24.780464 [debug] [Thread-2 (]: Finished running node model.youtube_analytics.stg_youtube_video_ids
[0m12:57:24.783022 [debug] [Thread-4 (]: Began running node model.youtube_analytics.fct_video_daily_metrics
[0m12:57:24.784036 [debug] [Thread-3 (]: Began running node model.youtube_analytics.video_latest_snapshot
[0m12:57:24.785178 [debug] [Thread-1 (]: Began running node model.youtube_analytics.dim_channel
[0m12:57:24.787177 [info ] [Thread-4 (]: 4 of 7 START sql incremental model youtube_analytics.fct_video_daily_metrics ... [RUN]
[0m12:57:24.789178 [info ] [Thread-3 (]: 5 of 7 START sql view model youtube_analytics.video_latest_snapshot ............ [RUN]
[0m12:57:24.791175 [info ] [Thread-1 (]: 6 of 7 START sql view model youtube_analytics.dim_channel ...................... [RUN]
[0m12:57:24.793171 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.youtube_analytics.fct_video_daily_metrics'
[0m12:57:24.794174 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.youtube_analytics.stg_youtube_video_stats, now model.youtube_analytics.video_latest_snapshot)
[0m12:57:24.795174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.youtube_analytics.stg_youtube_channels, now model.youtube_analytics.dim_channel)
[0m12:57:24.795174 [debug] [Thread-4 (]: Began compiling node model.youtube_analytics.fct_video_daily_metrics
[0m12:57:24.795174 [debug] [Thread-3 (]: Began compiling node model.youtube_analytics.video_latest_snapshot
[0m12:57:24.795174 [debug] [Thread-1 (]: Began compiling node model.youtube_analytics.dim_channel
[0m12:57:24.813174 [debug] [Thread-4 (]: Writing injected SQL for node "model.youtube_analytics.fct_video_daily_metrics"
[0m12:57:24.813174 [debug] [Thread-3 (]: Writing injected SQL for node "model.youtube_analytics.video_latest_snapshot"
[0m12:57:24.828250 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_analytics.dim_channel"
[0m12:57:24.828250 [debug] [Thread-4 (]: Began executing node model.youtube_analytics.fct_video_daily_metrics
[0m12:57:24.828250 [debug] [Thread-3 (]: Began executing node model.youtube_analytics.video_latest_snapshot
[0m12:57:24.874532 [debug] [Thread-1 (]: Began executing node model.youtube_analytics.dim_channel
[0m12:57:24.920701 [debug] [Thread-3 (]: Writing runtime sql for node "model.youtube_analytics.video_latest_snapshot"
[0m12:57:24.932544 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:57:24.936511 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_analytics.dim_channel"
[0m12:57:24.936511 [debug] [Thread-3 (]: On model.youtube_analytics.video_latest_snapshot: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.video_latest_snapshot"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_analytics`.`video_latest_snapshot`
  OPTIONS()
  as 

with ranked as (
  select
    s.video_id,
    s.channel_id,
    s.video_title,
    s.video_published_at,
    s.views,
    s.likes,
    s.comments,
    s.duration_seconds,
    s.load_date,
    row_number() over (partition by s.video_id order by s.load_date desc) as rn
  from `orbital-nuance-471817-n0`.`youtube_stg`.`stg_youtube_video_stats` s
)
select
  r.video_id,
  r.channel_id,
  r.video_title,
  r.video_published_at,
  r.views,
  r.likes,
  r.comments,
  r.duration_seconds,
  r.load_date as snapshot_date
from ranked r
where rn = 1;


[0m12:57:25.013108 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:57:25.026958 [debug] [Thread-1 (]: On model.youtube_analytics.dim_channel: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.dim_channel"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_analytics`.`dim_channel`
  OPTIONS()
  as 

with ranked as (
  select
    channel_id,
    channel_title,
    channel_country,
    channel_published_at,
    channel_view_count,
    channel_subscribers,
    channel_video_count,
    load_date,
    row_number() over (partition by channel_id order by load_date desc) as rn
  from `orbital-nuance-471817-n0`.`youtube_stg`.`stg_youtube_channels`
)
select
  channel_id,
  channel_title,
  channel_country,
  channel_published_at,
  channel_view_count,
  channel_subscribers,
  channel_video_count,
  load_date as snapshot_date
from ranked
where rn = 1;


[0m12:57:25.102475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:25.559911 [debug] [Thread-4 (]: Writing runtime sql for node "model.youtube_analytics.fct_video_daily_metrics"
[0m12:57:25.559911 [debug] [Thread-4 (]: On model.youtube_analytics.fct_video_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.fct_video_daily_metrics"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `orbital-nuance-471817-n0`.`youtube_analytics`.`fct_video_daily_metrics` as DBT_INTERNAL_DEST
        using (

-- 1) Read from staging and LIMIT to needed dates on incremental
with src_raw as (
  select
    video_id,
    channel_id,
    load_date,
    views,
    likes,
    comments
  from `orbital-nuance-471817-n0`.`youtube_stg`.`stg_youtube_video_stats`
  
    where load_date >= (
      select date_sub(coalesce(max(load_date), date '1900-01-01'), interval 1 day)
      from `orbital-nuance-471817-n0`.`youtube_analytics`.`fct_video_daily_metrics`
    )
  
),

-- 2) Deduplicate: keep one row per (video_id, load_date)
--    If there are multiple, take the MAX of counters (monotonic metrics).
src as (
  select
    video_id,
    any_value(channel_id) as channel_id,
    load_date,
    max(views)    as views,
    max(likes)    as likes,
    max(comments) as comments
  from src_raw
  group by video_id, load_date
),

with_lag as (
  select
    *,
    lag(views)    over (partition by video_id order by load_date) as prev_views,
    lag(likes)    over (partition by video_id order by load_date) as prev_likes,
    lag(comments) over (partition by video_id order by load_date) as prev_comments
  from src
)

select
  video_id,
  channel_id,
  load_date,
  views,
  likes,
  comments,
  views    - coalesce(prev_views, 0)    as daily_views,
  likes    - coalesce(prev_likes, 0)    as daily_likes,
  comments - coalesce(prev_comments, 0) as daily_comments
from with_lag
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.video_id = DBT_INTERNAL_DEST.video_id
                ) and (
                    DBT_INTERNAL_SOURCE.load_date = DBT_INTERNAL_DEST.load_date
                )

    
    when matched then update set
        `video_id` = DBT_INTERNAL_SOURCE.`video_id`,`channel_id` = DBT_INTERNAL_SOURCE.`channel_id`,`load_date` = DBT_INTERNAL_SOURCE.`load_date`,`views` = DBT_INTERNAL_SOURCE.`views`,`likes` = DBT_INTERNAL_SOURCE.`likes`,`comments` = DBT_INTERNAL_SOURCE.`comments`,`daily_views` = DBT_INTERNAL_SOURCE.`daily_views`,`daily_likes` = DBT_INTERNAL_SOURCE.`daily_likes`,`daily_comments` = DBT_INTERNAL_SOURCE.`daily_comments`
    

    when not matched then insert
        (`video_id`, `channel_id`, `load_date`, `views`, `likes`, `comments`, `daily_views`, `daily_likes`, `daily_comments`)
    values
        (`video_id`, `channel_id`, `load_date`, `views`, `likes`, `comments`, `daily_views`, `daily_likes`, `daily_comments`)


    
[0m12:57:25.888055 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:7ae11881-6605-4185-a04a-4b251cedc0f9&page=queryresults
[0m12:57:26.078806 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:9a1e5093-5741-4734-a00d-4431ccbb086d&page=queryresults
[0m12:57:26.176188 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:781a7006-8fef-4499-9e94-7f5523ff3144&page=queryresults
[0m12:57:26.248009 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '082a26e4-baba-4d5d-ae7a-e13c8c312724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB06BD56D0>]}
[0m12:57:26.248009 [info ] [Thread-3 (]: 5 of 7 OK created sql view model youtube_analytics.video_latest_snapshot ....... [[32mCREATE VIEW (0 processed)[0m in 1.45s]
[0m12:57:26.248009 [debug] [Thread-3 (]: Finished running node model.youtube_analytics.video_latest_snapshot
[0m12:57:26.457647 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '082a26e4-baba-4d5d-ae7a-e13c8c312724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB06B8D010>]}
[0m12:57:26.457647 [info ] [Thread-1 (]: 6 of 7 OK created sql view model youtube_analytics.dim_channel ................. [[32mCREATE VIEW (0 processed)[0m in 1.66s]
[0m12:57:26.460211 [debug] [Thread-1 (]: Finished running node model.youtube_analytics.dim_channel
[0m12:57:28.858442 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '082a26e4-baba-4d5d-ae7a-e13c8c312724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB07270B90>]}
[0m12:57:28.859946 [info ] [Thread-4 (]: 4 of 7 OK created sql incremental model youtube_analytics.fct_video_daily_metrics  [[32mMERGE (20.0 rows, 2.6 KiB processed)[0m in 4.07s]
[0m12:57:28.859946 [debug] [Thread-4 (]: Finished running node model.youtube_analytics.fct_video_daily_metrics
[0m12:57:28.859946 [debug] [Thread-2 (]: Began running node model.youtube_analytics.agg_channel_trends_7d
[0m12:57:28.859946 [info ] [Thread-2 (]: 7 of 7 START sql view model youtube_analytics.agg_channel_trends_7d ............ [RUN]
[0m12:57:28.859946 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.youtube_analytics.stg_youtube_video_ids, now model.youtube_analytics.agg_channel_trends_7d)
[0m12:57:28.859946 [debug] [Thread-2 (]: Began compiling node model.youtube_analytics.agg_channel_trends_7d
[0m12:57:28.875745 [debug] [Thread-2 (]: Writing injected SQL for node "model.youtube_analytics.agg_channel_trends_7d"
[0m12:57:28.875745 [debug] [Thread-2 (]: Began executing node model.youtube_analytics.agg_channel_trends_7d
[0m12:57:28.875745 [debug] [Thread-2 (]: Writing runtime sql for node "model.youtube_analytics.agg_channel_trends_7d"
[0m12:57:28.891781 [debug] [Thread-2 (]: On model.youtube_analytics.agg_channel_trends_7d: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.agg_channel_trends_7d"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_analytics`.`agg_channel_trends_7d`
  OPTIONS()
  as 

with daily as (
  select
    channel_id,
    video_id,
    load_date,
    daily_views,
    daily_likes,
    daily_comments
  from `orbital-nuance-471817-n0`.`youtube_analytics`.`fct_video_daily_metrics`
),
rollup_cte as (
  select
    channel_id,
    load_date,
    sum(daily_views)    over (
      partition by channel_id
      order by load_date
      rows between 6 preceding and current row
    ) as views_7d,
    sum(daily_likes)    over (
      partition by channel_id
      order by load_date
      rows between 6 preceding and current row
    ) as likes_7d,
    sum(daily_comments) over (
      partition by channel_id
      order by load_date
      rows between 6 preceding and current row
    ) as comments_7d
  from daily
)
select distinct channel_id, load_date, views_7d, likes_7d, comments_7d
from rollup_cte;


[0m12:57:28.891781 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:57:29.586459 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:f181f986-8968-45bc-b269-726ed689ba2c&page=queryresults
[0m12:57:29.878064 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '082a26e4-baba-4d5d-ae7a-e13c8c312724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB0726EA90>]}
[0m12:57:29.878064 [info ] [Thread-2 (]: 7 of 7 OK created sql view model youtube_analytics.agg_channel_trends_7d ....... [[32mCREATE VIEW (0 processed)[0m in 1.02s]
[0m12:57:29.880069 [debug] [Thread-2 (]: Finished running node model.youtube_analytics.agg_channel_trends_7d
[0m12:57:29.880069 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:57:29.880069 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:57:29.889969 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0' was properly closed.
[0m12:57:29.891272 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0' was properly closed.
[0m12:57:29.891272 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg' was properly closed.
[0m12:57:29.891272 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_analytics' was properly closed.
[0m12:57:29.891272 [debug] [MainThread]: Connection 'model.youtube_analytics.dim_channel' was properly closed.
[0m12:57:29.891272 [debug] [MainThread]: Connection 'model.youtube_analytics.agg_channel_trends_7d' was properly closed.
[0m12:57:29.891272 [debug] [MainThread]: Connection 'model.youtube_analytics.video_latest_snapshot' was properly closed.
[0m12:57:29.891272 [debug] [MainThread]: Connection 'model.youtube_analytics.fct_video_daily_metrics' was properly closed.
[0m12:57:29.891272 [info ] [MainThread]: 
[0m12:57:29.900800 [info ] [MainThread]: Finished running 1 incremental model, 6 view models in 0 hours 0 minutes and 12.38 seconds (12.38s).
[0m12:57:29.906070 [debug] [MainThread]: Command end result
[0m12:57:29.975009 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m12:57:29.982437 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m12:57:29.984597 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\run_results.json
[0m12:57:29.984597 [info ] [MainThread]: 
[0m12:57:29.998094 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:57:29.999804 [info ] [MainThread]: 
[0m12:57:30.001111 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m12:57:30.001111 [debug] [MainThread]: Command `dbt run` succeeded at 12:57:30.001111 after 27.82 seconds
[0m12:57:30.001111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB594D9D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB594DA750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB594D8C90>]}
[0m12:57:30.001111 [debug] [MainThread]: Flushing usage events
[0m12:57:30.517750 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:57:33.395238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E860DD5E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E860DACCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E860DAC450>]}


============================== 12:57:33.395238 | e218bc72-128e-4227-95f5-4ccc0f3e0e28 ==============================
[0m12:57:33.395238 [info ] [MainThread]: Running with dbt=1.10.11
[0m12:57:33.395238 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'log_path': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m12:57:38.172406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e218bc72-128e-4227-95f5-4ccc0f3e0e28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E860D966D0>]}
[0m12:57:38.348759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e218bc72-128e-4227-95f5-4ccc0f3e0e28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E85D727850>]}
[0m12:57:38.351754 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m12:57:39.772721 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m12:57:40.216793 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:57:40.216793 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:57:40.296861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e218bc72-128e-4227-95f5-4ccc0f3e0e28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E80E1A88D0>]}
[0m12:57:40.516340 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m12:57:40.532198 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m12:57:40.636299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e218bc72-128e-4227-95f5-4ccc0f3e0e28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E80E18FCD0>]}
[0m12:57:40.638316 [info ] [MainThread]: Found 7 models, 5 data tests, 496 macros
[0m12:57:40.641551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e218bc72-128e-4227-95f5-4ccc0f3e0e28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E80E48ECD0>]}
[0m12:57:40.648684 [info ] [MainThread]: 
[0m12:57:40.650683 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m12:57:40.652571 [info ] [MainThread]: 
[0m12:57:40.653565 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:57:40.653565 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_analytics'
[0m12:57:40.666491 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg'
[0m12:57:40.669392 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:40.669392 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:41.232039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e218bc72-128e-4227-95f5-4ccc0f3e0e28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E80DC8BC10>]}
[0m12:57:41.232039 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:57:41.247730 [debug] [Thread-1 (]: Began running node test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267
[0m12:57:41.247730 [debug] [Thread-2 (]: Began running node test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1
[0m12:57:41.247730 [debug] [Thread-3 (]: Began running node test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7
[0m12:57:41.247730 [debug] [Thread-4 (]: Began running node test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602
[0m12:57:41.247730 [info ] [Thread-1 (]: 1 of 5 START test not_null_fct_video_daily_metrics_load_date ................... [RUN]
[0m12:57:41.247730 [info ] [Thread-2 (]: 2 of 5 START test not_null_fct_video_daily_metrics_video_id .................... [RUN]
[0m12:57:41.247730 [info ] [Thread-3 (]: 3 of 5 START test not_null_stg_youtube_video_stats_load_date ................... [RUN]
[0m12:57:41.247730 [info ] [Thread-4 (]: 4 of 5 START test not_null_stg_youtube_video_stats_video_id .................... [RUN]
[0m12:57:41.247730 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267'
[0m12:57:41.247730 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1'
[0m12:57:41.247730 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7'
[0m12:57:41.247730 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602'
[0m12:57:41.263790 [debug] [Thread-1 (]: Began compiling node test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267
[0m12:57:41.263790 [debug] [Thread-2 (]: Began compiling node test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1
[0m12:57:41.263790 [debug] [Thread-3 (]: Began compiling node test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7
[0m12:57:41.263790 [debug] [Thread-4 (]: Began compiling node test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602
[0m12:57:41.306455 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267"
[0m12:57:41.310561 [debug] [Thread-2 (]: Writing injected SQL for node "test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1"
[0m12:57:41.326662 [debug] [Thread-3 (]: Writing injected SQL for node "test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7"
[0m12:57:41.326662 [debug] [Thread-4 (]: Writing injected SQL for node "test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602"
[0m12:57:41.326662 [debug] [Thread-1 (]: Began executing node test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267
[0m12:57:41.326662 [debug] [Thread-2 (]: Began executing node test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1
[0m12:57:41.358623 [debug] [Thread-3 (]: Began executing node test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7
[0m12:57:41.390656 [debug] [Thread-4 (]: Began executing node test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602
[0m12:57:41.394063 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267"
[0m12:57:41.397073 [debug] [Thread-2 (]: Writing runtime sql for node "test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1"
[0m12:57:41.402487 [debug] [Thread-3 (]: Writing runtime sql for node "test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7"
[0m12:57:41.411889 [debug] [Thread-4 (]: Writing runtime sql for node "test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602"
[0m12:57:41.414283 [debug] [Thread-1 (]: On test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select load_date
from `orbital-nuance-471817-n0`.`youtube_analytics`.`fct_video_daily_metrics`
where load_date is null



  
  
      
    ) dbt_internal_test
[0m12:57:41.415803 [debug] [Thread-2 (]: On test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select video_id
from `orbital-nuance-471817-n0`.`youtube_analytics`.`fct_video_daily_metrics`
where video_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:41.417801 [debug] [Thread-3 (]: On test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select load_date
from `orbital-nuance-471817-n0`.`youtube_stg`.`stg_youtube_video_stats`
where load_date is null



  
  
      
    ) dbt_internal_test
[0m12:57:41.418801 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:57:41.419801 [debug] [Thread-4 (]: On test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select video_id
from `orbital-nuance-471817-n0`.`youtube_stg`.`stg_youtube_video_stats`
where video_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:41.419801 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:57:41.419801 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:57:41.489157 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:57:42.160895 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:0e2960b6-1238-4b4d-a576-3fa7a2987370&page=queryresults
[0m12:57:42.435743 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:5aa51fab-e819-4136-9c32-c7f38dac4872&page=queryresults
[0m12:57:42.468063 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:edb266b4-865a-430e-a41d-f411cda67019&page=queryresults
[0m12:57:42.538626 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:e2fe5b16-30d3-43dc-af5e-74ab9dc03a11&page=queryresults
[0m12:57:42.813669 [info ] [Thread-1 (]: 1 of 5 PASS not_null_fct_video_daily_metrics_load_date ......................... [[32mPASS[0m in 1.57s]
[0m12:57:42.829368 [debug] [Thread-1 (]: Finished running node test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267
[0m12:57:42.829915 [debug] [Thread-1 (]: Began running node test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e
[0m12:57:42.829915 [info ] [Thread-1 (]: 5 of 5 START test unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_  [RUN]
[0m12:57:42.831290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267, now test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e)
[0m12:57:42.832454 [debug] [Thread-1 (]: Began compiling node test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e
[0m12:57:42.838414 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e"
[0m12:57:42.841429 [debug] [Thread-1 (]: Began executing node test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e
[0m12:57:42.842316 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e"
[0m12:57:42.842316 [debug] [Thread-1 (]: On test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select video_id || '-' || cast(load_date as string) as unique_field
  from `orbital-nuance-471817-n0`.`youtube_analytics`.`fct_video_daily_metrics`
  where video_id || '-' || cast(load_date as string) is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:57:42.842316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:43.007307 [info ] [Thread-3 (]: 3 of 5 PASS not_null_stg_youtube_video_stats_load_date ......................... [[32mPASS[0m in 1.76s]
[0m12:57:43.007307 [debug] [Thread-3 (]: Finished running node test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7
[0m12:57:43.051516 [info ] [Thread-4 (]: 4 of 5 PASS not_null_stg_youtube_video_stats_video_id .......................... [[32mPASS[0m in 1.80s]
[0m12:57:43.052258 [debug] [Thread-4 (]: Finished running node test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602
[0m12:57:43.097737 [info ] [Thread-2 (]: 2 of 5 PASS not_null_fct_video_daily_metrics_video_id .......................... [[32mPASS[0m in 1.85s]
[0m12:57:43.101679 [debug] [Thread-2 (]: Finished running node test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1
[0m12:57:43.628922 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:4d82422f-7755-4aa5-8d7a-a1ad09620d98&page=queryresults
[0m12:57:44.186427 [info ] [Thread-1 (]: 5 of 5 PASS unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_ .. [[32mPASS[0m in 1.36s]
[0m12:57:44.186427 [debug] [Thread-1 (]: Finished running node test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e
[0m12:57:44.202285 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:57:44.202285 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:57:44.202285 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_analytics' was properly closed.
[0m12:57:44.202285 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg' was properly closed.
[0m12:57:44.202285 [debug] [MainThread]: Connection 'test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e' was properly closed.
[0m12:57:44.202285 [debug] [MainThread]: Connection 'test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1' was properly closed.
[0m12:57:44.202285 [debug] [MainThread]: Connection 'test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7' was properly closed.
[0m12:57:44.202285 [debug] [MainThread]: Connection 'test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602' was properly closed.
[0m12:57:44.202285 [info ] [MainThread]: 
[0m12:57:44.218057 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 3.55 seconds (3.55s).
[0m12:57:44.218057 [debug] [MainThread]: Command end result
[0m12:57:44.279263 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m12:57:44.295174 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m12:57:44.311084 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\run_results.json
[0m12:57:44.311084 [info ] [MainThread]: 
[0m12:57:44.311084 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:57:44.311084 [info ] [MainThread]: 
[0m12:57:44.311084 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m12:57:44.311084 [debug] [MainThread]: Command `dbt test` succeeded at 12:57:44.311084 after 10.99 seconds
[0m12:57:44.327294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E860DD6710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E860DD6AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E85A372110>]}
[0m12:57:44.327294 [debug] [MainThread]: Flushing usage events
[0m12:57:44.693963 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:15:18.310675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF09376450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF08FD4C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF08FD4B90>]}


============================== 13:15:18.310675 | 4cf03f1b-a42a-4fb2-a6cb-3ea20923676a ==============================
[0m13:15:18.310675 [info ] [MainThread]: Running with dbt=1.10.11
[0m13:15:18.310675 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'log_path': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt'}
[0m13:15:30.325744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4cf03f1b-a42a-4fb2-a6cb-3ea20923676a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF361AB490>]}
[0m13:15:30.467528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4cf03f1b-a42a-4fb2-a6cb-3ea20923676a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF05CDB590>]}
[0m13:15:30.467528 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m13:15:32.500576 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m13:15:34.984022 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:15:34.984022 [debug] [MainThread]: Partial parsing: added file: youtube_analytics://dbt/models\marts\schema.yml
[0m13:15:35.138937 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named fct_video_daily_metrics. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for fct_video_daily_metrics in one of these files:
   - dbt/models\marts\schema.yml
  dbt/models\tests\schema.yml
[0m13:15:35.138937 [debug] [MainThread]: Command `dbt test` failed at 13:15:35.138937 after 16.93 seconds
[0m13:15:35.138937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF09398ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF36889710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF09398C90>]}
[0m13:15:35.138937 [debug] [MainThread]: Flushing usage events
[0m13:15:35.595583 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:20:21.698431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDF808E450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDF808D7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDF80C15D0>]}


============================== 13:20:21.703716 | 7e2157bd-0c19-4077-a7e0-5cde3681a61f ==============================
[0m13:20:21.703716 [info ] [MainThread]: Running with dbt=1.10.11
[0m13:20:21.704719 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'empty': 'None', 'log_path': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt'}
[0m13:20:26.284096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e2157bd-0c19-4077-a7e0-5cde3681a61f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDA4EF5D10>]}
[0m13:20:26.403576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e2157bd-0c19-4077-a7e0-5cde3681a61f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDF4A5C410>]}
[0m13:20:26.403576 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m13:20:27.953401 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m13:20:28.358062 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m13:20:28.358062 [debug] [MainThread]: Partial parsing: added file: youtube_analytics://dbt/models\marts\schema.yml
[0m13:20:29.279984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e2157bd-0c19-4077-a7e0-5cde3681a61f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDA5064D50>]}
[0m13:20:29.478009 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m13:20:29.513355 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m13:20:29.598002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e2157bd-0c19-4077-a7e0-5cde3681a61f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDA5B09610>]}
[0m13:20:29.598002 [info ] [MainThread]: Found 7 models, 3 data tests, 496 macros
[0m13:20:29.600018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e2157bd-0c19-4077-a7e0-5cde3681a61f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDA5883010>]}
[0m13:20:29.603829 [info ] [MainThread]: 
[0m13:20:29.603829 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m13:20:29.603829 [info ] [MainThread]: 
[0m13:20:29.608643 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:20:29.608643 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_analytics'
[0m13:20:29.608643 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:20:29.624805 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg'
[0m13:20:29.625902 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:20:30.273328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e2157bd-0c19-4077-a7e0-5cde3681a61f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDA58D5E50>]}
[0m13:20:30.273328 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:20:30.289041 [debug] [Thread-1 (]: Began running node test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267
[0m13:20:30.289041 [debug] [Thread-2 (]: Began running node test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1
[0m13:20:30.289041 [debug] [Thread-3 (]: Began running node test.youtube_analytics.unique_fct_video_daily_metrics_concat_video_id_cast_load_date_as_string_.83dcd3d608
[0m13:20:30.289041 [info ] [Thread-1 (]: 1 of 3 START test not_null_fct_video_daily_metrics_load_date ................... [RUN]
[0m13:20:30.289041 [info ] [Thread-2 (]: 2 of 3 START test not_null_fct_video_daily_metrics_video_id .................... [RUN]
[0m13:20:30.289041 [info ] [Thread-3 (]: 3 of 3 START test unique_fct_video_daily_metrics_concat_video_id_cast_load_date_as_string_  [RUN]
[0m13:20:30.305135 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267'
[0m13:20:30.305135 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1'
[0m13:20:30.305135 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.youtube_analytics.unique_fct_video_daily_metrics_concat_video_id_cast_load_date_as_string_.83dcd3d608'
[0m13:20:30.305135 [debug] [Thread-1 (]: Began compiling node test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267
[0m13:20:30.305135 [debug] [Thread-2 (]: Began compiling node test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1
[0m13:20:30.305135 [debug] [Thread-3 (]: Began compiling node test.youtube_analytics.unique_fct_video_daily_metrics_concat_video_id_cast_load_date_as_string_.83dcd3d608
[0m13:20:30.336610 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267"
[0m13:20:30.361595 [debug] [Thread-2 (]: Writing injected SQL for node "test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1"
[0m13:20:30.368822 [debug] [Thread-3 (]: Writing injected SQL for node "test.youtube_analytics.unique_fct_video_daily_metrics_concat_video_id_cast_load_date_as_string_.83dcd3d608"
[0m13:20:30.368822 [debug] [Thread-2 (]: Began executing node test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1
[0m13:20:30.382282 [debug] [Thread-1 (]: Began executing node test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267
[0m13:20:30.400599 [debug] [Thread-3 (]: Began executing node test.youtube_analytics.unique_fct_video_daily_metrics_concat_video_id_cast_load_date_as_string_.83dcd3d608
[0m13:20:30.419393 [debug] [Thread-2 (]: Writing runtime sql for node "test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1"
[0m13:20:30.435122 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267"
[0m13:20:30.440101 [debug] [Thread-3 (]: Writing runtime sql for node "test.youtube_analytics.unique_fct_video_daily_metrics_concat_video_id_cast_load_date_as_string_.83dcd3d608"
[0m13:20:30.440101 [debug] [Thread-2 (]: On test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select video_id
from `orbital-nuance-471817-n0`.`youtube_analytics`.`fct_video_daily_metrics`
where video_id is null



  
  
      
    ) dbt_internal_test
[0m13:20:30.440101 [debug] [Thread-1 (]: On test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select load_date
from `orbital-nuance-471817-n0`.`youtube_analytics`.`fct_video_daily_metrics`
where load_date is null



  
  
      
    ) dbt_internal_test
[0m13:20:30.446373 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:20:30.446373 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:20:30.446373 [debug] [Thread-3 (]: On test.youtube_analytics.unique_fct_video_daily_metrics_concat_video_id_cast_load_date_as_string_.83dcd3d608: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.unique_fct_video_daily_metrics_concat_video_id_cast_load_date_as_string_.83dcd3d608"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select concat(video_id, '-', cast(load_date as string)) as unique_field
  from `orbital-nuance-471817-n0`.`youtube_analytics`.`fct_video_daily_metrics`
  where concat(video_id, '-', cast(load_date as string)) is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:20:30.593627 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:20:31.281773 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:89741497-5a14-4281-9c14-14431c6ce2fb&page=queryresults
[0m13:20:31.311017 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:3aa55e08-4461-41bb-85dd-7daeb0233859&page=queryresults
[0m13:20:31.514204 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:4de66bb8-cdcc-4d9b-9ceb-43b822631748&page=queryresults
[0m13:20:35.589766 [info ] [Thread-2 (]: 2 of 3 PASS not_null_fct_video_daily_metrics_video_id .......................... [[32mPASS[0m in 5.28s]
[0m13:20:35.589766 [debug] [Thread-2 (]: Finished running node test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1
[0m13:20:35.595015 [info ] [Thread-3 (]: 3 of 3 PASS unique_fct_video_daily_metrics_concat_video_id_cast_load_date_as_string_  [[32mPASS[0m in 5.29s]
[0m13:20:35.595015 [debug] [Thread-3 (]: Finished running node test.youtube_analytics.unique_fct_video_daily_metrics_concat_video_id_cast_load_date_as_string_.83dcd3d608
[0m13:20:35.665523 [info ] [Thread-1 (]: 1 of 3 PASS not_null_fct_video_daily_metrics_load_date ......................... [[32mPASS[0m in 5.37s]
[0m13:20:35.665523 [debug] [Thread-1 (]: Finished running node test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267
[0m13:20:35.670589 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:20:35.674330 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:20:35.674330 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_analytics' was properly closed.
[0m13:20:35.674330 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg' was properly closed.
[0m13:20:35.674330 [debug] [MainThread]: Connection 'test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267' was properly closed.
[0m13:20:35.674330 [debug] [MainThread]: Connection 'test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1' was properly closed.
[0m13:20:35.686381 [debug] [MainThread]: Connection 'test.youtube_analytics.unique_fct_video_daily_metrics_concat_video_id_cast_load_date_as_string_.83dcd3d608' was properly closed.
[0m13:20:35.686381 [info ] [MainThread]: 
[0m13:20:35.686381 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 6.08 seconds (6.08s).
[0m13:20:35.686381 [debug] [MainThread]: Command end result
[0m13:20:35.763891 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m13:20:35.774483 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m13:20:35.779681 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\run_results.json
[0m13:20:35.794265 [info ] [MainThread]: 
[0m13:20:35.795785 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:20:35.795785 [info ] [MainThread]: 
[0m13:20:35.795785 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m13:20:35.804768 [debug] [MainThread]: Command `dbt test` succeeded at 13:20:35.804768 after 14.16 seconds
[0m13:20:35.806784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDF80E6650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDF80E6E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDF1662110>]}
[0m13:20:35.806784 [debug] [MainThread]: Flushing usage events
[0m13:20:36.212030 [debug] [MainThread]: An error was encountered while trying to flush usage events
