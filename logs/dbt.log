[0m13:59:09.365887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002143A79A450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021437392090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002143A4F2010>]}


============================== 13:59:09.367895 | 77a328c9-d5d4-4f6e-9129-aa91bad7bfca ==============================
[0m13:59:09.367895 [info ] [MainThread]: Running with dbt=1.10.11
[0m13:59:09.367895 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt debug', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'log_path': 'logs', 'indirect_selection': 'eager', 'profiles_dir': 'D:\\UC Davis Documents ', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m13:59:09.383745 [info ] [MainThread]: dbt version: 1.10.11
[0m13:59:09.383745 [info ] [MainThread]: python version: 3.11.1
[0m13:59:09.383745 [info ] [MainThread]: python path: C:\Users\lyx\AppData\Local\Programs\Python\Python311\python.exe
[0m13:59:09.383745 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m13:59:09.383745 [info ] [MainThread]: Using profiles dir at D:\UC Davis Documents 
[0m13:59:09.383745 [info ] [MainThread]: Using profiles.yml file at D:\UC Davis Documents \profiles.yml
[0m13:59:09.383745 [info ] [MainThread]: Using dbt_project.yml file at D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\dbt_project.yml
[0m13:59:09.383745 [info ] [MainThread]: Configuration:
[0m13:59:09.383745 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m13:59:09.383745 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m13:59:09.399628 [info ] [MainThread]: Required dependencies:
[0m13:59:09.399628 [debug] [MainThread]: Executing "git --help"
[0m13:59:09.432550 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:59:09.432550 [debug] [MainThread]: STDERR: "b''"
[0m13:59:09.432550 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:59:09.432550 [info ] [MainThread]: Connection test skipped since no profile was found
[0m13:59:09.432550 [info ] [MainThread]: [31m2 checks failed:[0m
[0m13:59:09.432550 [info ] [MainThread]: dbt looked for a profiles.yml file in D:\UC Davis Documents \profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m13:59:09.432550 [info ] [MainThread]: Project loading failed for the following reason:
 project path <D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\dbt_project.yml> not found

[0m13:59:09.432550 [debug] [MainThread]: Command `dbt debug` failed at 13:59:09.432550 after 0.15 seconds
[0m13:59:09.432550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021433DE0910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002143A79AC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021433E65D10>]}
[0m13:59:09.432550 [debug] [MainThread]: Flushing usage events
[0m13:59:10.165427 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:07:54.700473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C607F4EBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C607FC91D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C607FCA810>]}


============================== 14:07:54.700473 | a10e62db-5985-47d3-9dcc-e2f1a74dab34 ==============================
[0m14:07:54.700473 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:07:54.700473 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'empty': 'None', 'log_path': 'logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'D:\\UC Davis Documents ^& Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt'}
[0m14:07:54.736322 [info ] [MainThread]: dbt version: 1.10.11
[0m14:07:54.737321 [info ] [MainThread]: python version: 3.11.1
[0m14:07:54.737321 [info ] [MainThread]: python path: C:\Users\lyx\AppData\Local\Programs\Python\Python311\python.exe
[0m14:07:54.738326 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m14:07:54.738326 [info ] [MainThread]: Using profiles dir at D:\UC Davis Documents ^& Works\Interview Preparation\self_projects\youtube-analytics-pipeline\dbt
[0m14:07:54.739324 [info ] [MainThread]: Using profiles.yml file at D:\UC Davis Documents ^& Works\Interview Preparation\self_projects\youtube-analytics-pipeline\dbt\profiles.yml
[0m14:07:54.739324 [info ] [MainThread]: Using dbt_project.yml file at D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\dbt_project.yml
[0m14:07:54.740320 [info ] [MainThread]: Configuration:
[0m14:07:54.740320 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m14:07:54.741321 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m14:07:54.741321 [info ] [MainThread]: Required dependencies:
[0m14:07:54.742320 [debug] [MainThread]: Executing "git --help"
[0m14:07:54.774798 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:07:54.774798 [debug] [MainThread]: STDERR: "b''"
[0m14:07:54.777247 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:07:54.777247 [info ] [MainThread]: Connection test skipped since no profile was found
[0m14:07:54.777247 [info ] [MainThread]: [31m2 checks failed:[0m
[0m14:07:54.777247 [info ] [MainThread]: dbt looked for a profiles.yml file in D:\UC Davis Documents ^& Works\Interview Preparation\self_projects\youtube-analytics-pipeline\dbt\profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m14:07:54.780539 [info ] [MainThread]: Project loading failed for the following reason:
 project path <D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\dbt_project.yml> not found

[0m14:07:54.781550 [debug] [MainThread]: Command `dbt debug` failed at 14:07:54.781550 after 0.15 seconds
[0m14:07:54.781550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C601650910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C60805FAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6016D5CD0>]}
[0m14:07:54.783120 [debug] [MainThread]: Flushing usage events
[0m14:07:55.178786 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:29:29.858247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EFBD34110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EFBD2FA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EFBD2F4D0>]}


============================== 14:29:29.858247 | 044d8820-d724-4600-9dc1-2226b7c6a090 ==============================
[0m14:29:29.858247 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:29:29.858247 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt debug', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'None', 'printer_width': '80', 'quiet': 'False', 'indirect_selection': 'eager', 'log_path': 'logs', 'profiles_dir': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m14:29:29.886207 [info ] [MainThread]: dbt version: 1.10.11
[0m14:29:29.886207 [info ] [MainThread]: python version: 3.11.1
[0m14:29:29.886207 [info ] [MainThread]: python path: C:\Users\lyx\AppData\Local\Programs\Python\Python311\python.exe
[0m14:29:29.886207 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m14:29:43.028734 [info ] [MainThread]: Using profiles dir at D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\dbt
[0m14:29:43.028734 [info ] [MainThread]: Using profiles.yml file at D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\dbt\profiles.yml
[0m14:29:43.028734 [info ] [MainThread]: Using dbt_project.yml file at D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\dbt_project.yml
[0m14:29:43.028734 [info ] [MainThread]: adapter type: bigquery
[0m14:29:43.028734 [info ] [MainThread]: adapter version: 1.10.2
[0m14:29:43.028734 [info ] [MainThread]: Configuration:
[0m14:29:43.041906 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:29:43.041906 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m14:29:43.041906 [info ] [MainThread]: Required dependencies:
[0m14:29:43.041906 [debug] [MainThread]: Executing "git --help"
[0m14:29:43.082245 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:29:43.084172 [debug] [MainThread]: STDERR: "b''"
[0m14:29:43.084172 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:29:43.087318 [info ] [MainThread]: Connection:
[0m14:29:43.087318 [info ] [MainThread]:   method: service-account
[0m14:29:43.087318 [info ] [MainThread]:   database: YOUR_PROJECT_ID
[0m14:29:43.087318 [info ] [MainThread]:   execution_project: YOUR_PROJECT_ID
[0m14:29:43.087318 [info ] [MainThread]:   schema: youtube_stg
[0m14:29:43.087318 [info ] [MainThread]:   location: US
[0m14:29:43.087318 [info ] [MainThread]:   priority: None
[0m14:29:43.087318 [info ] [MainThread]:   maximum_bytes_billed: None
[0m14:29:43.087318 [info ] [MainThread]:   impersonate_service_account: None
[0m14:29:43.087318 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m14:29:43.103150 [info ] [MainThread]:   job_retries: 1
[0m14:29:43.103150 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m14:29:43.103150 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m14:29:43.103150 [info ] [MainThread]:   timeout_seconds: None
[0m14:29:43.103150 [info ] [MainThread]:   client_id: None
[0m14:29:43.103150 [info ] [MainThread]:   token_uri: None
[0m14:29:43.103150 [info ] [MainThread]:   compute_region: None
[0m14:29:43.103150 [info ] [MainThread]:   dataproc_cluster_name: None
[0m14:29:43.103150 [info ] [MainThread]:   gcs_bucket: None
[0m14:29:43.103150 [info ] [MainThread]:   dataproc_batch: None
[0m14:29:43.119007 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m14:29:45.055897 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m14:29:45.055897 [debug] [MainThread]: On debug: select 1 as id
[0m14:29:45.055897 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:29:45.686536 [error] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=YOUR_PROJECT_ID&j=bq:US:942ced51-1ef1-41d3-963d-d6707d824efd&page=queryresults
[0m14:29:45.688431 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m14:29:45.690428 [info ] [MainThread]: [31m2 checks failed:[0m
[0m14:29:45.691425 [info ] [MainThread]: Project loading failed for the following reason:
 project path <D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\dbt_project.yml> not found

[0m14:29:45.692832 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  Invalid project ID 'YOUR_PROJECT_ID'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m14:29:45.693840 [debug] [MainThread]: Command `dbt debug` failed at 14:29:45.693840 after 15.94 seconds
[0m14:29:45.693840 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:29:45.694838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EF5440990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EFBDAAC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021EFBDAA150>]}
[0m14:29:45.694838 [debug] [MainThread]: Flushing usage events
[0m14:29:46.198577 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:34:55.534357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DFF82DB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DFF7F3E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DFF7F3FD0>]}


============================== 14:34:55.534357 | 770aa421-7ff2-4488-9eac-154163af1f94 ==============================
[0m14:34:55.534357 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:34:55.534357 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt'}
[0m14:34:55.562421 [info ] [MainThread]: dbt version: 1.10.11
[0m14:34:55.562421 [info ] [MainThread]: python version: 3.11.1
[0m14:34:55.562421 [info ] [MainThread]: python path: C:\Users\lyx\AppData\Local\Programs\Python\Python311\python.exe
[0m14:34:55.562421 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m14:35:02.286333 [info ] [MainThread]: Using profiles dir at D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\dbt
[0m14:35:02.288073 [info ] [MainThread]: Using profiles.yml file at D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\dbt\profiles.yml
[0m14:35:02.290212 [info ] [MainThread]: Using dbt_project.yml file at D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\dbt_project.yml
[0m14:35:02.291345 [info ] [MainThread]: adapter type: bigquery
[0m14:35:02.292234 [info ] [MainThread]: adapter version: 1.10.2
[0m14:35:02.293649 [info ] [MainThread]: Configuration:
[0m14:35:02.294997 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:35:02.295478 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m14:35:02.297632 [info ] [MainThread]: Required dependencies:
[0m14:35:02.299485 [debug] [MainThread]: Executing "git --help"
[0m14:35:02.335527 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:35:02.335527 [debug] [MainThread]: STDERR: "b''"
[0m14:35:02.335527 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:35:02.335527 [info ] [MainThread]: Connection:
[0m14:35:02.343771 [info ] [MainThread]:   method: service-account
[0m14:35:02.343771 [info ] [MainThread]:   database: orbital-nuance-471817-n0
[0m14:35:02.343771 [info ] [MainThread]:   execution_project: orbital-nuance-471817-n0
[0m14:35:02.343771 [info ] [MainThread]:   schema: youtube_stg
[0m14:35:02.343771 [info ] [MainThread]:   location: US
[0m14:35:02.343771 [info ] [MainThread]:   priority: None
[0m14:35:02.343771 [info ] [MainThread]:   maximum_bytes_billed: None
[0m14:35:02.343771 [info ] [MainThread]:   impersonate_service_account: None
[0m14:35:02.343771 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m14:35:02.359656 [info ] [MainThread]:   job_retries: 1
[0m14:35:02.359656 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m14:35:02.359656 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m14:35:02.359656 [info ] [MainThread]:   timeout_seconds: None
[0m14:35:02.359656 [info ] [MainThread]:   client_id: None
[0m14:35:02.359656 [info ] [MainThread]:   token_uri: None
[0m14:35:02.359656 [info ] [MainThread]:   compute_region: None
[0m14:35:02.359656 [info ] [MainThread]:   dataproc_cluster_name: None
[0m14:35:02.359656 [info ] [MainThread]:   gcs_bucket: None
[0m14:35:02.359656 [info ] [MainThread]:   dataproc_batch: None
[0m14:35:02.375554 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m14:35:04.556650 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m14:35:04.556650 [debug] [MainThread]: On debug: select 1 as id
[0m14:35:04.556650 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:35:05.788432 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:860a1632-d531-417d-85ba-5336f4f80cc3&page=queryresults
[0m14:35:10.808860 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:35:10.808860 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:35:10.808860 [info ] [MainThread]: Project loading failed for the following reason:
 project path <D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\dbt_project.yml> not found

[0m14:35:10.813113 [debug] [MainThread]: Command `dbt debug` failed at 14:35:10.813113 after 15.38 seconds
[0m14:35:10.813113 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:35:10.813113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DFF7F3F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DF8EC0990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DF8F45DD0>]}
[0m14:35:10.815121 [debug] [MainThread]: Flushing usage events
[0m14:35:11.192180 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:44:34.713190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219939643D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021993967A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219939A2610>]}


============================== 14:44:34.713190 | 66c7d2da-cbfd-498d-a77e-bb366ac23fc8 ==============================
[0m14:44:34.713190 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:44:34.713190 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt debug', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'empty': 'None', 'quiet': 'False', 'indirect_selection': 'eager', 'log_path': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\logs', 'profiles_dir': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m14:44:34.744898 [info ] [MainThread]: dbt version: 1.10.11
[0m14:44:34.744898 [info ] [MainThread]: python version: 3.11.1
[0m14:44:34.744898 [info ] [MainThread]: python path: C:\Users\lyx\AppData\Local\Programs\Python\Python311\python.exe
[0m14:44:34.744898 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m14:44:41.908173 [info ] [MainThread]: Using profiles dir at D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\dbt
[0m14:44:41.908173 [info ] [MainThread]: Using profiles.yml file at D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\dbt\profiles.yml
[0m14:44:41.908173 [info ] [MainThread]: Using dbt_project.yml file at D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\dbt_project.yml
[0m14:44:41.921920 [info ] [MainThread]: adapter type: bigquery
[0m14:44:41.924048 [info ] [MainThread]: adapter version: 1.10.2
[0m14:44:42.231150 [info ] [MainThread]: Configuration:
[0m14:44:42.233523 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:44:42.233523 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:44:42.236589 [info ] [MainThread]: Required dependencies:
[0m14:44:42.236589 [debug] [MainThread]: Executing "git --help"
[0m14:44:42.262099 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:44:42.278297 [debug] [MainThread]: STDERR: "b''"
[0m14:44:42.278297 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:44:42.278297 [info ] [MainThread]: Connection:
[0m14:44:42.278297 [info ] [MainThread]:   method: service-account
[0m14:44:42.278297 [info ] [MainThread]:   database: orbital-nuance-471817-n0
[0m14:44:42.278297 [info ] [MainThread]:   execution_project: orbital-nuance-471817-n0
[0m14:44:42.278297 [info ] [MainThread]:   schema: youtube_stg
[0m14:44:42.278297 [info ] [MainThread]:   location: US
[0m14:44:42.278297 [info ] [MainThread]:   priority: None
[0m14:44:42.278297 [info ] [MainThread]:   maximum_bytes_billed: None
[0m14:44:42.278297 [info ] [MainThread]:   impersonate_service_account: None
[0m14:44:42.294134 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m14:44:42.295614 [info ] [MainThread]:   job_retries: 1
[0m14:44:42.295614 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m14:44:42.295614 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m14:44:42.295614 [info ] [MainThread]:   timeout_seconds: None
[0m14:44:42.295614 [info ] [MainThread]:   client_id: None
[0m14:44:42.295614 [info ] [MainThread]:   token_uri: None
[0m14:44:42.295614 [info ] [MainThread]:   compute_region: None
[0m14:44:42.309960 [info ] [MainThread]:   dataproc_cluster_name: None
[0m14:44:42.312311 [info ] [MainThread]:   gcs_bucket: None
[0m14:44:42.314613 [info ] [MainThread]:   dataproc_batch: None
[0m14:44:42.314613 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m14:44:44.246391 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m14:44:44.246391 [debug] [MainThread]: On debug: select 1 as id
[0m14:44:44.246391 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:44:45.167730 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:e35a46f2-afe7-4c5a-8812-cf37ff688d5b&page=queryresults
[0m14:44:46.288254 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:44:46.297492 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:44:46.297492 [debug] [MainThread]: Command `dbt debug` succeeded at 14:44:46.297492 after 11.66 seconds
[0m14:44:46.297492 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:44:46.297492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219936287D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219939A8110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002198CFF3D90>]}
[0m14:44:46.297492 [debug] [MainThread]: Flushing usage events
[0m14:44:46.782238 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:45:05.292425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011BB7490890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011BB7444DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011BB747CD90>]}


============================== 14:45:05.292425 | 814bdf64-1f83-4c5f-8744-6ec4e312cc0c ==============================
[0m14:45:05.292425 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:45:05.292425 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'printer_width': '80', 'empty': 'False', 'indirect_selection': 'eager', 'log_path': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\logs', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m14:45:12.439334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '814bdf64-1f83-4c5f-8744-6ec4e312cc0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011BE5C1BB50>]}
[0m14:45:12.619880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '814bdf64-1f83-4c5f-8744-6ec4e312cc0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011BE5D38C50>]}
[0m14:45:12.622881 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m14:45:14.440496 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m14:45:14.459825 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:45:14.462884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '814bdf64-1f83-4c5f-8744-6ec4e312cc0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011BE701FD50>]}
[0m14:45:20.003155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '814bdf64-1f83-4c5f-8744-6ec4e312cc0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011BE73A40D0>]}
[0m14:45:20.149887 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m14:45:20.181304 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m14:45:20.272293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '814bdf64-1f83-4c5f-8744-6ec4e312cc0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011BE75DD690>]}
[0m14:45:20.272293 [info ] [MainThread]: Found 5 models, 5 data tests, 495 macros
[0m14:45:20.272293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '814bdf64-1f83-4c5f-8744-6ec4e312cc0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011BE7302290>]}
[0m14:45:20.286947 [info ] [MainThread]: 
[0m14:45:20.286947 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m14:45:20.286947 [info ] [MainThread]: 
[0m14:45:20.286947 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:45:20.305707 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0'
[0m14:45:20.305707 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:20.305707 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0'
[0m14:45:20.401012 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:21.131841 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_orbital-nuance-471817-n0, now create_orbital-nuance-471817-n0_youtube_stg_youtube_stg)
[0m14:45:21.131841 [debug] [ThreadPool]: Creating schema "database: "orbital-nuance-471817-n0"
schema: "youtube_stg_youtube_stg"
"
[0m14:45:21.118370 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_orbital-nuance-471817-n0, now create_orbital-nuance-471817-n0_youtube_stg_youtube_analytics)
[0m14:45:21.141766 [debug] [ThreadPool]: On create_orbital-nuance-471817-n0_youtube_stg_youtube_stg: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "connection_name": "create_orbital-nuance-471817-n0_youtube_stg_youtube_stg"} */
create schema if not exists `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`
  
[0m14:45:21.141766 [debug] [ThreadPool]: Creating schema "database: "orbital-nuance-471817-n0"
schema: "youtube_stg_youtube_analytics"
"
[0m14:45:21.141766 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:45:21.150374 [debug] [ThreadPool]: On create_orbital-nuance-471817-n0_youtube_stg_youtube_analytics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "connection_name": "create_orbital-nuance-471817-n0_youtube_stg_youtube_analytics"} */
create schema if not exists `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`
  
[0m14:45:21.200519 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:45:21.931187 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:a98adbf0-a08c-45a5-876b-e0512bd55d2d&page=queryresults
[0m14:45:21.934407 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:f494c8cd-cd04-4d0f-8d76-476a11e7c661&page=queryresults
[0m14:45:23.151481 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics'
[0m14:45:23.151481 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:23.153495 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg'
[0m14:45:23.302387 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:23.978553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '814bdf64-1f83-4c5f-8744-6ec4e312cc0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011BE73351D0>]}
[0m14:45:23.978553 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:45:24.134541 [debug] [Thread-1 (]: Began running node model.youtube_analytics.stg_youtube_channels
[0m14:45:24.137464 [debug] [Thread-2 (]: Began running node model.youtube_analytics.stg_youtube_video_ids
[0m14:45:24.137464 [debug] [Thread-3 (]: Began running node model.youtube_analytics.stg_youtube_video_stats
[0m14:45:24.137464 [info ] [Thread-1 (]: 1 of 5 START sql view model youtube_stg_youtube_stg.stg_youtube_channels ....... [RUN]
[0m14:45:24.137464 [info ] [Thread-2 (]: 2 of 5 START sql view model youtube_stg_youtube_stg.stg_youtube_video_ids ...... [RUN]
[0m14:45:24.137464 [info ] [Thread-3 (]: 3 of 5 START sql view model youtube_stg_youtube_stg.stg_youtube_video_stats .... [RUN]
[0m14:45:24.137464 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_channels'
[0m14:45:24.137464 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_video_ids'
[0m14:45:24.137464 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_video_stats'
[0m14:45:24.150885 [debug] [Thread-1 (]: Began compiling node model.youtube_analytics.stg_youtube_channels
[0m14:45:24.153169 [debug] [Thread-2 (]: Began compiling node model.youtube_analytics.stg_youtube_video_ids
[0m14:45:24.154093 [debug] [Thread-3 (]: Began compiling node model.youtube_analytics.stg_youtube_video_stats
[0m14:45:24.165701 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_channels"
[0m14:45:24.170757 [debug] [Thread-2 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_video_ids"
[0m14:45:24.177695 [debug] [Thread-3 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_video_stats"
[0m14:45:24.182696 [debug] [Thread-1 (]: Began executing node model.youtube_analytics.stg_youtube_channels
[0m14:45:24.182696 [debug] [Thread-2 (]: Began executing node model.youtube_analytics.stg_youtube_video_ids
[0m14:45:24.197488 [debug] [Thread-3 (]: Began executing node model.youtube_analytics.stg_youtube_video_stats
[0m14:45:24.232080 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_channels"
[0m14:45:24.247003 [debug] [Thread-2 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_video_ids"
[0m14:45:24.253829 [debug] [Thread-3 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_video_stats"
[0m14:45:24.263401 [debug] [Thread-2 (]: On model.youtube_analytics.stg_youtube_video_ids: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_video_ids"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_ids`
  OPTIONS()
  as select
  videoId              as video_id,
  channelId            as channel_id,
  date(_partitiontime) as load_date
from `YOUR_PROJECT_ID.youtube_raw.video_ids_raw`;;


[0m14:45:24.264406 [debug] [Thread-3 (]: On model.youtube_analytics.stg_youtube_video_stats: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_video_stats"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
  OPTIONS()
  as with src as (
  select
    id                                     as video_id,
    snippet.channelId                      as channel_id,
    snippet.title                          as video_title,
    snippet.publishedAt                    as video_published_at,
    cast(statistics.viewCount    as int64) as views,
    cast(statistics.likeCount    as int64) as likes,
    cast(statistics.commentCount as int64) as comments,
    contentDetails.duration                as duration_iso,
    date(_partitiontime)                   as load_date
  from `YOUR_PROJECT_ID.youtube_raw.video_stats_raw`
),
parsed as (
  -- Parse durations like PT5M13S into seconds
  select
    *,
    (
      coalesce(
        safe.cast(regexp_extract(duration_iso, r'(\d+)H') as int64), 0
      ) * 3600
      +
      coalesce(
        safe.cast(regexp_extract(duration_iso, r'(\d+)M') as int64), 0
      ) * 60
      +
      coalesce(
        safe.cast(regexp_extract(duration_iso, r'(\d+)S') as int64), 0
      )
    ) as duration_seconds
  from src
)
select * from parsed;;


[0m14:45:24.265627 [debug] [Thread-1 (]: On model.youtube_analytics.stg_youtube_channels: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_channels"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_channels`
  OPTIONS()
  as with src as (
  select
    id                                        as channel_id,
    snippet.title                             as channel_title,
    snippet.country                           as channel_country,
    snippet.publishedAt                       as channel_published_at,
    cast(statistics.viewCount       as int64) as channel_view_count,
    cast(statistics.subscriberCount as int64) as channel_subscribers,
    cast(statistics.videoCount      as int64) as channel_video_count,
    date(_partitiontime)                      as load_date
  from `YOUR_PROJECT_ID.youtube_raw.channels_raw`
)
select * from src;;


[0m14:45:24.266626 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:45:24.268628 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:45:24.269623 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:45:24.994885 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:f3156299-fb4b-4d6d-bb31-a5601eb0f199&page=queryresults
[0m14:45:24.994885 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:8b8b9145-4a54-4d3d-aa23-53851ee60448&page=queryresults
[0m14:45:24.994885 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:f3156299-fb4b-4d6d-bb31-a5601eb0f199&page=queryresults
[0m14:45:24.994885 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:8b8b9145-4a54-4d3d-aa23-53851ee60448&page=queryresults
[0m14:45:25.062506 [debug] [Thread-3 (]: Database Error in model stg_youtube_video_stats (dbt/models\staging\stg_youtube_video_stats.sql)
  Syntax error: Unexpected ";" at [38:22]
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_video_stats.sql
[0m14:45:25.073837 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:7fde6bbb-296a-4afa-a352-685a7ece8610&page=queryresults
[0m14:45:25.073837 [debug] [Thread-2 (]: Database Error in model stg_youtube_video_ids (dbt/models\staging\stg_youtube_video_ids.sql)
  Syntax error: Unexpected ";" at [10:50]
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_video_ids.sql
[0m14:45:25.073837 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:7fde6bbb-296a-4afa-a352-685a7ece8610&page=queryresults
[0m14:45:25.073837 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '814bdf64-1f83-4c5f-8744-6ec4e312cc0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011BE5C6A350>]}
[0m14:45:25.073837 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '814bdf64-1f83-4c5f-8744-6ec4e312cc0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011BE7A55410>]}
[0m14:45:25.073837 [debug] [Thread-1 (]: Database Error in model stg_youtube_channels (dbt/models\staging\stg_youtube_channels.sql)
  Syntax error: Unexpected ";" at [18:19]
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_channels.sql
[0m14:45:25.073837 [error] [Thread-3 (]: 3 of 5 ERROR creating sql view model youtube_stg_youtube_stg.stg_youtube_video_stats  [[31mERROR[0m in 0.93s]
[0m14:45:25.073837 [error] [Thread-2 (]: 2 of 5 ERROR creating sql view model youtube_stg_youtube_stg.stg_youtube_video_ids  [[31mERROR[0m in 0.94s]
[0m14:45:25.087275 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '814bdf64-1f83-4c5f-8744-6ec4e312cc0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011BE76327D0>]}
[0m14:45:25.087275 [debug] [Thread-3 (]: Finished running node model.youtube_analytics.stg_youtube_video_stats
[0m14:45:25.087275 [debug] [Thread-2 (]: Finished running node model.youtube_analytics.stg_youtube_video_ids
[0m14:45:25.091603 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model youtube_stg_youtube_stg.stg_youtube_channels  [[31mERROR[0m in 0.95s]
[0m14:45:25.091603 [debug] [Thread-7 (]: Marking all children of 'model.youtube_analytics.stg_youtube_video_stats' to be skipped because of status 'error'.  Reason: Database Error in model stg_youtube_video_stats (dbt/models\staging\stg_youtube_video_stats.sql)
  Syntax error: Unexpected ";" at [38:22]
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_video_stats.sql.
[0m14:45:25.091603 [debug] [Thread-1 (]: Finished running node model.youtube_analytics.stg_youtube_channels
[0m14:45:25.091603 [debug] [Thread-7 (]: Marking all children of 'model.youtube_analytics.stg_youtube_video_ids' to be skipped because of status 'error'.  Reason: Database Error in model stg_youtube_video_ids (dbt/models\staging\stg_youtube_video_ids.sql)
  Syntax error: Unexpected ";" at [10:50]
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_video_ids.sql.
[0m14:45:25.091603 [debug] [Thread-4 (]: Began running node model.youtube_analytics.fct_video_daily_metrics
[0m14:45:25.091603 [debug] [Thread-7 (]: Marking all children of 'model.youtube_analytics.stg_youtube_channels' to be skipped because of status 'error'.  Reason: Database Error in model stg_youtube_channels (dbt/models\staging\stg_youtube_channels.sql)
  Syntax error: Unexpected ";" at [18:19]
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_channels.sql.
[0m14:45:25.091603 [info ] [Thread-4 (]: 4 of 5 SKIP relation youtube_stg_youtube_analytics.fct_video_daily_metrics ..... [[33mSKIP[0m]
[0m14:45:25.091603 [debug] [Thread-4 (]: Finished running node model.youtube_analytics.fct_video_daily_metrics
[0m14:45:25.091603 [debug] [Thread-2 (]: Began running node model.youtube_analytics.agg_channel_trends_7d
[0m14:45:25.091603 [info ] [Thread-2 (]: 5 of 5 SKIP relation youtube_stg_youtube_analytics.agg_channel_trends_7d ....... [[33mSKIP[0m]
[0m14:45:25.103211 [debug] [Thread-2 (]: Finished running node model.youtube_analytics.agg_channel_trends_7d
[0m14:45:25.103211 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:45:25.188987 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:45:25.191012 [debug] [MainThread]: Connection 'create_orbital-nuance-471817-n0_youtube_stg_youtube_analytics' was properly closed.
[0m14:45:25.192015 [debug] [MainThread]: Connection 'create_orbital-nuance-471817-n0_youtube_stg_youtube_stg' was properly closed.
[0m14:45:25.193101 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics' was properly closed.
[0m14:45:25.194121 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg' was properly closed.
[0m14:45:25.195107 [debug] [MainThread]: Connection 'model.youtube_analytics.stg_youtube_channels' was properly closed.
[0m14:45:25.196126 [debug] [MainThread]: Connection 'model.youtube_analytics.stg_youtube_video_ids' was properly closed.
[0m14:45:25.197082 [debug] [MainThread]: Connection 'model.youtube_analytics.stg_youtube_video_stats' was properly closed.
[0m14:45:25.197989 [info ] [MainThread]: 
[0m14:45:25.199995 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 4.91 seconds (4.91s).
[0m14:45:25.202069 [debug] [MainThread]: Command end result
[0m14:45:25.252140 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m14:45:25.257480 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m14:45:25.270719 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\run_results.json
[0m14:45:25.271596 [info ] [MainThread]: 
[0m14:45:25.273607 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m14:45:25.274644 [info ] [MainThread]: 
[0m14:45:25.275796 [error] [MainThread]: [31mFailure in model stg_youtube_video_stats (dbt/models\staging\stg_youtube_video_stats.sql)[0m
[0m14:45:25.277820 [error] [MainThread]:   Database Error in model stg_youtube_video_stats (dbt/models\staging\stg_youtube_video_stats.sql)
  Syntax error: Unexpected ";" at [38:22]
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_video_stats.sql
[0m14:45:25.279824 [info ] [MainThread]: 
[0m14:45:25.280582 [info ] [MainThread]:   compiled code at target\compiled\youtube_analytics\dbt/models\staging\stg_youtube_video_stats.sql
[0m14:45:25.282761 [info ] [MainThread]: 
[0m14:45:25.283661 [error] [MainThread]: [31mFailure in model stg_youtube_video_ids (dbt/models\staging\stg_youtube_video_ids.sql)[0m
[0m14:45:25.285084 [error] [MainThread]:   Database Error in model stg_youtube_video_ids (dbt/models\staging\stg_youtube_video_ids.sql)
  Syntax error: Unexpected ";" at [10:50]
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_video_ids.sql
[0m14:45:25.287107 [info ] [MainThread]: 
[0m14:45:25.289147 [info ] [MainThread]:   compiled code at target\compiled\youtube_analytics\dbt/models\staging\stg_youtube_video_ids.sql
[0m14:45:25.290462 [info ] [MainThread]: 
[0m14:45:25.290462 [error] [MainThread]: [31mFailure in model stg_youtube_channels (dbt/models\staging\stg_youtube_channels.sql)[0m
[0m14:45:25.290462 [error] [MainThread]:   Database Error in model stg_youtube_channels (dbt/models\staging\stg_youtube_channels.sql)
  Syntax error: Unexpected ";" at [18:19]
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_channels.sql
[0m14:45:25.290462 [info ] [MainThread]: 
[0m14:45:25.290462 [info ] [MainThread]:   compiled code at target\compiled\youtube_analytics\dbt/models\staging\stg_youtube_channels.sql
[0m14:45:25.290462 [info ] [MainThread]: 
[0m14:45:25.290462 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=2 NO-OP=0 TOTAL=5
[0m14:45:25.290462 [debug] [MainThread]: Command `dbt run` failed at 14:45:25.290462 after 20.08 seconds
[0m14:45:25.290462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011BB0B40990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011BB0BC5DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011BB0BC5D10>]}
[0m14:45:25.290462 [debug] [MainThread]: Flushing usage events
[0m14:45:25.666756 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:50:42.804499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205BD15E9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205BD130890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205BD130950>]}


============================== 14:50:42.804499 | a18cd23c-0bd9-49e7-9f0c-670aa817ce79 ==============================
[0m14:50:42.804499 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:50:42.814289 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'empty': 'False', 'printer_width': '80', 'log_path': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m14:50:49.978280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a18cd23c-0bd9-49e7-9f0c-670aa817ce79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205EB889E90>]}
[0m14:50:50.200723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a18cd23c-0bd9-49e7-9f0c-670aa817ce79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205B9D82D50>]}
[0m14:50:50.200723 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m14:50:52.313514 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m14:50:53.060147 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m14:50:53.060147 [debug] [MainThread]: Partial parsing: updated file: youtube_analytics://dbt/models\marts\agg_channel_trends_7d.sql
[0m14:50:53.060147 [debug] [MainThread]: Partial parsing: updated file: youtube_analytics://dbt/models\staging\stg_youtube_video_ids.sql
[0m14:50:53.060147 [debug] [MainThread]: Partial parsing: updated file: youtube_analytics://dbt/models\marts\fct_video_daily_metrics.sql
[0m14:50:53.060147 [debug] [MainThread]: Partial parsing: updated file: youtube_analytics://dbt/models\staging\stg_youtube_channels.sql
[0m14:50:53.060147 [debug] [MainThread]: Partial parsing: updated file: youtube_analytics://dbt/models\staging\stg_youtube_video_stats.sql
[0m14:50:54.296076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a18cd23c-0bd9-49e7-9f0c-670aa817ce79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205ECF42B90>]}
[0m14:50:54.436029 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m14:50:54.451754 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m14:50:54.526152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a18cd23c-0bd9-49e7-9f0c-670aa817ce79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205ECD106D0>]}
[0m14:50:54.528146 [info ] [MainThread]: Found 5 models, 5 data tests, 495 macros
[0m14:50:54.530224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a18cd23c-0bd9-49e7-9f0c-670aa817ce79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205ED1D8050>]}
[0m14:50:54.533322 [info ] [MainThread]: 
[0m14:50:54.535226 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m14:50:54.536821 [info ] [MainThread]: 
[0m14:50:54.539475 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:50:54.539475 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0'
[0m14:50:54.549780 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0'
[0m14:50:54.549780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:54.549780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:55.554197 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg'
[0m14:50:55.554197 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics'
[0m14:50:55.554197 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:55.559512 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:56.271759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a18cd23c-0bd9-49e7-9f0c-670aa817ce79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205EC9A9450>]}
[0m14:50:56.271759 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:50:56.425548 [debug] [Thread-1 (]: Began running node model.youtube_analytics.stg_youtube_channels
[0m14:50:56.425548 [debug] [Thread-2 (]: Began running node model.youtube_analytics.stg_youtube_video_ids
[0m14:50:56.425548 [debug] [Thread-3 (]: Began running node model.youtube_analytics.stg_youtube_video_stats
[0m14:50:56.425548 [info ] [Thread-1 (]: 1 of 5 START sql view model youtube_stg_youtube_stg.stg_youtube_channels ....... [RUN]
[0m14:50:56.425548 [info ] [Thread-2 (]: 2 of 5 START sql view model youtube_stg_youtube_stg.stg_youtube_video_ids ...... [RUN]
[0m14:50:56.441803 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_channels'
[0m14:50:56.439360 [info ] [Thread-3 (]: 3 of 5 START sql view model youtube_stg_youtube_stg.stg_youtube_video_stats .... [RUN]
[0m14:50:56.443434 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_video_ids'
[0m14:50:56.443434 [debug] [Thread-1 (]: Began compiling node model.youtube_analytics.stg_youtube_channels
[0m14:50:56.443434 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_video_stats'
[0m14:50:56.443434 [debug] [Thread-2 (]: Began compiling node model.youtube_analytics.stg_youtube_video_ids
[0m14:50:56.457446 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_channels"
[0m14:50:56.457446 [debug] [Thread-3 (]: Began compiling node model.youtube_analytics.stg_youtube_video_stats
[0m14:50:56.469804 [debug] [Thread-2 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_video_ids"
[0m14:50:56.478940 [debug] [Thread-3 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_video_stats"
[0m14:50:56.480090 [debug] [Thread-1 (]: Began executing node model.youtube_analytics.stg_youtube_channels
[0m14:50:56.505471 [debug] [Thread-2 (]: Began executing node model.youtube_analytics.stg_youtube_video_ids
[0m14:50:56.505471 [debug] [Thread-3 (]: Began executing node model.youtube_analytics.stg_youtube_video_stats
[0m14:50:56.537118 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_channels"
[0m14:50:56.556739 [debug] [Thread-2 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_video_ids"
[0m14:50:56.558750 [debug] [Thread-3 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_video_stats"
[0m14:50:56.558750 [debug] [Thread-1 (]: On model.youtube_analytics.stg_youtube_channels: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_channels"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_channels`
  OPTIONS()
  as with src as (
  select
    id                                        as channel_id,
    snippet.title                             as channel_title,
    snippet.country                           as channel_country,
    snippet.publishedAt                       as channel_published_at,
    cast(statistics.viewCount       as int64) as channel_view_count,
    cast(statistics.subscriberCount as int64) as channel_subscribers,
    cast(statistics.videoCount      as int64) as channel_video_count,
    date(_partitiontime)                      as load_date
  from `YOUR_PROJECT_ID.youtube_raw.channels_raw`
)
select * from src;


[0m14:50:56.569161 [debug] [Thread-2 (]: On model.youtube_analytics.stg_youtube_video_ids: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_video_ids"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_ids`
  OPTIONS()
  as select
  videoId              as video_id,
  channelId            as channel_id,
  date(_partitiontime) as load_date
from `YOUR_PROJECT_ID.youtube_raw.video_ids_raw`;


[0m14:50:56.569161 [debug] [Thread-3 (]: On model.youtube_analytics.stg_youtube_video_stats: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_video_stats"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
  OPTIONS()
  as with src as (
  select
    id                                     as video_id,
    snippet.channelId                      as channel_id,
    snippet.title                          as video_title,
    snippet.publishedAt                    as video_published_at,
    cast(statistics.viewCount    as int64) as views,
    cast(statistics.likeCount    as int64) as likes,
    cast(statistics.commentCount as int64) as comments,
    contentDetails.duration                as duration_iso,
    date(_partitiontime)                   as load_date
  from `YOUR_PROJECT_ID.youtube_raw.video_stats_raw`
),
parsed as (
  -- Parse durations like PT5M13S into seconds
  select
    *,
    (
      coalesce(
        safe.cast(regexp_extract(duration_iso, r'(\d+)H') as int64), 0
      ) * 3600
      +
      coalesce(
        safe.cast(regexp_extract(duration_iso, r'(\d+)M') as int64), 0
      ) * 60
      +
      coalesce(
        safe.cast(regexp_extract(duration_iso, r'(\d+)S') as int64), 0
      )
    ) as duration_seconds
  from src
)
select * from parsed;


[0m14:50:56.569161 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:50:56.569161 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:50:56.569161 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:50:57.392944 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:6f21e315-092c-4242-b7a2-6e928efc3727&page=queryresults
[0m14:50:57.394885 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:4fbc8217-cb78-4327-9767-fa6ad913b321&page=queryresults
[0m14:50:57.396246 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:6f21e315-092c-4242-b7a2-6e928efc3727&page=queryresults
[0m14:50:57.398328 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:4fbc8217-cb78-4327-9767-fa6ad913b321&page=queryresults
[0m14:50:57.406048 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:312c7566-2e01-46bd-a9f5-28d97b5bf368&page=queryresults
[0m14:50:57.407029 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:312c7566-2e01-46bd-a9f5-28d97b5bf368&page=queryresults
[0m14:50:57.411807 [debug] [Thread-1 (]: Database Error in model stg_youtube_channels (dbt/models\staging\stg_youtube_channels.sql)
  Invalid project ID 'YOUR_PROJECT_ID'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_channels.sql
[0m14:50:57.413845 [debug] [Thread-3 (]: Database Error in model stg_youtube_video_stats (dbt/models\staging\stg_youtube_video_stats.sql)
  Invalid project ID 'YOUR_PROJECT_ID'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_video_stats.sql
[0m14:50:57.414827 [debug] [Thread-2 (]: Database Error in model stg_youtube_video_ids (dbt/models\staging\stg_youtube_video_ids.sql)
  Invalid project ID 'YOUR_PROJECT_ID'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_video_ids.sql
[0m14:50:57.416813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a18cd23c-0bd9-49e7-9f0c-670aa817ce79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205ED029ED0>]}
[0m14:50:57.416813 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a18cd23c-0bd9-49e7-9f0c-670aa817ce79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205ED34F810>]}
[0m14:50:57.417813 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a18cd23c-0bd9-49e7-9f0c-670aa817ce79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205ED302290>]}
[0m14:50:57.418813 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model youtube_stg_youtube_stg.stg_youtube_channels  [[31mERROR[0m in 0.98s]
[0m14:50:57.419813 [error] [Thread-3 (]: 3 of 5 ERROR creating sql view model youtube_stg_youtube_stg.stg_youtube_video_stats  [[31mERROR[0m in 0.97s]
[0m14:50:57.419813 [debug] [Thread-1 (]: Finished running node model.youtube_analytics.stg_youtube_channels
[0m14:50:57.419813 [error] [Thread-2 (]: 2 of 5 ERROR creating sql view model youtube_stg_youtube_stg.stg_youtube_video_ids  [[31mERROR[0m in 0.97s]
[0m14:50:57.419813 [debug] [Thread-3 (]: Finished running node model.youtube_analytics.stg_youtube_video_stats
[0m14:50:57.419813 [debug] [Thread-7 (]: Marking all children of 'model.youtube_analytics.stg_youtube_channels' to be skipped because of status 'error'.  Reason: Database Error in model stg_youtube_channels (dbt/models\staging\stg_youtube_channels.sql)
  Invalid project ID 'YOUR_PROJECT_ID'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_channels.sql.
[0m14:50:57.419813 [debug] [Thread-2 (]: Finished running node model.youtube_analytics.stg_youtube_video_ids
[0m14:50:57.419813 [debug] [Thread-7 (]: Marking all children of 'model.youtube_analytics.stg_youtube_video_stats' to be skipped because of status 'error'.  Reason: Database Error in model stg_youtube_video_stats (dbt/models\staging\stg_youtube_video_stats.sql)
  Invalid project ID 'YOUR_PROJECT_ID'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_video_stats.sql.
[0m14:50:57.419813 [debug] [Thread-7 (]: Marking all children of 'model.youtube_analytics.stg_youtube_video_ids' to be skipped because of status 'error'.  Reason: Database Error in model stg_youtube_video_ids (dbt/models\staging\stg_youtube_video_ids.sql)
  Invalid project ID 'YOUR_PROJECT_ID'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_video_ids.sql.
[0m14:50:57.419813 [debug] [Thread-4 (]: Began running node model.youtube_analytics.fct_video_daily_metrics
[0m14:50:57.419813 [info ] [Thread-4 (]: 4 of 5 SKIP relation youtube_stg_youtube_analytics.fct_video_daily_metrics ..... [[33mSKIP[0m]
[0m14:50:57.419813 [debug] [Thread-4 (]: Finished running node model.youtube_analytics.fct_video_daily_metrics
[0m14:50:57.419813 [debug] [Thread-3 (]: Began running node model.youtube_analytics.agg_channel_trends_7d
[0m14:50:57.419813 [info ] [Thread-3 (]: 5 of 5 SKIP relation youtube_stg_youtube_analytics.agg_channel_trends_7d ....... [[33mSKIP[0m]
[0m14:50:57.419813 [debug] [Thread-3 (]: Finished running node model.youtube_analytics.agg_channel_trends_7d
[0m14:50:57.435854 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:50:57.534695 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:50:57.534695 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0' was properly closed.
[0m14:50:57.548006 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0' was properly closed.
[0m14:50:57.548006 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg' was properly closed.
[0m14:50:57.548006 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics' was properly closed.
[0m14:50:57.548006 [debug] [MainThread]: Connection 'model.youtube_analytics.stg_youtube_channels' was properly closed.
[0m14:50:57.548006 [debug] [MainThread]: Connection 'model.youtube_analytics.stg_youtube_video_ids' was properly closed.
[0m14:50:57.548006 [debug] [MainThread]: Connection 'model.youtube_analytics.stg_youtube_video_stats' was properly closed.
[0m14:50:57.548006 [info ] [MainThread]: 
[0m14:50:57.548006 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 3.01 seconds (3.01s).
[0m14:50:57.548006 [debug] [MainThread]: Command end result
[0m14:50:57.608336 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m14:50:57.611634 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m14:50:57.611634 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\run_results.json
[0m14:50:57.611634 [info ] [MainThread]: 
[0m14:50:57.627315 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m14:50:57.627315 [info ] [MainThread]: 
[0m14:50:57.627315 [error] [MainThread]: [31mFailure in model stg_youtube_channels (dbt/models\staging\stg_youtube_channels.sql)[0m
[0m14:50:57.627315 [error] [MainThread]:   Database Error in model stg_youtube_channels (dbt/models\staging\stg_youtube_channels.sql)
  Invalid project ID 'YOUR_PROJECT_ID'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_channels.sql
[0m14:50:57.627315 [info ] [MainThread]: 
[0m14:50:57.627315 [info ] [MainThread]:   compiled code at target\compiled\youtube_analytics\dbt/models\staging\stg_youtube_channels.sql
[0m14:50:57.627315 [info ] [MainThread]: 
[0m14:50:57.627315 [error] [MainThread]: [31mFailure in model stg_youtube_video_stats (dbt/models\staging\stg_youtube_video_stats.sql)[0m
[0m14:50:57.627315 [error] [MainThread]:   Database Error in model stg_youtube_video_stats (dbt/models\staging\stg_youtube_video_stats.sql)
  Invalid project ID 'YOUR_PROJECT_ID'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_video_stats.sql
[0m14:50:57.627315 [info ] [MainThread]: 
[0m14:50:57.643203 [info ] [MainThread]:   compiled code at target\compiled\youtube_analytics\dbt/models\staging\stg_youtube_video_stats.sql
[0m14:50:57.643203 [info ] [MainThread]: 
[0m14:50:57.643203 [error] [MainThread]: [31mFailure in model stg_youtube_video_ids (dbt/models\staging\stg_youtube_video_ids.sql)[0m
[0m14:50:57.643203 [error] [MainThread]:   Database Error in model stg_youtube_video_ids (dbt/models\staging\stg_youtube_video_ids.sql)
  Invalid project ID 'YOUR_PROJECT_ID'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_video_ids.sql
[0m14:50:57.643203 [info ] [MainThread]: 
[0m14:50:57.643203 [info ] [MainThread]:   compiled code at target\compiled\youtube_analytics\dbt/models\staging\stg_youtube_video_ids.sql
[0m14:50:57.643203 [info ] [MainThread]: 
[0m14:50:57.643203 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=2 NO-OP=0 TOTAL=5
[0m14:50:57.643203 [debug] [MainThread]: Command `dbt run` failed at 14:50:57.643203 after 14.92 seconds
[0m14:50:57.659414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205B6800990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205B6800A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205BC7CE410>]}
[0m14:50:57.659414 [debug] [MainThread]: Flushing usage events
[0m14:50:58.052253 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:53:17.146522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD126A5650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD15A9E650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD15A70750>]}


============================== 14:53:17.151067 | 7273ce77-692e-465c-9040-4146a72352ce ==============================
[0m14:53:17.151067 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:53:17.152066 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m14:53:23.956386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7273ce77-692e-465c-9040-4146a72352ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD441BAED0>]}
[0m14:53:24.134753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7273ce77-692e-465c-9040-4146a72352ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD126B28D0>]}
[0m14:53:24.136641 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m14:53:25.663522 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m14:53:26.325791 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m14:53:26.327745 [debug] [MainThread]: Partial parsing: updated file: youtube_analytics://dbt/models\staging\stg_youtube_video_ids.sql
[0m14:53:26.329667 [debug] [MainThread]: Partial parsing: updated file: youtube_analytics://dbt/models\staging\stg_youtube_video_stats.sql
[0m14:53:26.330787 [debug] [MainThread]: Partial parsing: updated file: youtube_analytics://dbt/models\staging\stg_youtube_channels.sql
[0m14:53:27.513221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7273ce77-692e-465c-9040-4146a72352ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD458295D0>]}
[0m14:53:27.683954 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m14:53:27.688848 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m14:53:27.750215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7273ce77-692e-465c-9040-4146a72352ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD45B07290>]}
[0m14:53:27.752215 [info ] [MainThread]: Found 5 models, 5 data tests, 495 macros
[0m14:53:27.754382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7273ce77-692e-465c-9040-4146a72352ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD45B25910>]}
[0m14:53:27.756798 [info ] [MainThread]: 
[0m14:53:27.758999 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m14:53:27.761103 [info ] [MainThread]: 
[0m14:53:27.764076 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:53:27.774922 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0'
[0m14:53:27.776915 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0'
[0m14:53:27.777931 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:27.779595 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:28.506302 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg'
[0m14:53:28.509479 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics'
[0m14:53:28.510575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:28.511481 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:29.107213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7273ce77-692e-465c-9040-4146a72352ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD4584BC90>]}
[0m14:53:29.109118 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:53:29.233066 [debug] [Thread-1 (]: Began running node model.youtube_analytics.stg_youtube_channels
[0m14:53:29.234065 [debug] [Thread-2 (]: Began running node model.youtube_analytics.stg_youtube_video_ids
[0m14:53:29.235064 [debug] [Thread-3 (]: Began running node model.youtube_analytics.stg_youtube_video_stats
[0m14:53:29.237065 [info ] [Thread-1 (]: 1 of 5 START sql view model youtube_stg_youtube_stg.stg_youtube_channels ....... [RUN]
[0m14:53:29.238985 [info ] [Thread-2 (]: 2 of 5 START sql view model youtube_stg_youtube_stg.stg_youtube_video_ids ...... [RUN]
[0m14:53:29.240100 [info ] [Thread-3 (]: 3 of 5 START sql view model youtube_stg_youtube_stg.stg_youtube_video_stats .... [RUN]
[0m14:53:29.243104 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_channels'
[0m14:53:29.245174 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_video_ids'
[0m14:53:29.247050 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_video_stats'
[0m14:53:29.248158 [debug] [Thread-1 (]: Began compiling node model.youtube_analytics.stg_youtube_channels
[0m14:53:29.249175 [debug] [Thread-2 (]: Began compiling node model.youtube_analytics.stg_youtube_video_ids
[0m14:53:29.251062 [debug] [Thread-3 (]: Began compiling node model.youtube_analytics.stg_youtube_video_stats
[0m14:53:29.263916 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_channels"
[0m14:53:29.267920 [debug] [Thread-2 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_video_ids"
[0m14:53:29.272455 [debug] [Thread-3 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_video_stats"
[0m14:53:29.275495 [debug] [Thread-1 (]: Began executing node model.youtube_analytics.stg_youtube_channels
[0m14:53:29.277998 [debug] [Thread-2 (]: Began executing node model.youtube_analytics.stg_youtube_video_ids
[0m14:53:29.342750 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_channels"
[0m14:53:29.343711 [debug] [Thread-3 (]: Began executing node model.youtube_analytics.stg_youtube_video_stats
[0m14:53:29.350143 [debug] [Thread-2 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_video_ids"
[0m14:53:29.357020 [debug] [Thread-3 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_video_stats"
[0m14:53:29.357971 [debug] [Thread-1 (]: On model.youtube_analytics.stg_youtube_channels: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_channels"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_channels`
  OPTIONS()
  as with src as (
  select
    id                                        as channel_id,
    snippet.title                             as channel_title,
    snippet.country                           as channel_country,
    snippet.publishedAt                       as channel_published_at,
    cast(statistics.viewCount       as int64) as channel_view_count,
    cast(statistics.subscriberCount as int64) as channel_subscribers,
    cast(statistics.videoCount      as int64) as channel_video_count,
    date(_partitiontime)                      as load_date
  from `orbital-nuance-471817-n0.youtube_raw.channels_raw`
)
select * from src;


[0m14:53:29.359899 [debug] [Thread-2 (]: On model.youtube_analytics.stg_youtube_video_ids: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_video_ids"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_ids`
  OPTIONS()
  as select
  videoId              as video_id,
  channelId            as channel_id,
  date(_partitiontime) as load_date
from `orbital-nuance-471817-n0.youtube_raw.video_ids_raw`;


[0m14:53:29.361895 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:53:29.362898 [debug] [Thread-3 (]: On model.youtube_analytics.stg_youtube_video_stats: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_video_stats"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
  OPTIONS()
  as with src as (
  select
    id                                     as video_id,
    snippet.channelId                      as channel_id,
    snippet.title                          as video_title,
    snippet.publishedAt                    as video_published_at,
    cast(statistics.viewCount    as int64) as views,
    cast(statistics.likeCount    as int64) as likes,
    cast(statistics.commentCount as int64) as comments,
    contentDetails.duration                as duration_iso,
    date(_partitiontime)                   as load_date
  from `orbital-nuance-471817-n0.youtube_raw.video_stats_raw`
),
parsed as (
  -- Parse durations like PT5M13S into seconds
  select
    *,
    (
      coalesce(
        safe.cast(regexp_extract(duration_iso, r'(\d+)H') as int64), 0
      ) * 3600
      +
      coalesce(
        safe.cast(regexp_extract(duration_iso, r'(\d+)M') as int64), 0
      ) * 60
      +
      coalesce(
        safe.cast(regexp_extract(duration_iso, r'(\d+)S') as int64), 0
      )
    ) as duration_seconds
  from src
)
select * from parsed;


[0m14:53:29.364974 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:53:29.480265 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:53:30.277391 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:641fba33-ce41-4cf0-b534-e23f7f9bdc0d&page=queryresults
[0m14:53:30.279384 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:8334bc12-cf13-4a40-a581-435494536897&page=queryresults
[0m14:53:30.298254 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:0f635dc3-c51a-4e46-8570-c14ccb11c4a0&page=queryresults
[0m14:53:30.480987 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:0f635dc3-c51a-4e46-8570-c14ccb11c4a0&page=queryresults
[0m14:53:30.482885 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:8334bc12-cf13-4a40-a581-435494536897&page=queryresults
[0m14:53:30.488011 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:641fba33-ce41-4cf0-b534-e23f7f9bdc0d&page=queryresults
[0m14:53:30.498850 [debug] [Thread-3 (]: Database Error in model stg_youtube_video_stats (dbt/models\staging\stg_youtube_video_stats.sql)
  Unrecognized name: _partitiontime at [16:10]
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_video_stats.sql
[0m14:53:30.502950 [debug] [Thread-2 (]: Database Error in model stg_youtube_video_ids (dbt/models\staging\stg_youtube_video_ids.sql)
  Unrecognized name: _partitiontime at [9:8]
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_video_ids.sql
[0m14:53:30.502950 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7273ce77-692e-465c-9040-4146a72352ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD45C8E4D0>]}
[0m14:53:30.506256 [debug] [Thread-1 (]: Database Error in model stg_youtube_channels (dbt/models\staging\stg_youtube_channels.sql)
  Unrecognized name: _partitiontime at [15:10]
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_channels.sql
[0m14:53:30.507350 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7273ce77-692e-465c-9040-4146a72352ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD45C1F7D0>]}
[0m14:53:30.509467 [error] [Thread-3 (]: 3 of 5 ERROR creating sql view model youtube_stg_youtube_stg.stg_youtube_video_stats  [[31mERROR[0m in 1.25s]
[0m14:53:30.511095 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7273ce77-692e-465c-9040-4146a72352ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD45A90790>]}
[0m14:53:30.512638 [debug] [Thread-3 (]: Finished running node model.youtube_analytics.stg_youtube_video_stats
[0m14:53:30.511095 [error] [Thread-2 (]: 2 of 5 ERROR creating sql view model youtube_stg_youtube_stg.stg_youtube_video_ids  [[31mERROR[0m in 1.26s]
[0m14:53:30.513648 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model youtube_stg_youtube_stg.stg_youtube_channels  [[31mERROR[0m in 1.27s]
[0m14:53:30.514648 [debug] [Thread-7 (]: Marking all children of 'model.youtube_analytics.stg_youtube_video_stats' to be skipped because of status 'error'.  Reason: Database Error in model stg_youtube_video_stats (dbt/models\staging\stg_youtube_video_stats.sql)
  Unrecognized name: _partitiontime at [16:10]
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_video_stats.sql.
[0m14:53:30.516647 [debug] [Thread-2 (]: Finished running node model.youtube_analytics.stg_youtube_video_ids
[0m14:53:30.516647 [debug] [Thread-1 (]: Finished running node model.youtube_analytics.stg_youtube_channels
[0m14:53:30.519832 [debug] [Thread-4 (]: Began running node model.youtube_analytics.fct_video_daily_metrics
[0m14:53:30.522314 [debug] [Thread-7 (]: Marking all children of 'model.youtube_analytics.stg_youtube_video_ids' to be skipped because of status 'error'.  Reason: Database Error in model stg_youtube_video_ids (dbt/models\staging\stg_youtube_video_ids.sql)
  Unrecognized name: _partitiontime at [9:8]
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_video_ids.sql.
[0m14:53:30.525330 [info ] [Thread-4 (]: 4 of 5 SKIP relation youtube_stg_youtube_analytics.fct_video_daily_metrics ..... [[33mSKIP[0m]
[0m14:53:30.528327 [debug] [Thread-7 (]: Marking all children of 'model.youtube_analytics.stg_youtube_channels' to be skipped because of status 'error'.  Reason: Database Error in model stg_youtube_channels (dbt/models\staging\stg_youtube_channels.sql)
  Unrecognized name: _partitiontime at [15:10]
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_channels.sql.
[0m14:53:30.531329 [debug] [Thread-4 (]: Finished running node model.youtube_analytics.fct_video_daily_metrics
[0m14:53:30.536328 [debug] [Thread-3 (]: Began running node model.youtube_analytics.agg_channel_trends_7d
[0m14:53:30.537313 [info ] [Thread-3 (]: 5 of 5 SKIP relation youtube_stg_youtube_analytics.agg_channel_trends_7d ....... [[33mSKIP[0m]
[0m14:53:30.537730 [debug] [Thread-3 (]: Finished running node model.youtube_analytics.agg_channel_trends_7d
[0m14:53:30.540920 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:53:30.760690 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:53:30.762696 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0' was properly closed.
[0m14:53:30.764699 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0' was properly closed.
[0m14:53:30.766578 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg' was properly closed.
[0m14:53:30.768653 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics' was properly closed.
[0m14:53:30.770545 [debug] [MainThread]: Connection 'model.youtube_analytics.stg_youtube_channels' was properly closed.
[0m14:53:30.770953 [debug] [MainThread]: Connection 'model.youtube_analytics.stg_youtube_video_ids' was properly closed.
[0m14:53:30.773119 [debug] [MainThread]: Connection 'model.youtube_analytics.stg_youtube_video_stats' was properly closed.
[0m14:53:30.775075 [info ] [MainThread]: 
[0m14:53:30.777837 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 3.01 seconds (3.01s).
[0m14:53:30.781372 [debug] [MainThread]: Command end result
[0m14:53:30.837471 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m14:53:30.842512 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m14:53:30.858577 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\run_results.json
[0m14:53:30.860462 [info ] [MainThread]: 
[0m14:53:30.861439 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m14:53:30.863328 [info ] [MainThread]: 
[0m14:53:30.865464 [error] [MainThread]: [31mFailure in model stg_youtube_video_stats (dbt/models\staging\stg_youtube_video_stats.sql)[0m
[0m14:53:30.867371 [error] [MainThread]:   Database Error in model stg_youtube_video_stats (dbt/models\staging\stg_youtube_video_stats.sql)
  Unrecognized name: _partitiontime at [16:10]
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_video_stats.sql
[0m14:53:30.868430 [info ] [MainThread]: 
[0m14:53:30.870997 [info ] [MainThread]:   compiled code at target\compiled\youtube_analytics\dbt/models\staging\stg_youtube_video_stats.sql
[0m14:53:30.873260 [info ] [MainThread]: 
[0m14:53:30.875214 [error] [MainThread]: [31mFailure in model stg_youtube_video_ids (dbt/models\staging\stg_youtube_video_ids.sql)[0m
[0m14:53:30.876339 [error] [MainThread]:   Database Error in model stg_youtube_video_ids (dbt/models\staging\stg_youtube_video_ids.sql)
  Unrecognized name: _partitiontime at [9:8]
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_video_ids.sql
[0m14:53:30.878331 [info ] [MainThread]: 
[0m14:53:30.879207 [info ] [MainThread]:   compiled code at target\compiled\youtube_analytics\dbt/models\staging\stg_youtube_video_ids.sql
[0m14:53:30.881222 [info ] [MainThread]: 
[0m14:53:30.882208 [error] [MainThread]: [31mFailure in model stg_youtube_channels (dbt/models\staging\stg_youtube_channels.sql)[0m
[0m14:53:30.884222 [error] [MainThread]:   Database Error in model stg_youtube_channels (dbt/models\staging\stg_youtube_channels.sql)
  Unrecognized name: _partitiontime at [15:10]
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_channels.sql
[0m14:53:30.885208 [info ] [MainThread]: 
[0m14:53:30.886967 [info ] [MainThread]:   compiled code at target\compiled\youtube_analytics\dbt/models\staging\stg_youtube_channels.sql
[0m14:53:30.887706 [info ] [MainThread]: 
[0m14:53:30.890378 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=2 NO-OP=0 TOTAL=5
[0m14:53:30.893286 [debug] [MainThread]: Command `dbt run` failed at 14:53:30.893286 after 13.82 seconds
[0m14:53:30.895566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD0F0D0990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD15A9E990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD15A78410>]}
[0m14:53:30.897558 [debug] [MainThread]: Flushing usage events
[0m14:53:31.306021 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:03:59.953931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002475D44F190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002475D4207D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002475D420510>]}


============================== 15:03:59.957953 | ec854a9e-14f5-4442-9068-c39472fef050 ==============================
[0m15:03:59.957953 [info ] [MainThread]: Running with dbt=1.10.11
[0m15:03:59.958935 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'False', 'printer_width': '80', 'quiet': 'False', 'log_path': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt'}
[0m15:04:07.182772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec854a9e-14f5-4442-9068-c39472fef050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002475D477090>]}
[0m15:04:07.400576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec854a9e-14f5-4442-9068-c39472fef050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002475A073650>]}
[0m15:04:07.400576 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m15:04:09.570813 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m15:04:10.227272 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:04:10.227272 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:04:10.308661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec854a9e-14f5-4442-9068-c39472fef050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002470D08C9D0>]}
[0m15:04:10.462004 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m15:04:10.468593 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m15:04:10.525229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec854a9e-14f5-4442-9068-c39472fef050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002470BD58A90>]}
[0m15:04:10.525229 [info ] [MainThread]: Found 5 models, 5 data tests, 495 macros
[0m15:04:10.529953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec854a9e-14f5-4442-9068-c39472fef050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002470BCE21D0>]}
[0m15:04:10.529953 [info ] [MainThread]: 
[0m15:04:10.529953 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m15:04:10.529953 [info ] [MainThread]: 
[0m15:04:10.537706 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:04:10.549866 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0'
[0m15:04:10.551673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:10.552814 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0'
[0m15:04:10.635156 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:11.309222 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg'
[0m15:04:11.312238 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:11.313237 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics'
[0m15:04:11.404487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:11.965255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec854a9e-14f5-4442-9068-c39472fef050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002470BC61390>]}
[0m15:04:11.967260 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:04:12.088260 [debug] [Thread-1 (]: Began running node model.youtube_analytics.stg_youtube_channels
[0m15:04:12.088260 [debug] [Thread-2 (]: Began running node model.youtube_analytics.stg_youtube_video_ids
[0m15:04:12.088260 [debug] [Thread-3 (]: Began running node model.youtube_analytics.stg_youtube_video_stats
[0m15:04:12.088260 [info ] [Thread-1 (]: 1 of 5 START sql view model youtube_stg_youtube_stg.stg_youtube_channels ....... [RUN]
[0m15:04:12.088260 [info ] [Thread-2 (]: 2 of 5 START sql view model youtube_stg_youtube_stg.stg_youtube_video_ids ...... [RUN]
[0m15:04:12.088260 [info ] [Thread-3 (]: 3 of 5 START sql view model youtube_stg_youtube_stg.stg_youtube_video_stats .... [RUN]
[0m15:04:12.088260 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_channels'
[0m15:04:12.099337 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_video_ids'
[0m15:04:12.099337 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_video_stats'
[0m15:04:12.104024 [debug] [Thread-1 (]: Began compiling node model.youtube_analytics.stg_youtube_channels
[0m15:04:12.104024 [debug] [Thread-2 (]: Began compiling node model.youtube_analytics.stg_youtube_video_ids
[0m15:04:12.104024 [debug] [Thread-3 (]: Began compiling node model.youtube_analytics.stg_youtube_video_stats
[0m15:04:12.126359 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_channels"
[0m15:04:12.131373 [debug] [Thread-2 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_video_ids"
[0m15:04:12.138184 [debug] [Thread-3 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_video_stats"
[0m15:04:12.138184 [debug] [Thread-1 (]: Began executing node model.youtube_analytics.stg_youtube_channels
[0m15:04:12.138184 [debug] [Thread-2 (]: Began executing node model.youtube_analytics.stg_youtube_video_ids
[0m15:04:12.186036 [debug] [Thread-3 (]: Began executing node model.youtube_analytics.stg_youtube_video_stats
[0m15:04:12.226210 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_channels"
[0m15:04:12.228041 [debug] [Thread-2 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_video_ids"
[0m15:04:12.239732 [debug] [Thread-3 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_video_stats"
[0m15:04:12.239732 [debug] [Thread-1 (]: On model.youtube_analytics.stg_youtube_channels: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_channels"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_channels`
  OPTIONS()
  as with src as (
  select
    id                                        as channel_id,
    snippet.title                             as channel_title,
    snippet.country                           as channel_country,
    snippet.publishedAt                       as channel_published_at,
    cast(statistics.viewCount       as int64) as channel_view_count,
    cast(statistics.subscriberCount as int64) as channel_subscribers,
    cast(statistics.videoCount      as int64) as channel_video_count,
    date(_partitiontime)                      as load_date
  from `orbital-nuance-471817-n0.youtube_raw.channels_raw`
)
select * from src;


[0m15:04:12.243886 [debug] [Thread-2 (]: On model.youtube_analytics.stg_youtube_video_ids: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_video_ids"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_ids`
  OPTIONS()
  as select
  videoId              as video_id,
  channelId            as channel_id,
  date(_partitiontime) as load_date
from `orbital-nuance-471817-n0.youtube_raw.video_ids_raw`;


[0m15:04:12.243886 [debug] [Thread-3 (]: On model.youtube_analytics.stg_youtube_video_stats: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_video_stats"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
  OPTIONS()
  as with src as (
  select
    id                                     as video_id,
    snippet.channelId                      as channel_id,
    snippet.title                          as video_title,
    snippet.publishedAt                    as video_published_at,
    cast(statistics.viewCount    as int64) as views,
    cast(statistics.likeCount    as int64) as likes,
    cast(statistics.commentCount as int64) as comments,
    contentDetails.duration                as duration_iso,
    date(_partitiontime)                   as load_date
  from `orbital-nuance-471817-n0.youtube_raw.video_stats_raw`
),
parsed as (
  -- Parse durations like PT5M13S into seconds
  select
    *,
    (
      coalesce(
        safe.cast(regexp_extract(duration_iso, r'(\d+)H') as int64), 0
      ) * 3600
      +
      coalesce(
        safe.cast(regexp_extract(duration_iso, r'(\d+)M') as int64), 0
      ) * 60
      +
      coalesce(
        safe.cast(regexp_extract(duration_iso, r'(\d+)S') as int64), 0
      )
    ) as duration_seconds
  from src
)
select * from parsed;


[0m15:04:12.247142 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:04:12.247142 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:04:12.247142 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:04:13.338776 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:03b6d25e-60c2-4094-9911-5a1179eba2c0&page=queryresults
[0m15:04:13.347600 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:5c5361ab-a642-418e-8ae9-c7f41e564d6c&page=queryresults
[0m15:04:13.385507 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:6f2a0486-b969-4833-a34f-de21f961250f&page=queryresults
[0m15:04:13.593620 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:6f2a0486-b969-4833-a34f-de21f961250f&page=queryresults
[0m15:04:13.603347 [debug] [Thread-3 (]: Database Error in model stg_youtube_video_stats (dbt/models\staging\stg_youtube_video_stats.sql)
  Function not found: `cast` at [25:9]
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_video_stats.sql
[0m15:04:13.607431 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec854a9e-14f5-4442-9068-c39472fef050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002470D2FEB90>]}
[0m15:04:13.608431 [error] [Thread-3 (]: 3 of 5 ERROR creating sql view model youtube_stg_youtube_stg.stg_youtube_video_stats  [[31mERROR[0m in 1.51s]
[0m15:04:13.609292 [debug] [Thread-3 (]: Finished running node model.youtube_analytics.stg_youtube_video_stats
[0m15:04:13.610390 [debug] [Thread-7 (]: Marking all children of 'model.youtube_analytics.stg_youtube_video_stats' to be skipped because of status 'error'.  Reason: Database Error in model stg_youtube_video_stats (dbt/models\staging\stg_youtube_video_stats.sql)
  Function not found: `cast` at [25:9]
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_video_stats.sql.
[0m15:04:13.612532 [debug] [Thread-4 (]: Began running node model.youtube_analytics.fct_video_daily_metrics
[0m15:04:13.614741 [info ] [Thread-4 (]: 4 of 5 SKIP relation youtube_stg_youtube_analytics.fct_video_daily_metrics ..... [[33mSKIP[0m]
[0m15:04:13.616794 [debug] [Thread-4 (]: Finished running node model.youtube_analytics.fct_video_daily_metrics
[0m15:04:13.617806 [debug] [Thread-3 (]: Began running node model.youtube_analytics.agg_channel_trends_7d
[0m15:04:13.617806 [info ] [Thread-3 (]: 5 of 5 SKIP relation youtube_stg_youtube_analytics.agg_channel_trends_7d ....... [[33mSKIP[0m]
[0m15:04:13.617806 [debug] [Thread-3 (]: Finished running node model.youtube_analytics.agg_channel_trends_7d
[0m15:04:13.890823 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec854a9e-14f5-4442-9068-c39472fef050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002470D1064D0>]}
[0m15:04:13.890823 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec854a9e-14f5-4442-9068-c39472fef050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002470D086010>]}
[0m15:04:13.890823 [info ] [Thread-1 (]: 1 of 5 OK created sql view model youtube_stg_youtube_stg.stg_youtube_channels .. [[32mCREATE VIEW (0 processed)[0m in 1.80s]
[0m15:04:13.899510 [info ] [Thread-2 (]: 2 of 5 OK created sql view model youtube_stg_youtube_stg.stg_youtube_video_ids . [[32mCREATE VIEW (0 processed)[0m in 1.79s]
[0m15:04:13.899510 [debug] [Thread-1 (]: Finished running node model.youtube_analytics.stg_youtube_channels
[0m15:04:13.899510 [debug] [Thread-2 (]: Finished running node model.youtube_analytics.stg_youtube_video_ids
[0m15:04:13.899510 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:04:14.009441 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:04:14.009441 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0' was properly closed.
[0m15:04:14.009441 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0' was properly closed.
[0m15:04:14.009441 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg' was properly closed.
[0m15:04:14.009441 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics' was properly closed.
[0m15:04:14.009441 [debug] [MainThread]: Connection 'model.youtube_analytics.stg_youtube_channels' was properly closed.
[0m15:04:14.025170 [debug] [MainThread]: Connection 'model.youtube_analytics.stg_youtube_video_ids' was properly closed.
[0m15:04:14.025170 [debug] [MainThread]: Connection 'model.youtube_analytics.stg_youtube_video_stats' was properly closed.
[0m15:04:14.027468 [info ] [MainThread]: 
[0m15:04:14.028528 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 3.50 seconds (3.50s).
[0m15:04:14.031943 [debug] [MainThread]: Command end result
[0m15:04:14.072018 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m15:04:14.072018 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m15:04:14.104248 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\run_results.json
[0m15:04:14.104248 [info ] [MainThread]: 
[0m15:04:14.104248 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:04:14.104248 [info ] [MainThread]: 
[0m15:04:14.104248 [error] [MainThread]: [31mFailure in model stg_youtube_video_stats (dbt/models\staging\stg_youtube_video_stats.sql)[0m
[0m15:04:14.104248 [error] [MainThread]:   Database Error in model stg_youtube_video_stats (dbt/models\staging\stg_youtube_video_stats.sql)
  Function not found: `cast` at [25:9]
  compiled code at target\run\youtube_analytics\dbt/models\staging\stg_youtube_video_stats.sql
[0m15:04:14.104248 [info ] [MainThread]: 
[0m15:04:14.120265 [info ] [MainThread]:   compiled code at target\compiled\youtube_analytics\dbt/models\staging\stg_youtube_video_stats.sql
[0m15:04:14.120265 [info ] [MainThread]: 
[0m15:04:14.120265 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=5
[0m15:04:14.120265 [debug] [MainThread]: Command `dbt run` failed at 15:04:14.120265 after 14.25 seconds
[0m15:04:14.120265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024756B00AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002475D182FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024756B85D10>]}
[0m15:04:14.120265 [debug] [MainThread]: Flushing usage events
[0m15:04:14.588985 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:08:14.211807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC43320210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC432D4E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC43323090>]}


============================== 15:08:14.228641 | e38222bf-9255-44ab-a3d2-538632ee71e1 ==============================
[0m15:08:14.228641 [info ] [MainThread]: Running with dbt=1.10.11
[0m15:08:14.229189 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\logs', 'profiles_dir': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m15:08:21.409178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e38222bf-9255-44ab-a3d2-538632ee71e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC719E9F10>]}
[0m15:08:21.572438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e38222bf-9255-44ab-a3d2-538632ee71e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC3FF63850>]}
[0m15:08:21.572438 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m15:08:23.470220 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m15:08:24.165043 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:08:24.165043 [debug] [MainThread]: Partial parsing: updated file: youtube_analytics://dbt/models\staging\stg_youtube_video_stats.sql
[0m15:08:25.461533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e38222bf-9255-44ab-a3d2-538632ee71e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC71A60090>]}
[0m15:08:25.602217 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m15:08:25.602217 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m15:08:25.667381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e38222bf-9255-44ab-a3d2-538632ee71e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC733B7B10>]}
[0m15:08:25.668843 [info ] [MainThread]: Found 5 models, 5 data tests, 495 macros
[0m15:08:25.669850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e38222bf-9255-44ab-a3d2-538632ee71e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC73327310>]}
[0m15:08:25.672867 [info ] [MainThread]: 
[0m15:08:25.673850 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m15:08:25.675299 [info ] [MainThread]: 
[0m15:08:25.677466 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:08:25.692087 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0'
[0m15:08:25.692087 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0'
[0m15:08:25.692087 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:25.696634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:26.696756 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg'
[0m15:08:26.696756 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:26.696756 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics'
[0m15:08:26.805427 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:27.674581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e38222bf-9255-44ab-a3d2-538632ee71e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC732557D0>]}
[0m15:08:27.674581 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:08:27.774396 [debug] [Thread-1 (]: Began running node model.youtube_analytics.stg_youtube_channels
[0m15:08:27.774396 [debug] [Thread-2 (]: Began running node model.youtube_analytics.stg_youtube_video_ids
[0m15:08:27.774396 [debug] [Thread-3 (]: Began running node model.youtube_analytics.stg_youtube_video_stats
[0m15:08:27.774396 [info ] [Thread-1 (]: 1 of 5 START sql view model youtube_stg_youtube_stg.stg_youtube_channels ....... [RUN]
[0m15:08:27.774396 [info ] [Thread-2 (]: 2 of 5 START sql view model youtube_stg_youtube_stg.stg_youtube_video_ids ...... [RUN]
[0m15:08:27.774396 [info ] [Thread-3 (]: 3 of 5 START sql view model youtube_stg_youtube_stg.stg_youtube_video_stats .... [RUN]
[0m15:08:27.774396 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_channels'
[0m15:08:27.786955 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_video_ids'
[0m15:08:27.786955 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_video_stats'
[0m15:08:27.790572 [debug] [Thread-1 (]: Began compiling node model.youtube_analytics.stg_youtube_channels
[0m15:08:27.790572 [debug] [Thread-2 (]: Began compiling node model.youtube_analytics.stg_youtube_video_ids
[0m15:08:27.790572 [debug] [Thread-3 (]: Began compiling node model.youtube_analytics.stg_youtube_video_stats
[0m15:08:27.806655 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_channels"
[0m15:08:27.811691 [debug] [Thread-2 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_video_ids"
[0m15:08:27.811691 [debug] [Thread-3 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_video_stats"
[0m15:08:27.811691 [debug] [Thread-1 (]: Began executing node model.youtube_analytics.stg_youtube_channels
[0m15:08:27.837853 [debug] [Thread-3 (]: Began executing node model.youtube_analytics.stg_youtube_video_stats
[0m15:08:27.856235 [debug] [Thread-2 (]: Began executing node model.youtube_analytics.stg_youtube_video_ids
[0m15:08:27.886050 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_channels"
[0m15:08:27.886050 [debug] [Thread-3 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_video_stats"
[0m15:08:27.899236 [debug] [Thread-2 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_video_ids"
[0m15:08:27.900788 [debug] [Thread-1 (]: On model.youtube_analytics.stg_youtube_channels: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_channels"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_channels`
  OPTIONS()
  as with src as (
  select
    id                                        as channel_id,
    snippet.title                             as channel_title,
    snippet.country                           as channel_country,
    snippet.publishedAt                       as channel_published_at,
    cast(statistics.viewCount       as int64) as channel_view_count,
    cast(statistics.subscriberCount as int64) as channel_subscribers,
    cast(statistics.videoCount      as int64) as channel_video_count,
    date(_partitiontime)                      as load_date
  from `orbital-nuance-471817-n0.youtube_raw.channels_raw`
)
select * from src;


[0m15:08:27.900788 [debug] [Thread-2 (]: On model.youtube_analytics.stg_youtube_video_ids: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_video_ids"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_ids`
  OPTIONS()
  as select
  videoId              as video_id,
  channelId            as channel_id,
  date(_partitiontime) as load_date
from `orbital-nuance-471817-n0.youtube_raw.video_ids_raw`;


[0m15:08:27.900788 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:08:27.900788 [debug] [Thread-3 (]: On model.youtube_analytics.stg_youtube_video_stats: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_video_stats"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
  OPTIONS()
  as with src as (
  select
    id                                     as video_id,
    snippet.channelId                      as channel_id,
    snippet.title                          as video_title,
    snippet.publishedAt                    as video_published_at,
    cast(statistics.viewCount    as int64) as views,
    cast(statistics.likeCount    as int64) as likes,
    cast(statistics.commentCount as int64) as comments,
    contentDetails.duration                as duration_iso,
    current_date()                         as load_date
  from `orbital-nuance-471817-n0.youtube_raw.video_stats_raw`
),
parsed as (
  select
    *,
    (
      coalesce(SAFE_CAST(REGEXP_EXTRACT(duration_iso, r'(\d+)H') AS INT64), 0) * 3600
      + coalesce(SAFE_CAST(REGEXP_EXTRACT(duration_iso, r'(\d+)M') AS INT64), 0) * 60
      + coalesce(SAFE_CAST(REGEXP_EXTRACT(duration_iso, r'(\d+)S') AS INT64), 0)
    ) as duration_seconds
  from src
)
select * from parsed;


[0m15:08:27.900788 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:08:28.005736 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:08:28.852116 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:cef28be1-7b23-4d0f-b394-64ae225621ed&page=queryresults
[0m15:08:28.867780 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:381c7324-b4fb-4653-8915-5a3dd0ae1a6a&page=queryresults
[0m15:08:29.403503 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e38222bf-9255-44ab-a3d2-538632ee71e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC72B62450>]}
[0m15:08:29.403503 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e38222bf-9255-44ab-a3d2-538632ee71e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC731D1590>]}
[0m15:08:29.403503 [info ] [Thread-3 (]: 3 of 5 OK created sql view model youtube_stg_youtube_stg.stg_youtube_video_stats  [[32mCREATE VIEW (0 processed)[0m in 1.62s]
[0m15:08:29.403503 [info ] [Thread-2 (]: 2 of 5 OK created sql view model youtube_stg_youtube_stg.stg_youtube_video_ids . [[32mCREATE VIEW (0 processed)[0m in 1.62s]
[0m15:08:29.414474 [debug] [Thread-3 (]: Finished running node model.youtube_analytics.stg_youtube_video_stats
[0m15:08:29.414474 [debug] [Thread-2 (]: Finished running node model.youtube_analytics.stg_youtube_video_ids
[0m15:08:29.414474 [debug] [Thread-4 (]: Began running node model.youtube_analytics.fct_video_daily_metrics
[0m15:08:29.414474 [info ] [Thread-4 (]: 4 of 5 START sql table model youtube_stg_youtube_analytics.fct_video_daily_metrics  [RUN]
[0m15:08:29.414474 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.youtube_analytics.fct_video_daily_metrics'
[0m15:08:29.414474 [debug] [Thread-4 (]: Began compiling node model.youtube_analytics.fct_video_daily_metrics
[0m15:08:29.430673 [debug] [Thread-4 (]: Writing injected SQL for node "model.youtube_analytics.fct_video_daily_metrics"
[0m15:08:29.434195 [debug] [Thread-4 (]: Began executing node model.youtube_analytics.fct_video_daily_metrics
[0m15:08:29.508104 [debug] [Thread-4 (]: Writing runtime sql for node "model.youtube_analytics.fct_video_daily_metrics"
[0m15:08:29.508104 [debug] [Thread-4 (]: On model.youtube_analytics.fct_video_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.fct_video_daily_metrics"} */

  
    

    create or replace table `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
      
    
    

    
    OPTIONS()
    as (
      with daily as (
  select
    video_id,
    channel_id,
    load_date,
    views,
    likes,
    comments
  from `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
),
with_lag as (
  select
    *,
    lag(views)    over (partition by video_id order by load_date) as prev_views,
    lag(likes)    over (partition by video_id order by load_date) as prev_likes,
    lag(comments) over (partition by video_id order by load_date) as prev_comments
  from daily
)
select
  video_id,
  channel_id,
  load_date,
  views,
  likes,
  comments,
  views    - coalesce(prev_views, 0)    as daily_views,
  likes    - coalesce(prev_likes, 0)    as daily_likes,
  comments - coalesce(prev_comments, 0) as daily_comments
from with_lag
    );
  
[0m15:08:29.508104 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:08:29.790575 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:f7752a7e-ff92-4789-a10c-f7763a5c953f&page=queryresults
[0m15:08:30.274355 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e38222bf-9255-44ab-a3d2-538632ee71e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC734D5890>]}
[0m15:08:30.274355 [info ] [Thread-1 (]: 1 of 5 OK created sql view model youtube_stg_youtube_stg.stg_youtube_channels .. [[32mCREATE VIEW (0 processed)[0m in 2.50s]
[0m15:08:30.274355 [debug] [Thread-1 (]: Finished running node model.youtube_analytics.stg_youtube_channels
[0m15:08:30.477890 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:287ee0bd-99dc-4e61-8862-5932cf355a97&page=queryresults
[0m15:08:32.730432 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e38222bf-9255-44ab-a3d2-538632ee71e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC734F5090>]}
[0m15:08:32.730432 [info ] [Thread-4 (]: 4 of 5 OK created sql table model youtube_stg_youtube_analytics.fct_video_daily_metrics  [[32mCREATE TABLE (20.0 rows, 1.2 KiB processed)[0m in 3.32s]
[0m15:08:32.730432 [debug] [Thread-4 (]: Finished running node model.youtube_analytics.fct_video_daily_metrics
[0m15:08:32.739479 [debug] [Thread-3 (]: Began running node model.youtube_analytics.agg_channel_trends_7d
[0m15:08:32.739479 [info ] [Thread-3 (]: 5 of 5 START sql table model youtube_stg_youtube_analytics.agg_channel_trends_7d  [RUN]
[0m15:08:32.741498 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.youtube_analytics.stg_youtube_video_stats, now model.youtube_analytics.agg_channel_trends_7d)
[0m15:08:32.743504 [debug] [Thread-3 (]: Began compiling node model.youtube_analytics.agg_channel_trends_7d
[0m15:08:32.749868 [debug] [Thread-3 (]: Writing injected SQL for node "model.youtube_analytics.agg_channel_trends_7d"
[0m15:08:32.751883 [debug] [Thread-3 (]: Began executing node model.youtube_analytics.agg_channel_trends_7d
[0m15:08:32.761765 [debug] [Thread-3 (]: Writing runtime sql for node "model.youtube_analytics.agg_channel_trends_7d"
[0m15:08:32.779016 [debug] [Thread-3 (]: On model.youtube_analytics.agg_channel_trends_7d: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.agg_channel_trends_7d"} */

  
    

    create or replace table `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`agg_channel_trends_7d`
      
    
    

    
    OPTIONS()
    as (
      with daily as (
  select
    channel_id,
    video_id,
    load_date,
    daily_views,
    daily_likes,
    daily_comments
  from `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
),
rollup as (
  select
    channel_id,
    load_date,
    sum(daily_views)    over (partition by channel_id order by load_date rows between 6 preceding and current row) as views_7d,
    sum(daily_likes)    over (partition by channel_id order by load_date rows between 6 preceding and current row) as likes_7d,
    sum(daily_comments) over (partition by channel_id order by load_date rows between 6 preceding and current row) as comments_7d
  from daily
)
select distinct channel_id, load_date, views_7d, likes_7d, comments_7d
from rollup
    );
  
[0m15:08:32.780106 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:08:33.449667 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:3c058c22-5125-40e7-b562-4305ec3f9ae3&page=queryresults
[0m15:08:33.449667 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:3c058c22-5125-40e7-b562-4305ec3f9ae3&page=queryresults
[0m15:08:33.456509 [debug] [Thread-3 (]: Database Error in model agg_channel_trends_7d (dbt/models\marts\agg_channel_trends_7d.sql)
  Syntax error: Expected keyword SELECT but got keyword ROLLUP at [24:1]
  compiled code at target\run\youtube_analytics\dbt/models\marts\agg_channel_trends_7d.sql
[0m15:08:33.458514 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e38222bf-9255-44ab-a3d2-538632ee71e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC738164D0>]}
[0m15:08:33.458514 [error] [Thread-3 (]: 5 of 5 ERROR creating sql table model youtube_stg_youtube_analytics.agg_channel_trends_7d  [[31mERROR[0m in 0.72s]
[0m15:08:33.458514 [debug] [Thread-3 (]: Finished running node model.youtube_analytics.agg_channel_trends_7d
[0m15:08:33.460519 [debug] [Thread-7 (]: Marking all children of 'model.youtube_analytics.agg_channel_trends_7d' to be skipped because of status 'error'.  Reason: Database Error in model agg_channel_trends_7d (dbt/models\marts\agg_channel_trends_7d.sql)
  Syntax error: Expected keyword SELECT but got keyword ROLLUP at [24:1]
  compiled code at target\run\youtube_analytics\dbt/models\marts\agg_channel_trends_7d.sql.
[0m15:08:33.462125 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:08:33.603241 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:08:33.604237 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0' was properly closed.
[0m15:08:33.605342 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0' was properly closed.
[0m15:08:33.607358 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg' was properly closed.
[0m15:08:33.608486 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics' was properly closed.
[0m15:08:33.609466 [debug] [MainThread]: Connection 'model.youtube_analytics.stg_youtube_channels' was properly closed.
[0m15:08:33.610466 [debug] [MainThread]: Connection 'model.youtube_analytics.stg_youtube_video_ids' was properly closed.
[0m15:08:33.611448 [debug] [MainThread]: Connection 'model.youtube_analytics.agg_channel_trends_7d' was properly closed.
[0m15:08:33.612360 [debug] [MainThread]: Connection 'model.youtube_analytics.fct_video_daily_metrics' was properly closed.
[0m15:08:33.614356 [info ] [MainThread]: 
[0m15:08:33.615483 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 7.94 seconds (7.94s).
[0m15:08:33.621760 [debug] [MainThread]: Command end result
[0m15:08:33.696202 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m15:08:33.699659 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m15:08:33.712057 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\run_results.json
[0m15:08:33.712057 [info ] [MainThread]: 
[0m15:08:33.712057 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:08:33.712057 [info ] [MainThread]: 
[0m15:08:33.712057 [error] [MainThread]: [31mFailure in model agg_channel_trends_7d (dbt/models\marts\agg_channel_trends_7d.sql)[0m
[0m15:08:33.712057 [error] [MainThread]:   Database Error in model agg_channel_trends_7d (dbt/models\marts\agg_channel_trends_7d.sql)
  Syntax error: Expected keyword SELECT but got keyword ROLLUP at [24:1]
  compiled code at target\run\youtube_analytics\dbt/models\marts\agg_channel_trends_7d.sql
[0m15:08:33.712057 [info ] [MainThread]: 
[0m15:08:33.712057 [info ] [MainThread]:   compiled code at target\compiled\youtube_analytics\dbt/models\marts\agg_channel_trends_7d.sql
[0m15:08:33.712057 [info ] [MainThread]: 
[0m15:08:33.712057 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m15:08:33.712057 [debug] [MainThread]: Command `dbt run` failed at 15:08:33.712057 after 19.57 seconds
[0m15:08:33.712057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC4334FA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC3C9A0990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC71AE98D0>]}
[0m15:08:33.728280 [debug] [MainThread]: Flushing usage events
[0m15:08:34.229545 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:13:05.086945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C29B8F8550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C29B8F2CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C29A743890>]}


============================== 15:13:05.086945 | d6b2e1d2-58a9-4dae-af5a-64d0de0b09b2 ==============================
[0m15:13:05.086945 [info ] [MainThread]: Running with dbt=1.10.11
[0m15:13:05.086945 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\logs', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m15:13:11.590095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6b2e1d2-58a9-4dae-af5a-64d0de0b09b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C29AA7A9D0>]}
[0m15:13:11.806343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6b2e1d2-58a9-4dae-af5a-64d0de0b09b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C298532A50>]}
[0m15:13:11.806343 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m15:13:13.633777 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m15:13:14.338911 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:13:14.338911 [debug] [MainThread]: Partial parsing: updated file: youtube_analytics://dbt/models\marts\agg_channel_trends_7d.sql
[0m15:13:15.010332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6b2e1d2-58a9-4dae-af5a-64d0de0b09b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2CB4CB490>]}
[0m15:13:15.231553 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m15:13:15.235663 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m15:13:15.303938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6b2e1d2-58a9-4dae-af5a-64d0de0b09b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2CB6CA510>]}
[0m15:13:15.306459 [info ] [MainThread]: Found 5 models, 5 data tests, 495 macros
[0m15:13:15.306459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6b2e1d2-58a9-4dae-af5a-64d0de0b09b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2CB7B4D90>]}
[0m15:13:15.306459 [info ] [MainThread]: 
[0m15:13:15.306459 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m15:13:15.306459 [info ] [MainThread]: 
[0m15:13:15.306459 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:13:15.325099 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0'
[0m15:13:15.325099 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:15.325099 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0'
[0m15:13:15.463392 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:16.176197 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics'
[0m15:13:16.180691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:16.182706 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg'
[0m15:13:16.182706 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:16.999128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6b2e1d2-58a9-4dae-af5a-64d0de0b09b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C29B9A5D10>]}
[0m15:13:17.001267 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:13:17.243021 [debug] [Thread-1 (]: Began running node model.youtube_analytics.stg_youtube_channels
[0m15:13:17.251733 [debug] [Thread-2 (]: Began running node model.youtube_analytics.stg_youtube_video_ids
[0m15:13:17.251733 [debug] [Thread-3 (]: Began running node model.youtube_analytics.stg_youtube_video_stats
[0m15:13:17.251733 [info ] [Thread-1 (]: 1 of 5 START sql view model youtube_stg_youtube_stg.stg_youtube_channels ....... [RUN]
[0m15:13:17.251733 [info ] [Thread-2 (]: 2 of 5 START sql view model youtube_stg_youtube_stg.stg_youtube_video_ids ...... [RUN]
[0m15:13:17.258739 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_channels'
[0m15:13:17.258739 [info ] [Thread-3 (]: 3 of 5 START sql view model youtube_stg_youtube_stg.stg_youtube_video_stats .... [RUN]
[0m15:13:17.258739 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_video_ids'
[0m15:13:17.258739 [debug] [Thread-1 (]: Began compiling node model.youtube_analytics.stg_youtube_channels
[0m15:13:17.258739 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.youtube_analytics.stg_youtube_video_stats'
[0m15:13:17.258739 [debug] [Thread-2 (]: Began compiling node model.youtube_analytics.stg_youtube_video_ids
[0m15:13:17.275051 [debug] [Thread-1 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_channels"
[0m15:13:17.275051 [debug] [Thread-3 (]: Began compiling node model.youtube_analytics.stg_youtube_video_stats
[0m15:13:17.290464 [debug] [Thread-2 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_video_ids"
[0m15:13:17.290464 [debug] [Thread-3 (]: Writing injected SQL for node "model.youtube_analytics.stg_youtube_video_stats"
[0m15:13:17.290464 [debug] [Thread-1 (]: Began executing node model.youtube_analytics.stg_youtube_channels
[0m15:13:17.290464 [debug] [Thread-3 (]: Began executing node model.youtube_analytics.stg_youtube_video_stats
[0m15:13:17.306277 [debug] [Thread-2 (]: Began executing node model.youtube_analytics.stg_youtube_video_ids
[0m15:13:17.368673 [debug] [Thread-1 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_channels"
[0m15:13:17.377334 [debug] [Thread-3 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_video_stats"
[0m15:13:17.384434 [debug] [Thread-2 (]: Writing runtime sql for node "model.youtube_analytics.stg_youtube_video_ids"
[0m15:13:17.393194 [debug] [Thread-1 (]: On model.youtube_analytics.stg_youtube_channels: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_channels"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_channels`
  OPTIONS()
  as with src as (
  select
    id                                        as channel_id,
    snippet.title                             as channel_title,
    snippet.country                           as channel_country,
    snippet.publishedAt                       as channel_published_at,
    cast(statistics.viewCount       as int64) as channel_view_count,
    cast(statistics.subscriberCount as int64) as channel_subscribers,
    cast(statistics.videoCount      as int64) as channel_video_count,
    date(_partitiontime)                      as load_date
  from `orbital-nuance-471817-n0.youtube_raw.channels_raw`
)
select * from src;


[0m15:13:17.395561 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:13:17.395561 [debug] [Thread-3 (]: On model.youtube_analytics.stg_youtube_video_stats: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_video_stats"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
  OPTIONS()
  as with src as (
  select
    id                                     as video_id,
    snippet.channelId                      as channel_id,
    snippet.title                          as video_title,
    snippet.publishedAt                    as video_published_at,
    cast(statistics.viewCount    as int64) as views,
    cast(statistics.likeCount    as int64) as likes,
    cast(statistics.commentCount as int64) as comments,
    contentDetails.duration                as duration_iso,
    current_date()                         as load_date
  from `orbital-nuance-471817-n0.youtube_raw.video_stats_raw`
),
parsed as (
  select
    *,
    (
      coalesce(SAFE_CAST(REGEXP_EXTRACT(duration_iso, r'(\d+)H') AS INT64), 0) * 3600
      + coalesce(SAFE_CAST(REGEXP_EXTRACT(duration_iso, r'(\d+)M') AS INT64), 0) * 60
      + coalesce(SAFE_CAST(REGEXP_EXTRACT(duration_iso, r'(\d+)S') AS INT64), 0)
    ) as duration_seconds
  from src
)
select * from parsed;


[0m15:13:17.395561 [debug] [Thread-2 (]: On model.youtube_analytics.stg_youtube_video_ids: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.stg_youtube_video_ids"} */


  create or replace view `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_ids`
  OPTIONS()
  as select
  videoId              as video_id,
  channelId            as channel_id,
  date(_partitiontime) as load_date
from `orbital-nuance-471817-n0.youtube_raw.video_ids_raw`;


[0m15:13:17.478920 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:13:17.478920 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:13:18.428054 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:b7f064c5-031d-4d0e-be07-78f2e9b4738a&page=queryresults
[0m15:13:18.431052 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:d73b3a5c-7d9d-437e-8467-376c7547ec6f&page=queryresults
[0m15:13:18.433802 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:455d64f3-d506-442b-b4f8-8944ca451c6f&page=queryresults
[0m15:13:19.078285 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6b2e1d2-58a9-4dae-af5a-64d0de0b09b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2CB995850>]}
[0m15:13:19.080399 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6b2e1d2-58a9-4dae-af5a-64d0de0b09b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2CB994ED0>]}
[0m15:13:19.081392 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6b2e1d2-58a9-4dae-af5a-64d0de0b09b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2CB9959D0>]}
[0m15:13:19.083390 [info ] [Thread-3 (]: 3 of 5 OK created sql view model youtube_stg_youtube_stg.stg_youtube_video_stats  [[32mCREATE VIEW (0 processed)[0m in 1.81s]
[0m15:13:19.085435 [info ] [Thread-1 (]: 1 of 5 OK created sql view model youtube_stg_youtube_stg.stg_youtube_channels .. [[32mCREATE VIEW (0 processed)[0m in 1.82s]
[0m15:13:19.086502 [info ] [Thread-2 (]: 2 of 5 OK created sql view model youtube_stg_youtube_stg.stg_youtube_video_ids . [[32mCREATE VIEW (0 processed)[0m in 1.82s]
[0m15:13:19.087557 [debug] [Thread-3 (]: Finished running node model.youtube_analytics.stg_youtube_video_stats
[0m15:13:19.087557 [debug] [Thread-1 (]: Finished running node model.youtube_analytics.stg_youtube_channels
[0m15:13:19.092365 [debug] [Thread-2 (]: Finished running node model.youtube_analytics.stg_youtube_video_ids
[0m15:13:19.092365 [debug] [Thread-4 (]: Began running node model.youtube_analytics.fct_video_daily_metrics
[0m15:13:19.092365 [info ] [Thread-4 (]: 4 of 5 START sql table model youtube_stg_youtube_analytics.fct_video_daily_metrics  [RUN]
[0m15:13:19.092365 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.youtube_analytics.fct_video_daily_metrics'
[0m15:13:19.100573 [debug] [Thread-4 (]: Began compiling node model.youtube_analytics.fct_video_daily_metrics
[0m15:13:19.108938 [debug] [Thread-4 (]: Writing injected SQL for node "model.youtube_analytics.fct_video_daily_metrics"
[0m15:13:19.110951 [debug] [Thread-4 (]: Began executing node model.youtube_analytics.fct_video_daily_metrics
[0m15:13:19.134729 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:13:19.790980 [debug] [Thread-4 (]: Writing runtime sql for node "model.youtube_analytics.fct_video_daily_metrics"
[0m15:13:19.790980 [debug] [Thread-4 (]: On model.youtube_analytics.fct_video_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.fct_video_daily_metrics"} */

  
    

    create or replace table `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
      
    
    

    
    OPTIONS()
    as (
      with daily as (
  select
    video_id,
    channel_id,
    load_date,
    views,
    likes,
    comments
  from `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
),
with_lag as (
  select
    *,
    lag(views)    over (partition by video_id order by load_date) as prev_views,
    lag(likes)    over (partition by video_id order by load_date) as prev_likes,
    lag(comments) over (partition by video_id order by load_date) as prev_comments
  from daily
)
select
  video_id,
  channel_id,
  load_date,
  views,
  likes,
  comments,
  views    - coalesce(prev_views, 0)    as daily_views,
  likes    - coalesce(prev_likes, 0)    as daily_likes,
  comments - coalesce(prev_comments, 0) as daily_comments
from with_lag
    );
  
[0m15:13:20.416574 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:b70816c8-9915-4170-a2d2-1b813cb5857a&page=queryresults
[0m15:13:23.149660 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6b2e1d2-58a9-4dae-af5a-64d0de0b09b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2CB860D10>]}
[0m15:13:23.149660 [info ] [Thread-4 (]: 4 of 5 OK created sql table model youtube_stg_youtube_analytics.fct_video_daily_metrics  [[32mCREATE TABLE (20.0 rows, 1.2 KiB processed)[0m in 4.06s]
[0m15:13:23.149660 [debug] [Thread-4 (]: Finished running node model.youtube_analytics.fct_video_daily_metrics
[0m15:13:23.149660 [debug] [Thread-3 (]: Began running node model.youtube_analytics.agg_channel_trends_7d
[0m15:13:23.156198 [info ] [Thread-3 (]: 5 of 5 START sql table model youtube_stg_youtube_analytics.agg_channel_trends_7d  [RUN]
[0m15:13:23.156198 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.youtube_analytics.stg_youtube_video_stats, now model.youtube_analytics.agg_channel_trends_7d)
[0m15:13:23.156198 [debug] [Thread-3 (]: Began compiling node model.youtube_analytics.agg_channel_trends_7d
[0m15:13:23.165677 [debug] [Thread-3 (]: Writing injected SQL for node "model.youtube_analytics.agg_channel_trends_7d"
[0m15:13:23.165677 [debug] [Thread-3 (]: Began executing node model.youtube_analytics.agg_channel_trends_7d
[0m15:13:23.181709 [debug] [Thread-3 (]: Writing runtime sql for node "model.youtube_analytics.agg_channel_trends_7d"
[0m15:13:23.186342 [debug] [Thread-3 (]: On model.youtube_analytics.agg_channel_trends_7d: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "model.youtube_analytics.agg_channel_trends_7d"} */

  
    

    create or replace table `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`agg_channel_trends_7d`
      
    
    

    
    OPTIONS()
    as (
      with daily as (
  select
    channel_id,
    video_id,
    load_date,
    daily_views,
    daily_likes,
    daily_comments
  from `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
),
rollup_cte as (
  select
    channel_id,
    load_date,
    sum(daily_views)    over (
      partition by channel_id
      order by load_date
      rows between 6 preceding and current row
    ) as views_7d,
    sum(daily_likes)    over (
      partition by channel_id
      order by load_date
      rows between 6 preceding and current row
    ) as likes_7d,
    sum(daily_comments) over (
      partition by channel_id
      order by load_date
      rows between 6 preceding and current row
    ) as comments_7d
  from daily
)
select distinct channel_id, load_date, views_7d, likes_7d, comments_7d
from rollup_cte
    );
  
[0m15:13:23.186342 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:13:24.263193 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:c5b39de7-75d4-4666-a239-056ae63fa5e4&page=queryresults
[0m15:13:26.625076 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6b2e1d2-58a9-4dae-af5a-64d0de0b09b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2CBD4FC50>]}
[0m15:13:26.626068 [info ] [Thread-3 (]: 5 of 5 OK created sql table model youtube_stg_youtube_analytics.agg_channel_trends_7d  [[32mCREATE TABLE (20.0 rows, 1.1 KiB processed)[0m in 3.47s]
[0m15:13:26.627069 [debug] [Thread-3 (]: Finished running node model.youtube_analytics.agg_channel_trends_7d
[0m15:13:26.631079 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:13:26.758498 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:13:26.760508 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0' was properly closed.
[0m15:13:26.763392 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0' was properly closed.
[0m15:13:26.764496 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics' was properly closed.
[0m15:13:26.765494 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg' was properly closed.
[0m15:13:26.766459 [debug] [MainThread]: Connection 'model.youtube_analytics.stg_youtube_channels' was properly closed.
[0m15:13:26.766459 [debug] [MainThread]: Connection 'model.youtube_analytics.stg_youtube_video_ids' was properly closed.
[0m15:13:26.767404 [debug] [MainThread]: Connection 'model.youtube_analytics.agg_channel_trends_7d' was properly closed.
[0m15:13:26.768429 [debug] [MainThread]: Connection 'model.youtube_analytics.fct_video_daily_metrics' was properly closed.
[0m15:13:26.769385 [info ] [MainThread]: 
[0m15:13:26.771117 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 11.46 seconds (11.46s).
[0m15:13:26.775515 [debug] [MainThread]: Command end result
[0m15:13:26.853188 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m15:13:26.859535 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m15:13:26.869295 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\run_results.json
[0m15:13:26.869295 [info ] [MainThread]: 
[0m15:13:26.869295 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:13:26.869295 [info ] [MainThread]: 
[0m15:13:26.869295 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m15:13:26.885119 [debug] [MainThread]: Command `dbt run` succeeded at 15:13:26.885119 after 21.87 seconds
[0m15:13:26.887618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C29B5787D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C29B92B3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C294F73D90>]}
[0m15:13:26.889631 [debug] [MainThread]: Flushing usage events
[0m15:13:27.353509 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:13:42.011398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EFA3C7690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EFA43FA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EFA410950>]}


============================== 15:13:42.017144 | 4fd32fa9-7dba-47c6-a0c4-3357a0f1c4bb ==============================
[0m15:13:42.017144 [info ] [MainThread]: Running with dbt=1.10.11
[0m15:13:42.018305 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'printer_width': '80', 'empty': 'None', 'use_experimental_parser': 'False', 'log_path': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'D:\\UC Davis Documents & Works\\Interview Preparation\\self_projects\\youtube-analytics-pipeline\\dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m15:13:49.805867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4fd32fa9-7dba-47c6-a0c4-3357a0f1c4bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EA8CF5710>]}
[0m15:13:50.010719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4fd32fa9-7dba-47c6-a0c4-3357a0f1c4bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EF7052650>]}
[0m15:13:50.012720 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m15:13:52.055664 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m15:13:52.639038 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:13:52.640042 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:13:52.712808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fd32fa9-7dba-47c6-a0c4-3357a0f1c4bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EAA263190>]}
[0m15:13:52.884889 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m15:13:52.884889 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m15:13:52.980910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fd32fa9-7dba-47c6-a0c4-3357a0f1c4bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EAA44FE50>]}
[0m15:13:52.980910 [info ] [MainThread]: Found 5 models, 5 data tests, 495 macros
[0m15:13:52.980910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fd32fa9-7dba-47c6-a0c4-3357a0f1c4bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EA8BCCE50>]}
[0m15:13:52.987009 [info ] [MainThread]: 
[0m15:13:52.987009 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m15:13:52.987009 [info ] [MainThread]: 
[0m15:13:52.992563 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:13:53.001049 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg'
[0m15:13:53.004623 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:53.004623 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics'
[0m15:13:53.104761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:53.697775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fd32fa9-7dba-47c6-a0c4-3357a0f1c4bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EF9A85310>]}
[0m15:13:53.697775 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:13:53.842671 [debug] [Thread-1 (]: Began running node test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267
[0m15:13:53.843670 [debug] [Thread-2 (]: Began running node test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1
[0m15:13:53.844955 [debug] [Thread-3 (]: Began running node test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7
[0m15:13:53.846539 [debug] [Thread-4 (]: Began running node test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602
[0m15:13:53.848559 [info ] [Thread-1 (]: 1 of 5 START test not_null_fct_video_daily_metrics_load_date ................... [RUN]
[0m15:13:53.849553 [info ] [Thread-2 (]: 2 of 5 START test not_null_fct_video_daily_metrics_video_id .................... [RUN]
[0m15:13:53.850558 [info ] [Thread-3 (]: 3 of 5 START test not_null_stg_youtube_video_stats_load_date ................... [RUN]
[0m15:13:53.852016 [info ] [Thread-4 (]: 4 of 5 START test not_null_stg_youtube_video_stats_video_id .................... [RUN]
[0m15:13:53.853035 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267'
[0m15:13:53.853035 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1'
[0m15:13:53.853035 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7'
[0m15:13:53.853035 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602'
[0m15:13:53.853035 [debug] [Thread-1 (]: Began compiling node test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267
[0m15:13:53.853035 [debug] [Thread-2 (]: Began compiling node test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1
[0m15:13:53.853035 [debug] [Thread-3 (]: Began compiling node test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7
[0m15:13:53.853035 [debug] [Thread-4 (]: Began compiling node test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602
[0m15:13:53.905621 [debug] [Thread-1 (]: Writing injected SQL for node "test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267"
[0m15:13:53.907634 [debug] [Thread-2 (]: Writing injected SQL for node "test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1"
[0m15:13:53.916407 [debug] [Thread-3 (]: Writing injected SQL for node "test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7"
[0m15:13:53.932487 [debug] [Thread-4 (]: Writing injected SQL for node "test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602"
[0m15:13:53.932487 [debug] [Thread-2 (]: Began executing node test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1
[0m15:13:53.983329 [debug] [Thread-2 (]: Writing runtime sql for node "test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1"
[0m15:13:53.985337 [debug] [Thread-4 (]: Began executing node test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602
[0m15:13:53.985337 [debug] [Thread-3 (]: Began executing node test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7
[0m15:13:53.985337 [debug] [Thread-1 (]: Began executing node test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267
[0m15:13:53.993067 [debug] [Thread-4 (]: Writing runtime sql for node "test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602"
[0m15:13:54.004212 [debug] [Thread-3 (]: Writing runtime sql for node "test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7"
[0m15:13:54.011571 [debug] [Thread-1 (]: Writing runtime sql for node "test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267"
[0m15:13:54.011571 [debug] [Thread-2 (]: On test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select video_id
from `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
where video_id is null



  
  
      
    ) dbt_internal_test
[0m15:13:54.011571 [debug] [Thread-3 (]: On test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select load_date
from `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
where load_date is null



  
  
      
    ) dbt_internal_test
[0m15:13:54.011571 [debug] [Thread-4 (]: On test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select video_id
from `orbital-nuance-471817-n0`.`youtube_stg_youtube_stg`.`stg_youtube_video_stats`
where video_id is null



  
  
      
    ) dbt_internal_test
[0m15:13:54.011571 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:13:54.011571 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:13:54.025317 [debug] [Thread-1 (]: On test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select load_date
from `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
where load_date is null



  
  
      
    ) dbt_internal_test
[0m15:13:54.026590 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:13:54.389516 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:13:55.383345 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:fd455fb4-9fd5-47ee-a6ec-7cb4d2d9937b&page=queryresults
[0m15:13:55.383345 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:a82b1058-cb2a-4337-9e0b-c61edcc411d3&page=queryresults
[0m15:13:55.399084 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:d0faa56b-cb99-424a-a606-c7f46aaa607b&page=queryresults
[0m15:13:55.399084 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:7e7b2de0-d47c-4616-be67-a3e72fc071b5&page=queryresults
[0m15:13:56.108000 [info ] [Thread-2 (]: 2 of 5 PASS not_null_fct_video_daily_metrics_video_id .......................... [[32mPASS[0m in 2.25s]
[0m15:13:56.108000 [debug] [Thread-2 (]: Finished running node test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1
[0m15:13:56.108000 [debug] [Thread-2 (]: Began running node test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e
[0m15:13:56.108000 [info ] [Thread-2 (]: 5 of 5 START test unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_  [RUN]
[0m15:13:56.120149 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.youtube_analytics.not_null_fct_video_daily_metrics_video_id.37354b3bf1, now test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e)
[0m15:13:56.120149 [info ] [Thread-1 (]: 1 of 5 PASS not_null_fct_video_daily_metrics_load_date ......................... [[32mPASS[0m in 2.27s]
[0m15:13:56.120149 [debug] [Thread-2 (]: Began compiling node test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e
[0m15:13:56.120149 [debug] [Thread-1 (]: Finished running node test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267
[0m15:13:56.127349 [debug] [Thread-2 (]: Writing injected SQL for node "test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e"
[0m15:13:56.127349 [debug] [Thread-2 (]: Began executing node test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e
[0m15:13:56.127349 [debug] [Thread-2 (]: Writing runtime sql for node "test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e"
[0m15:13:56.127349 [debug] [Thread-2 (]: On test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "youtube_analytics", "target_name": "prod", "node_id": "test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select video_id || '-' || cast(load_date as string) as unique_field
  from `orbital-nuance-471817-n0`.`youtube_stg_youtube_analytics`.`fct_video_daily_metrics`
  where video_id || '-' || cast(load_date as string) is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:13:56.134300 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:13:56.220900 [info ] [Thread-4 (]: 4 of 5 PASS not_null_stg_youtube_video_stats_video_id .......................... [[32mPASS[0m in 2.37s]
[0m15:13:56.230308 [info ] [Thread-3 (]: 3 of 5 PASS not_null_stg_youtube_video_stats_load_date ......................... [[32mPASS[0m in 2.38s]
[0m15:13:56.231305 [debug] [Thread-4 (]: Finished running node test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602
[0m15:13:56.234516 [debug] [Thread-3 (]: Finished running node test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7
[0m15:13:57.244228 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=orbital-nuance-471817-n0&j=bq:US:d210f247-ddb3-4cc1-9d23-7aeae4aba2f5&page=queryresults
[0m15:13:57.950787 [info ] [Thread-2 (]: 5 of 5 PASS unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_ .. [[32mPASS[0m in 1.83s]
[0m15:13:57.950787 [debug] [Thread-2 (]: Finished running node test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e
[0m15:13:57.954358 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:13:58.133101 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:13:58.133101 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_stg' was properly closed.
[0m15:13:58.133101 [debug] [MainThread]: Connection 'list_orbital-nuance-471817-n0_youtube_stg_youtube_analytics' was properly closed.
[0m15:13:58.133101 [debug] [MainThread]: Connection 'test.youtube_analytics.not_null_fct_video_daily_metrics_load_date.5df3d7c267' was properly closed.
[0m15:13:58.133101 [debug] [MainThread]: Connection 'test.youtube_analytics.unique_fct_video_daily_metrics_video_id_cast_load_date_as_string_.1e211e215e' was properly closed.
[0m15:13:58.133101 [debug] [MainThread]: Connection 'test.youtube_analytics.not_null_stg_youtube_video_stats_load_date.d856919da7' was properly closed.
[0m15:13:58.133101 [debug] [MainThread]: Connection 'test.youtube_analytics.not_null_stg_youtube_video_stats_video_id.0a92fe7602' was properly closed.
[0m15:13:58.133101 [info ] [MainThread]: 
[0m15:13:58.133101 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 5.14 seconds (5.14s).
[0m15:13:58.151214 [debug] [MainThread]: Command end result
[0m15:13:58.221094 [debug] [MainThread]: Wrote artifact WritableManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\manifest.json
[0m15:13:58.226966 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\semantic_manifest.json
[0m15:13:58.243127 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\UC Davis Documents & Works\Interview Preparation\self_projects\youtube-analytics-pipeline\target\run_results.json
[0m15:13:58.246638 [info ] [MainThread]: 
[0m15:13:58.246638 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:13:58.246638 [info ] [MainThread]: 
[0m15:13:58.246638 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m15:13:58.246638 [debug] [MainThread]: Command `dbt test` succeeded at 15:13:58.246638 after 16.32 seconds
[0m15:13:58.246638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EF7041490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EAA8C7E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EF3A93D90>]}
[0m15:13:58.246638 [debug] [MainThread]: Flushing usage events
[0m15:13:58.640580 [debug] [MainThread]: An error was encountered while trying to flush usage events
